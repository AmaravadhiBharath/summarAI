import{s as ga,c as fa,l as va,a as ma}from"./chrome-auth-CvNSQ1jf.js";import{r as P,a as Cr,j as o,X as Ji,e as _a,T as Pr,f as ss,g as xa,L as ya,h as zt,i as ba,b as wa,k as Ur,U as qr,l as ka,A as Ki,I as Ls,B as Ms,E as Br,m as Gr,H as rs,n as Vr,o as is,M as sr,z as hs,p as Zi,c as Qi,q as en,s as tn,t as ja,V as Ea,u as Wr,v as Na,w as Sa,R as Ca,F as Pa}from"./vendor-CW_Uz-VJ.js";import{_ as Ia}from"./jspdf-BLwrtHRg.js";import{c as O,T as D,B as q,m as Ta}from"./Button-u5xpvl0m.js";import{s as Fa,g as $a,a as Ra,c as Oa}from"./firebase-extension-D_G_kiIL.js";import"./firebase-firestore-Bn4Lp4iP.js";const Aa="https://script.google.com/macros/s/AKfycbxrlK_jHWJguJ1sCHYEwmpllj8nR8uuVoiWYe2JF8RiPpvLy_vmGJTUMpoX2ZWKPwTMLA/exec",Yr=({open:r,onOpenChange:e,userEmail:t})=>{const[s,i]=P.useState(1),[n,a]=P.useState(null),[l,c]=P.useState({}),[u,d]=P.useState(!1),[h,f]=P.useState(0),g=Cr.useRef(!1);P.useEffect(()=>{r?(s===0&&i(1),a(null),c({}),d(!1)):g.current=!1},[r]),P.useEffect(()=>{(async()=>{const R=(await chrome.storage.local.get(["summarizeCount","pulseCheckDismissed","pulseCheckDismissedFinal"])).summarizeCount||0;f(R)})();const N=$=>{if($.summarizeCount){const R=$.summarizeCount.newValue;f(R)}};return chrome.storage.onChanged.addListener(N),()=>chrome.storage.onChanged.removeListener(N)},[]);const m=()=>{e(!1),g.current&&(h>=4?chrome.storage.local.set({pulseCheckDismissed:!0,pulseCheckDismissedFinal:!0}):chrome.storage.local.set({pulseCheckDismissed:!0})),g.current=!1},v=S=>{a(S),i(2)},y=(S,N)=>{c($=>({...$,[S]:N}))},j=async()=>{if(u)return;d(!0);const S={timestamp:new Date().toISOString(),rating:n,email:t||"anonymous",...l};try{fetch(Aa,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})}catch{}i(3)},b=()=>{i(1),a(null),c({}),d(!1)};if(!r)return null;const T=n==="Game Changer"||n==="Useful";return o.jsx("div",{className:"popup-content absolute bottom-full left-0 right-0 mb-2 z-[200] w-auto",onClick:S=>S.stopPropagation(),children:o.jsxs("div",{className:"w-full bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden",children:[o.jsxs("div",{className:"flex justify-between items-center px-4 pt-3 pb-1",children:[o.jsx("span",{className:"text-[10px] font-bold text-black uppercase tracking-wider",children:"Pulse Check"}),o.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Ji,{className:"w-4 h-4"})})]}),o.jsxs("div",{className:"px-5 pb-5 pt-1",children:[s===1&&o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-sm font-semibold text-gray-900 text-center",children:"What is your initial feeling?"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("button",{onClick:()=>v("Game Changer"),className:"flex flex-col items-center justify-center gap-1 p-3 rounded-xl border border-gray-100 hover:border-black hover:bg-gray-50 transition-all group",children:[o.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:"ðŸ¤©"}),o.jsx("span",{className:"text-xs font-medium text-gray-600 group-hover:text-black",children:"Game Changer"})]}),o.jsxs("button",{onClick:()=>v("Useful"),className:"flex flex-col items-center justify-center gap-1 p-3 rounded-xl border border-gray-100 hover:border-black hover:bg-gray-50 transition-all group",children:[o.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:"ðŸ™‚"}),o.jsx("span",{className:"text-xs font-medium text-gray-600 group-hover:text-black",children:"Useful"})]}),o.jsxs("button",{onClick:()=>v("Okay"),className:"flex flex-col items-center justify-center gap-1 p-3 rounded-xl border border-gray-100 hover:border-gray-200 hover:bg-gray-50 transition-all group",children:[o.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:"ðŸ˜"}),o.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Okay"})]}),o.jsxs("button",{onClick:()=>v("Not helpful"),className:"flex flex-col items-center justify-center gap-1 p-3 rounded-xl border border-gray-100 hover:border-gray-200 hover:bg-gray-50 transition-all group",children:[o.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform",children:"ðŸ™"}),o.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Not helpful"})]})]})]}),s===2&&o.jsxs("div",{className:"space-y-4 animate-fade-in",children:[T?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Should I invest more time into this?"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>y("investTime",!0),className:O("flex-1 py-1.5 text-xs rounded-lg border transition-colors",l.investTime===!0?"bg-black text-white border-black":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Yes"}),o.jsx("button",{onClick:()=>y("investTime",!1),className:O("flex-1 py-1.5 text-xs rounded-lg border transition-colors",l.investTime===!1?"bg-gray-800 text-white border-gray-800":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"No"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Did you wish for this tool before?"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>y("wishedBefore",!0),className:O("flex-1 py-1.5 text-xs rounded-lg border transition-colors",l.wishedBefore===!0?"bg-black text-white border-black":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Yes"}),o.jsx("button",{onClick:()=>y("wishedBefore",!1),className:O("flex-1 py-1.5 text-xs rounded-lg border transition-colors",l.wishedBefore===!1?"bg-gray-800 text-white border-gray-800":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"No"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Would you refer this to others?"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>y("refer",!0),className:O("flex-1 py-1.5 text-xs rounded-lg border transition-colors",l.refer===!0?"bg-black text-white border-black":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"Yes"}),o.jsx("button",{onClick:()=>y("refer",!1),className:O("flex-1 py-1.5 text-xs rounded-lg border transition-colors",l.refer===!1?"bg-gray-800 text-white border-gray-800":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:"No"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{className:"text-xs font-medium text-gray-700",children:["Share more thoughts? ",o.jsx("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),o.jsx("textarea",{className:"w-full text-xs p-2 rounded-lg border border-gray-200 focus:border-black focus:ring-1 focus:ring-black outline-none resize-none bg-gray-50",rows:2,placeholder:"What was your impression?",onChange:S=>y("feedbackText",S.target.value)})]})]}):o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-medium text-gray-700",children:"What went wrong?"}),o.jsx("div",{className:"flex flex-col gap-1.5",children:["Buggy","Confusing","Didn't solve problem"].map(S=>o.jsx("button",{onClick:()=>y("whatWentWrong",S),className:O("w-full text-left px-3 py-2 text-xs rounded-lg border transition-colors",l.whatWentWrong===S?"bg-gray-50 border-gray-300 text-black font-medium":"border-gray-200 text-gray-600 hover:bg-gray-50"),children:S},S))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs font-medium text-gray-700",children:"One thing to fix?"}),o.jsx("textarea",{className:"w-full text-xs p-2 rounded-lg border border-gray-200 focus:border-black focus:ring-1 focus:ring-black outline-none resize-none bg-gray-50",rows:2,placeholder:"Tell us what to improve...",onChange:S=>y("feedbackText",S.target.value)})]})]}),o.jsx("button",{onClick:j,disabled:u,className:"w-full py-2.5 bg-black hover:bg-gray-800 text-white text-xs font-semibold rounded-xl shadow-sm transition-all active:scale-95 flex items-center justify-center gap-2 mt-2 disabled:opacity-70 disabled:cursor-not-allowed",children:u?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Sending..."]}):o.jsxs(o.Fragment,{children:["Submit Feedback",o.jsx(_a,{className:"w-3 h-3"})]})})]}),s===3&&o.jsxs("div",{className:"py-6 text-center animate-fade-in",children:[o.jsx("div",{className:"w-12 h-12 bg-gray-100 text-black rounded-full flex items-center justify-center mx-auto mb-3",children:o.jsx(Pr,{className:"w-6 h-6"})}),o.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Thank You!"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-6",children:"Your feedback helps us build better."}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("button",{onClick:b,className:"w-full py-2.5 bg-black hover:bg-gray-800 text-white text-xs font-semibold rounded-xl shadow-sm transition-all active:scale-95",children:"Submit Another Response"}),o.jsx("button",{onClick:m,className:"w-full py-2.5 bg-white border border-gray-200 hover:bg-gray-50 text-gray-600 text-xs font-semibold rounded-xl transition-all active:scale-95",children:"Close"})]})]})]})]})})},sn=({children:r,header:e})=>o.jsxs("div",{className:"h-screen w-full bg-white text-gray-900 font-sans flex flex-col overflow-hidden",children:[e&&o.jsx("header",{className:"sticky top-0 z-40 bg-white/80 backdrop-blur-md border-b border-gray-100 px-4 py-3 flex items-center justify-between",children:e}),o.jsx("main",{className:"flex-1 flex flex-col p-4 relative overflow-hidden",children:r})]}),La=["Analyzing prompts","Extracting insights","Drafting summary"],Ma=["Re-analyzing prompts","Re-extracting insights","Re-drafting summary"],Xr=({onGenerate:r,state:e,isRegenerating:t=!1,disabled:s=!1,compact:i=!1})=>{const n=P.useRef(null),a=t?Ma:La,[l,c]=P.useState("paragraph"),[u,d]=P.useState("normal"),[h,f]=P.useState(""),[g,m]=P.useState(0),[v,y]=P.useState(!1),[j,b]=P.useState(0);P.useEffect(()=>{if(e==="idle"){b(0),m(0),y(!1);return}if(e==="generating"){m(0),y(!1),b(0);const N=setInterval(()=>{b(R=>R+.1)},100),$=setInterval(()=>{m(R=>R<a.length?R+1:R)},800);return()=>{clearInterval(N),clearInterval($)}}},[e,a.length]);const T=N=>{if(!N.value.trim()){N.style.height="24px";return}N.style.height="auto";const R=Math.max(24,Math.min(N.scrollHeight,120));N.style.height=`${R}px`},S=N=>{f(N.target.value),T(N.target)};return P.useEffect(()=>{n.current&&T(n.current)},[h]),i&&e==="idle"?o.jsx(D,{content:s?"Not available on this page":"Generate Summary",children:o.jsx("button",{onClick:()=>!s&&r(h,l,u),disabled:s,className:O("w-10 h-10 rounded-full flex items-center justify-center transition-colors group shadow-md",s?"bg-gray-200 cursor-not-allowed":"bg-black hover:bg-gray-800"),children:o.jsx(ss,{className:O("w-5 h-5",s?"text-gray-400":"text-white")})})}):o.jsxs("div",{className:O("relative w-full font-medium text-sm transition-all duration-300 ease-in-out bg-white text-gray-900 border border-gray-200",e==="idle"?"rounded-2xl":"rounded-xl",e==="idle"?"":e==="generating"||v?"min-h-[160px]":"h-12"),children:[e==="idle"&&o.jsxs("div",{className:"flex flex-col p-5 gap-6 animate-fade-in",children:[o.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 p-1 rounded-lg w-fit",children:[o.jsx(D,{content:"Alignment",children:o.jsx("button",{onClick:()=>c("paragraph"),className:O("p-1.5 rounded-md transition-all",l==="paragraph"?"bg-white text-black shadow-sm":"text-gray-400 hover:text-gray-600"),children:o.jsx(xa,{className:"w-4 h-4"})})}),o.jsx(D,{content:"List",children:o.jsx("button",{onClick:()=>c("points"),className:O("p-1.5 rounded-md transition-all",l==="points"?"bg-white text-black shadow-sm":"text-gray-400 hover:text-gray-600"),children:o.jsx(ya,{className:"w-4 h-4"})})})]}),o.jsxs("div",{className:"w-full relative",children:[o.jsx("textarea",{ref:n,placeholder:"type additional information here",value:h,onChange:S,rows:1,spellCheck:!0,className:"w-full border-none p-0 pr-2 text-base font-medium placeholder:text-gray-300 focus:ring-0 focus:outline-none text-gray-900 bg-transparent resize-none min-h-[24px] max-h-[120px] overflow-y-auto"}),o.jsx("div",{className:"w-full h-px bg-gray-100 mt-3"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>d(N=>N==="professional"?"normal":"professional"),className:O("px-3 py-1.5 rounded-full text-xs font-medium transition-colors",u==="professional"?"bg-gray-200 text-gray-900":"bg-gray-50 text-gray-400 hover:bg-gray-100"),children:"professional"}),o.jsx("button",{onClick:()=>d(N=>N==="creative"?"normal":"creative"),className:O("px-3 py-1.5 rounded-full text-xs font-medium transition-colors",u==="creative"?"bg-gray-200 text-gray-900":"bg-gray-50 text-gray-400 hover:bg-gray-100"),children:"creative"})]}),o.jsx(D,{content:s?"Not available on this page":"Generate Summary",children:o.jsx("button",{onClick:()=>!s&&r(h,l,u),disabled:s,className:O("w-10 h-10 rounded-full flex items-center justify-center transition-colors group shadow-md",s?"bg-gray-200 cursor-not-allowed":"bg-black hover:bg-gray-800"),children:o.jsx(ss,{className:O("w-5 h-5",s?"text-gray-400":"text-white")})})})]})]}),e==="generating"&&o.jsxs("div",{className:"flex flex-col justify-center min-h-[160px] p-6 gap-3 animate-fade-in",children:[a.map((N,$)=>o.jsxs("div",{className:"flex items-center gap-3",children:[$<g?o.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx(zt,{className:"w-3 h-3 text-green-600"})}):$===g?o.jsx(ba,{className:"w-5 h-5 text-black animate-spin"}):o.jsx("div",{className:"w-5 h-5 rounded-full border border-gray-200"}),o.jsx("span",{className:O("text-sm transition-colors",$<=g?"text-gray-900 font-medium":"text-gray-400"),children:N})]},$)),o.jsxs("div",{className:"absolute bottom-4 right-6 text-xs text-gray-400 font-mono",children:[j.toFixed(1),"s"]})]}),e==="completed"&&o.jsxs("div",{className:"w-full h-full flex flex-col animate-fade-in",children:[!v&&o.jsxs("button",{onClick:()=>y(!0),className:"w-full h-12 flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors rounded-xl",children:[o.jsxs("div",{className:"w-5 h-5 rounded-full bg-green-100 flex items-center justify-center",children:[o.jsx(ss,{className:"w-3 h-3 text-green-600 -rotate-90"})," "]}),o.jsx("span",{className:"font-medium text-gray-900",children:"Summary Generated"}),o.jsxs("span",{className:"text-[10px] text-black font-medium ml-1",children:["on ",new Date().toLocaleDateString("en-GB",{day:"numeric",month:"short"}),", ",new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})]})]}),v&&o.jsxs("div",{className:"flex flex-col justify-center min-h-[160px] p-6 gap-3 relative",children:[a.map((N,$)=>o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx(zt,{className:"w-3 h-3 text-green-600"})}),o.jsx("span",{className:"text-sm text-gray-900 font-medium",children:N})]},$)),o.jsx("button",{onClick:()=>y(!1),className:"absolute top-4 right-4 p-1 hover:bg-gray-100 rounded-full transition-colors",children:o.jsx(wa,{className:"w-4 h-4 text-gray-400"})}),o.jsxs("div",{className:"absolute bottom-4 right-6 text-xs text-gray-400 font-mono",children:[j.toFixed(1),"s"]})]})]}),e==="error"&&o.jsxs("button",{onClick:()=>r(h,l,u),className:"w-full h-12 flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors rounded-xl bg-gray-50 border border-gray-100",children:[o.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center",children:o.jsx(ss,{className:"w-3 h-3 text-gray-500"})}),o.jsx("span",{className:"font-medium text-gray-500",children:"Try Again"})]})]})},Da="https://tai-backend.amaravadhibharath.workers.dev",za=async(r,e,t="auto",s,i,n)=>{try{let a=r;s&&(a=`[User Context/Note: ${s}]

${r}`);const l={"Content-Type":"application/json"};i&&(l.Authorization=`Bearer ${i}`);const c=await fetch(Da,{method:"POST",headers:l,body:JSON.stringify({content:a,provider:t,deviceId:n,options:{format:e.format,includeAI:e.includeAI,images:e.images,tone:e.tone}})});if(!c.ok){const d=await c.json();throw new Error(d.error||`Worker Error: ${c.status}`)}const u=await c.json();return u.quotaUsed!==void 0&&u.quotaLimit!==void 0&&chrome.storage.local.set({quotaUsed:u.quotaUsed,quotaLimit:u.quotaLimit}),u.summary}catch(a){throw new Error(a.message||"Failed to connect to Tiger Backend.")}};var p=typeof window<"u"?window:void 0,oe=typeof globalThis<"u"?globalThis:p;typeof self>"u"&&(oe.self=oe),typeof File>"u"&&(oe.File=function(){});var rn=Array.prototype,Jr=rn.forEach,Kr=rn.indexOf,ye=oe?.navigator,w=oe?.document,me=oe?.location,rr=oe?.fetch,ir=oe!=null&&oe.XMLHttpRequest&&"withCredentials"in new oe.XMLHttpRequest?oe.XMLHttpRequest:void 0,Zr=oe?.AbortController,ve=ye?.userAgent,I=p??{},Le={DEBUG:!1,LIB_VERSION:"1.306.2"};function Qr(r,e,t,s,i,n,a){try{var l=r[n](a),c=l.value}catch(u){return void t(u)}l.done?e(c):Promise.resolve(c).then(s,i)}function ei(r){return function(){var e=this,t=arguments;return new Promise((function(s,i){var n=r.apply(e,t);function a(c){Qr(n,s,i,a,l,"next",c)}function l(c){Qr(n,s,i,a,l,"throw",c)}a(void 0)}))}}function E(){return E=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)({}).hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},E.apply(null,arguments)}function nn(r,e){if(r==null)return{};var t={};for(var s in r)if({}.hasOwnProperty.call(r,s)){if(e.indexOf(s)!==-1)continue;t[s]=r[s]}return t}var Ha=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],ti=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return Ha.concat(e).some((s=>{var i=s.toLowerCase();return t.indexOf(i)!==-1}))},Ua=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function F(r,e){return r.indexOf(e)!==-1}var Ts=function(r){return r.trim()},nr=function(r){return r.replace(/^\$/,"")},qa=Array.isArray,an=Object.prototype,on=an.hasOwnProperty,Fs=an.toString,L=qa||function(r){return Fs.call(r)==="[object Array]"},Ye=r=>typeof r=="function",te=r=>r===Object(r)&&!L(r),ct=r=>{if(te(r)){for(var e in r)if(on.call(r,e))return!1;return!0}return!1},x=r=>r===void 0,Q=r=>Fs.call(r)=="[object String]",ar=r=>Q(r)&&r.trim().length===0,He=r=>r===null,A=r=>x(r)||He(r),Re=r=>Fs.call(r)=="[object Number]",Xe=r=>Fs.call(r)==="[object Boolean]",Ba=r=>r instanceof FormData,Ga=r=>F(Ua,r);function or(r){return r===null||typeof r!="object"}function vs(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function ln(r){return!x(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var Va=[!0,"true",1,"1","yes"],Ds=r=>F(Va,r),Wa=[!1,"false",0,"0","no"];function Te(r,e,t,s,i){return e>t&&(s.warn("min cannot be greater than max."),e=t),Re(r)?r>t?(s.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(s.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(s.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+i),Te(i||t,e,t,s))}class Ya{constructor(e){this.t={},this.i=e.i,this.o=Te(e.bucketSize,0,100,e.h),this.m=Te(e.refillRate,0,this.o,e.h),this.S=Te(e.refillInterval,0,864e5,e.h)}$(e,t){var s=t-e.lastAccess,i=Math.floor(s/this.S);if(i>0){var n=i*this.m;e.tokens=Math.min(e.tokens+n,this.o),e.lastAccess=e.lastAccess+i*this.S}}consumeRateLimit(e){var t,s=Date.now(),i=String(e),n=this.t[i];return n?this.$(n,s):(n={tokens:this.o,lastAccess:s},this.t[i]=n),n.tokens===0||(n.tokens--,n.tokens===0&&((t=this.i)==null||t.call(this,e)),n.tokens===0)}stop(){this.t={}}}var ns,si,zs,Xa=r=>r instanceof Error;function Ja(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return zs&&t.length===si||(si=t.length,zs=t.reduce(((s,i)=>{ns||(ns={});var n=ns[i];if(n)s[n[0]]=n[1];else for(var a=r(i),l=a.length-1;l>=0;l--){var c=a[l],u=c?.filename,d=e[i];if(u&&d){s[u]=d,ns[i]=[u,d];break}}return s}),{})),zs}}class Ka{constructor(e,t,s){s===void 0&&(s=[]),this.coercers=e,this.stackParser=t,this.modifiers=s}buildFromUnknown(e,t){t===void 0&&(t={});var s=t&&t.mechanism||{handled:!0,type:"generic"},i=this.buildCoercingContext(s,t,0).apply(e),n=this.buildParsingContext(),a=this.parseStacktrace(i,n);return{$exception_list:this.convertToExceptionList(a,s),$exception_level:"error"}}modifyFrames(e){var t=this;return ei((function*(){for(var s of e)s.stacktrace&&s.stacktrace.frames&&L(s.stacktrace.frames)&&(s.stacktrace.frames=yield t.applyModifiers(s.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var s,i;return e.cause!=null&&(s=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(i=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?1:0),t.chunkIdMap)),E({},e,{cause:s,stack:i})}applyChunkIds(e,t){return e.map((s=>(s.filename&&t&&(s.chunk_id=t[s.filename]),s)))}applyCoercers(e,t){for(var s of this.coercers)if(s.match(e))return s.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return ei((function*(){var s=e;for(var i of t.modifiers)s=yield i(s);return s}))()}convertToExceptionList(e,t){var s,i,n,a={type:e.type,value:e.value,mechanism:{type:(s=t.type)!==null&&s!==void 0?s:"generic",handled:(i=t.handled)===null||i===void 0||i,synthetic:(n=e.synthetic)!==null&&n!==void 0&&n}};e.stack&&(a.stacktrace={type:"raw",frames:e.stack});var l=[a];return e.cause!=null&&l.push(...this.convertToExceptionList(e.cause,E({},t,{handled:!0}))),l}buildParsingContext(){return{chunkIdMap:Ja(this.stackParser)}}buildCoercingContext(e,t,s){s===void 0&&(s=0);var i=(n,a)=>{if(a<=4){var l=this.buildCoercingContext(e,t,a);return this.applyCoercers(n,l)}};return E({},t,{syntheticException:s==0?t.syntheticException:void 0,mechanism:e,apply:n=>i(n,s),next:n=>i(n,s+1)})}}var pt="?";function lr(r,e,t,s,i){var n={platform:r,filename:e,function:t==="<anonymous>"?pt:t,in_app:!0};return x(s)||(n.lineno=s),x(i)||(n.colno=i),n}var cn=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,s=r.indexOf("safari-web-extension")!==-1;return t||s?[r.indexOf("@")!==-1?r.split("@")[0]:pt,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},Za=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Qa=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,eo=/\((\S*)(?::(\d+))(?::(\d+))\)/,to=(r,e)=>{var t=Za.exec(r);if(t){var[,s,i,n]=t;return lr(e,s,pt,+i,+n)}var a=Qa.exec(r);if(a){if(a[2]&&a[2].indexOf("eval")===0){var l=eo.exec(a[2]);l&&(a[2]=l[1],a[3]=l[2],a[4]=l[3])}var[c,u]=cn(a[1]||pt,a[2]);return lr(e,u,c,a[3]?+a[3]:void 0,a[4]?+a[4]:void 0)}},so=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,ro=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,io=(r,e)=>{var t=so.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var s=ro.exec(t[3]);s&&(t[1]=t[1]||"eval",t[3]=s[1],t[4]=s[2],t[5]="")}var i=t[3],n=t[1]||pt;return[n,i]=cn(n,i),lr(e,i,n,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},ri=/\(error: (.*)\)/,ii=50;function no(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return function(i,n){n===void 0&&(n=0);for(var a=[],l=i.split(`
`),c=n;c<l.length;c++){var u=l[c];if(!(u.length>1024)){var d=ri.test(u)?u.replace(ri,"$1"):u;if(!d.match(/\S*Error: /)){for(var h of t){var f=h(d,r);if(f){a.push(f);break}}if(a.length>=ii)break}}}return(function(g){if(!g.length)return[];var m=Array.from(g);return m.reverse(),m.slice(0,ii).map((v=>{return E({},v,{filename:v.filename||(y=m,y[y.length-1]||{}).filename,function:v.function||pt});var y}))})(a)}}class ao{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var s=Q(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:s?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return vs(e,"DOMException")}isDOMError(e){return vs(e,"DOMError")}}class oo{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var s=e.message;return s.error&&typeof s.error.message=="string"?String(s.error.message):String(s)}getStack(e){return e.stacktrace||e.stack||void 0}}class lo{constructor(){}match(e){return vs(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var s,i=t.apply(e.error);return i||{type:"ErrorEvent",value:e.message,stack:(s=t.syntheticException)==null?void 0:s.stack,synthetic:!0}}}var co=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class uo{match(e){return typeof e=="string"}coerce(e,t){var s,[i,n]=this.getInfos(e);return{type:i??"Error",value:n??e,stack:(s=t.syntheticException)==null?void 0:s.stack,synthetic:!0}}getInfos(e){var t="Error",s=e,i=e.match(co);return i&&(t=i[1],s=i[2]),[t,s]}}var ho=["fatal","error","warning","log","info","debug"];function un(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var s=t.length;s>0;s--){var i=t.slice(0,s).join(", ");if(!(i.length>e))return s===t.length||i.length<=e?i:i.slice(0,e)+"..."}return""}class po{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var s,i=this.getErrorPropertyFromObject(e);return i?t.apply(i):{type:this.getType(e),value:this.getValue(e),stack:(s=t.syntheticException)==null?void 0:s.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return ln(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var s=this.getObjectClassName(e);return(s&&s!=="Object"?"'"+s+"'":"Object")+" captured as exception with keys: "+un(e)}isSeverityLevel(e){return Q(e)&&!ar(e)&&ho.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var s=e[t];if(Xa(s))return s}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class go{match(e){return ln(e)}coerce(e,t){var s,i=e.constructor.name;return{type:i,value:i+" captured as exception with keys: "+un(e),stack:(s=t.syntheticException)==null?void 0:s.stack,synthetic:!0}}}class fo{match(e){return or(e)}coerce(e,t){var s;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(s=t.syntheticException)==null?void 0:s.stack,synthetic:!0}}}class vo{match(e){return vs(e,"PromiseRejectionEvent")}coerce(e,t){var s,i=this.getUnhandledRejectionReason(e);return or(i)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(i),stack:(s=t.syntheticException)==null?void 0:s.stack,synthetic:!0}:t.apply(i)}getUnhandledRejectionReason(e){if(or(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var dn=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,s={k:function(i){if(p&&(Le.DEBUG||I.POSTHOG_DEBUG||t)&&!x(p.console)&&p.console){for(var n=("__rrweb_original__"in p.console[i])?p.console[i].__rrweb_original__:p.console[i],a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];n(r,...l)}},info:function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];s.k("log",...n)},warn:function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];s.k("warn",...n)},error:function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];s.k("error",...n)},critical:function(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a]},uninitializedWarning:i=>{s.error("You must initialize PostHog before calling "+i)},createLogger:(i,n)=>dn(r+" "+i,n)};return s},k=dn("[PostHog.js]"),J=k.createLogger,mo=J("[ExternalScriptsLoader]"),ni=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return mo.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var s=w?.querySelectorAll("script");if(s){for(var i,n=function(){if(s[a].src===e){var c=s[a];return c.__posthog_loading_callback_fired?{v:t()}:(c.addEventListener("load",(u=>{c.__posthog_loading_callback_fired=!0,t(void 0,u)})),c.onerror=u=>t(u),{v:void 0})}},a=0;a<s.length;a++)if(i=n())return i.v}var l=()=>{if(!w)return t("document not found");var c=w.createElement("script");if(c.type="text/javascript",c.crossOrigin="anonymous",c.src=e,c.onload=h=>{c.__posthog_loading_callback_fired=!0,t(void 0,h)},c.onerror=h=>t(h),r.config.prepare_external_dependency_script&&(c=r.config.prepare_external_dependency_script(c)),!c)return t("prepare_external_dependency_script returned null");var u,d=w.querySelectorAll("body > script");d.length>0?(u=d[0].parentNode)==null||u.insertBefore(c,d[0]):w.body.appendChild(c)};w!=null&&w.body?l():w?.addEventListener("DOMContentLoaded",l)};I.__PosthogExtensions__=I.__PosthogExtensions__||{},I.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var s="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(s="/array/"+r.config.token+"/config.js"),e==="toolbar"){var i=3e5;s=s+"&t="+Math.floor(Date.now()/i)*i}var n=r.requestRouter.endpointFor("assets",s);ni(r,n,t)},I.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var s=r.requestRouter.endpointFor("api",e);ni(r,s,t)};var ms={};function Je(r,e,t){if(L(r)){if(Jr&&r.forEach===Jr)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var s=0,i=r.length;s<i;s++)if(s in r&&e.call(t,r[s],s)===ms)return}}}function z(r,e,t){if(!A(r)){if(L(r))return Je(r,e,t);if(Ba(r)){for(var s of r.entries())if(e.call(t,s[1],s[0])===ms)return}else for(var i in r)if(on.call(r,i)&&e.call(t,r[i],i)===ms)return}}var V=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return Je(t,(function(i){for(var n in i)i[n]!==void 0&&(r[n]=i[n])})),r},vt=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return Je(t,(function(i){Je(i,(function(n){r.push(n)}))})),r};function ps(r){for(var e=Object.keys(r),t=e.length,s=new Array(t);t--;)s[t]=[e[t],r[e[t]]];return s}var ai=function(r){try{return r()}catch{return}},_o=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return r.apply(this,t)}catch(i){k.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),k.critical(i)}}},Ir=function(r){var e={};return z(r,(function(t,s){(Q(t)&&t.length>0||Re(t))&&(e[s]=t)})),e};function xo(r,e){return t=r,s=n=>Q(n)&&!He(e)?n.slice(0,e):n,i=new Set,(function n(a,l){return a!==Object(a)?s?s(a,l):a:i.has(a)?void 0:(i.add(a),L(a)?(c=[],Je(a,(u=>{c.push(n(u))}))):(c={},z(a,((u,d)=>{i.has(u)||(c[d]=n(u,d))}))),c);var c})(t);var t,s,i}var yo=["herokuapp.com","vercel.app","netlify.app"];function bo(r){var e=r?.hostname;if(!Q(e))return!1;var t=e.split(".").slice(-2).join(".");for(var s of yo)if(t===s)return!1;return!0}function hn(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function X(r,e,t,s){var{capture:i=!1,passive:n=!0}=s??{};r?.addEventListener(e,t,{capture:i,passive:n})}var pn="$people_distinct_id",Tt="__alias",Ft="__timers",oi="$autocapture_disabled_server_side",cr="$heatmaps_enabled_server_side",li="$exception_capture_enabled_server_side",ur="$error_tracking_suppression_rules",ci="$error_tracking_capture_extension_exceptions",ui="$web_vitals_enabled_server_side",gn="$dead_clicks_enabled_server_side",di="$web_vitals_allowed_metrics",Hs="$session_recording_remote_config",_s="$sesid",fn="$session_is_sampled",ut="$enabled_feature_flags",$t="$early_access_features",dr="$feature_flag_details",Rt="$stored_person_properties",st="$stored_group_properties",hr="$surveys",as="$surveys_activated",xs="$flag_call_reported",Me="$user_state",pr="$client_session_props",gr="$capture_rate_limit",fr="$initial_campaign_params",vr="$initial_referrer_info",ys="$initial_person_info",bs="$epp",vn="__POSTHOG_TOOLBAR__",wt="$posthog_cookieless",wo=[pn,Tt,"__cmpns",Ft,"$session_recording_enabled_server_side",cr,_s,ut,ur,Me,$t,dr,st,Rt,hr,xs,pr,gr,fr,vr,bs,ys];function hi(r){return r instanceof Element&&(r.id===vn||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function $s(r){return!!r&&r.nodeType===1}function Ke(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function mn(r){return!!r&&r.nodeType===3}function _n(r){return!!r&&r.nodeType===11}function Tr(r){return r?Ts(r).split(/\s+/):[]}function pi(r){var e=p?.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function ws(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return Tr(e)}function xn(r){return A(r)?null:Ts(r).split(/(\s+)/).filter((e=>Ht(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function Wt(r){var e="";return mr(r)&&!jn(r)&&r.childNodes&&r.childNodes.length&&z(r.childNodes,(function(t){var s;mn(t)&&t.textContent&&(e+=(s=xn(t.textContent))!==null&&s!==void 0?s:"")})),Ts(e)}function yn(r){return x(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var Fr=["a","button","form","input","select","textarea","label"];function bn(r,e){if(x(e))return!0;var t,s=function(n){if(e.some((a=>n.matches(a))))return{v:!0}};for(var i of r)if(t=s(i))return t.v;return!1}function wn(r){var e=r.parentNode;return!(!e||!$s(e))&&e}var ko=["next","previous","prev",">","<"],gi=10,fi=[".ph-no-rageclick",".ph-no-capture"];function jo(r,e){if(!p||$r(r))return!1;var t,s,i;if(Xe(e)?(t=!!e&&fi,s=void 0):(t=(i=e?.css_selector_ignorelist)!==null&&i!==void 0?i:fi,s=e?.content_ignorelist),t===!1)return!1;var{targetElementList:n}=kn(r,!1);return!(function(a,l){if(a===!1||x(a))return!1;var c;if(a===!0)c=ko;else{if(!L(a))return!1;if(a.length>gi)return k.error("[PostHog] content_ignorelist array cannot exceed "+gi+" items. Use css_selector_ignorelist for more complex matching."),!1;c=a.map((u=>u.toLowerCase()))}return l.some((u=>{var{safeText:d,ariaLabel:h}=u;return c.some((f=>d.includes(f)||h.includes(f)))}))})(s,n.map((a=>{var l;return{safeText:Wt(a).toLowerCase(),ariaLabel:((l=a.getAttribute("aria-label"))==null?void 0:l.toLowerCase().trim())||""}})))&&!bn(n,t)}var $r=r=>!r||Ke(r,"html")||!$s(r),kn=(r,e)=>{if(!p||$r(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,s=[r],i=r;i.parentNode&&!Ke(i,"body");)if(_n(i.parentNode))s.push(i.parentNode.host),i=i.parentNode.host;else{var n=wn(i);if(!n)break;if(e||Fr.indexOf(n.tagName.toLowerCase())>-1)t=!0;else{var a=p.getComputedStyle(n);a&&a.getPropertyValue("cursor")==="pointer"&&(t=!0)}s.push(n),i=n}return{parentIsUsefulElement:t,targetElementList:s}};function Eo(r,e,t,s,i){var n,a,l,c;if(t===void 0&&(t=void 0),!p||$r(r)||(n=t)!=null&&n.url_allowlist&&!pi(t.url_allowlist)||(a=t)!=null&&a.url_ignorelist&&pi(t.url_ignorelist))return!1;if((l=t)!=null&&l.dom_event_allowlist){var u=t.dom_event_allowlist;if(u&&!u.some((m=>e.type===m)))return!1}var{parentIsUsefulElement:d,targetElementList:h}=kn(r,s);if(!(function(m,v){var y=v?.element_allowlist;if(x(y))return!0;var j,b=function(S){if(y.some((N=>S.tagName.toLowerCase()===N)))return{v:!0}};for(var T of m)if(j=b(T))return j.v;return!1})(h,t)||!bn(h,(c=t)==null?void 0:c.css_selector_allowlist))return!1;var f=p.getComputedStyle(r);if(f&&f.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var g=r.tagName.toLowerCase();switch(g){case"html":return!1;case"form":return(i||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(i||["change","click"]).indexOf(e.type)>=0;default:return d?(i||["click"]).indexOf(e.type)>=0:(i||["click"]).indexOf(e.type)>=0&&(Fr.indexOf(g)>-1||r.getAttribute("contenteditable")==="true")}}function mr(r){for(var e=r;e.parentNode&&!Ke(e,"body");e=e.parentNode){var t=ws(e);if(F(t,"ph-sensitive")||F(t,"ph-no-capture"))return!1}if(F(ws(r),"ph-include"))return!0;var s=r.type||"";if(Q(s))switch(s.toLowerCase()){case"hidden":case"password":return!1}var i=r.name||r.id||"";return!(Q(i)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(i.replace(/[^a-zA-Z0-9]/g,"")))}function jn(r){return!!(Ke(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||Ke(r,"select")||Ke(r,"textarea")||r.getAttribute("contenteditable")==="true")}var En="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",No=new RegExp("^(?:"+En+")$"),So=new RegExp(En),Nn="\\d{3}-?\\d{2}-?\\d{4}",Co=new RegExp("^("+Nn+")$"),Po=new RegExp("("+Nn+")");function Ht(r,e){return e===void 0&&(e=!0),!(A(r)||Q(r)&&(r=Ts(r),(e?No:So).test((r||"").replace(/[- ]/g,""))||(e?Co:Po).test(r)))}function Sn(r){var e=Wt(r);return Ht(e=(e+" "+Cn(r)).trim())?e:""}function Cn(r){var e="";return r&&r.childNodes&&r.childNodes.length&&z(r.childNodes,(function(t){var s;if(t&&((s=t.tagName)==null?void 0:s.toLowerCase())==="span")try{var i=Wt(t);e=(e+" "+i).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+Cn(t)).trim())}catch(n){k.error("[AutoCapture]",n)}})),e}function Io(r){return(function(e){var t=e.map((s=>{var i,n,a="";if(s.tag_name&&(a+=s.tag_name),s.attr_class)for(var l of(s.attr_class.sort(),s.attr_class))a+="."+l.replace(/"/g,"");var c=E({},s.text?{text:s.text}:{},{"nth-child":(i=s.nth_child)!==null&&i!==void 0?i:0,"nth-of-type":(n=s.nth_of_type)!==null&&n!==void 0?n:0},s.href?{href:s.href}:{},s.attr_id?{attr_id:s.attr_id}:{},s.attributes),u={};return ps(c).sort(((d,h)=>{var[f]=d,[g]=h;return f.localeCompare(g)})).forEach((d=>{var[h,f]=d;return u[vi(h.toString())]=vi(f.toString())})),a+=":",a+=ps(u).map((d=>{var[h,f]=d;return h+'="'+f+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var s,i,n={text:(s=t.$el_text)==null?void 0:s.slice(0,400),tag_name:t.tag_name,href:(i=t.attr__href)==null?void 0:i.slice(0,2048),attr_class:To(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return ps(t).filter((a=>{var[l]=a;return l.indexOf("attr__")===0})).forEach((a=>{var[l,c]=a;return n.attributes[l]=c})),n}))})(r))}function vi(r){return r.replace(/"|\\"/g,'\\"')}function To(r){var e=r.attr__class;return e?L(e)?e:Tr(e):void 0}class Pn{constructor(e){this.disabled=e===!1;var t=te(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,s){if(this.disabled)return!1;var i=this.clicks[this.clicks.length-1];if(i&&Math.abs(e-i.x)+Math.abs(t-i.y)<this.thresholdPx&&s-i.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:s}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:s}];return!1}}var Us="$copy_autocapture",ze=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),ks=r=>{var e=w?.createElement("a");return x(e)?null:(e.href=r,e)},Fo=function(r,e){var t,s;e===void 0&&(e="&");var i=[];return z(r,(function(n,a){x(n)||x(a)||a==="undefined"||(t=encodeURIComponent((l=>l instanceof File)(n)?n.name:n.toString()),s=encodeURIComponent(a),i[i.length]=s+"="+t)})),i.join(e)},js=function(r,e){for(var t,s=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),i=0;i<s.length;i++){var n=s[i].split("=");if(n[0]===e){t=n;break}}if(!L(t)||t.length<2)return"";var a=t[1];try{a=decodeURIComponent(a)}catch{k.error("Skipping decoding for malformed query param: "+a)}return a.replace(/\+/g," ")},Yt=function(r,e,t){if(!r||!e||!e.length)return r;for(var s=r.split("#"),i=s[0]||"",n=s[1],a=i.split("?"),l=a[1],c=a[0],u=(l||"").split("&"),d=[],h=0;h<u.length;h++){var f=u[h].split("=");L(f)&&(e.includes(f[0])?d.push(f[0]+"="+t):d.push(u[h]))}var g=c;return l!=null&&(g+="?"+d.join("&")),n!=null&&(g+="#"+n),g},Es=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},mi=J("[AutoCapture]");function qs(r,e){return e.length>r?e.slice(0,r)+"...":e}function $o(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!$s(e));return e}function Ro(r,e,t,s){var i=r.tagName.toLowerCase(),n={tag_name:i};Fr.indexOf(i)>-1&&!t&&(i.toLowerCase()==="a"||i.toLowerCase()==="button"?n.$el_text=qs(1024,Sn(r)):n.$el_text=qs(1024,Wt(r)));var a=ws(r);a.length>0&&(n.classes=a.filter((function(d){return d!==""}))),z(r.attributes,(function(d){var h;if((!jn(r)||["name","id","class","aria-label"].indexOf(d.name)!==-1)&&(s==null||!s.includes(d.name))&&!e&&Ht(d.value)&&(h=d.name,!Q(h)||h.substring(0,10)!=="_ngcontent"&&h.substring(0,7)!=="_nghost")){var f=d.value;d.name==="class"&&(f=Tr(f).join(" ")),n["attr__"+d.name]=qs(1024,f)}}));for(var l=1,c=1,u=r;u=$o(u);)l++,u.tagName===r.tagName&&c++;return n.nth_child=l,n.nth_of_type=c,n}function Oo(r,e){for(var t,s,{e:i,maskAllElementAttributes:n,maskAllText:a,elementAttributeIgnoreList:l,elementsChainAsString:c}=e,u=[r],d=r;d.parentNode&&!Ke(d,"body");)_n(d.parentNode)?(u.push(d.parentNode.host),d=d.parentNode.host):(u.push(d.parentNode),d=d.parentNode);var h,f=[],g={},m=!1,v=!1;if(z(u,(S=>{var N=mr(S);S.tagName.toLowerCase()==="a"&&(m=S.getAttribute("href"),m=N&&m&&Ht(m)&&m),F(ws(S),"ph-no-capture")&&(v=!0),f.push(Ro(S,n,a,l));var $=(function(R){if(!mr(R))return{};var C={};return z(R.attributes,(function(se){if(se.name&&se.name.indexOf("data-ph-capture-attribute")===0){var le=se.name.replace("data-ph-capture-attribute-",""),W=se.value;le&&W&&Ht(W)&&(C[le]=W)}})),C})(S);V(g,$)})),v)return{props:{},explicitNoCapture:v};if(a||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?f[0].$el_text=Sn(r):f[0].$el_text=Wt(r)),m){var y,j;f[0].attr__href=m;var b=(y=ks(m))==null?void 0:y.host,T=p==null||(j=p.location)==null?void 0:j.host;b&&T&&b!==T&&(h=m)}return{props:V({$event_type:i.type,$ce_version:1},c?{}:{$elements:f},{$elements_chain:Io(f)},(t=f[0])!=null&&t.$el_text?{$el_text:(s=f[0])==null?void 0:s.$el_text}:{},h&&i.type==="click"?{$external_click_url:h}:{},g)}}class Ao{constructor(e){this.P=!1,this.T=null,this.R=!1,this.instance=e,this.rageclicks=new Pn(e.config.rageclick),this.C=null}get I(){var e,t,s=te(this.instance.config.autocapture)?this.instance.config.autocapture:{};return s.url_allowlist=(e=s.url_allowlist)==null?void 0:e.map((i=>new RegExp(i))),s.url_ignorelist=(t=s.url_ignorelist)==null?void 0:t.map((i=>new RegExp(i))),s}F(){if(this.isBrowserSupported()){if(p&&w){var e=s=>{s=s||p?.event;try{this.M(s)}catch(i){mi.error("Failed to capture event",i)}};if(X(w,"submit",e,{capture:!0}),X(w,"change",e,{capture:!0}),X(w,"click",e,{capture:!0}),this.I.capture_copied_text){var t=s=>{s=s||p?.event,this.M(s,Us)};X(w,"copy",t,{capture:!0}),X(w,"cut",t,{capture:!0})}}}else mi.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.R=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[oi]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,s=[];return(t=this.C)==null||t.forEach((i=>{var n=w?.querySelectorAll(i);n?.forEach((a=>{e===a&&s.push(i)}))})),s}get isEnabled(){var e,t,s=(e=this.instance.persistence)==null?void 0:e.props[oi],i=this.T;if(He(i)&&!Xe(s)&&!this.instance.O())return!1;var n=(t=this.T)!==null&&t!==void 0?t:!!s;return!!this.instance.config.autocapture&&!n}M(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var s,i=yn(e);mn(i)&&(i=i.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(s=this.rageclicks)!=null&&s.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&jo(i,this.instance.config.rageclick)&&this.M(e,"$rageclick");var n=t===Us;if(i&&Eo(i,e,this.I,n,n?["copy","cut"]:void 0)){var{props:a,explicitNoCapture:l}=Oo(i,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.I.element_attribute_ignorelist,elementsChainAsString:this.R});if(l)return!1;var c=this.getElementSelectors(i);if(c&&c.length>0&&(a.$element_selectors=c),t===Us){var u,d=xn(p==null||(u=p.getSelection())==null?void 0:u.toString()),h=e.type||"clipboard";if(!d)return!1;a.$selected_content=d,a.$copy_type=h}return this.instance.capture(t,a),!0}}}isBrowserSupported(){return Ye(w?.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return Re(r)&&isFinite(r)&&Math.floor(r)===r});var _i="0123456789abcdef";class Ns{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,s,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(s)||!Number.isInteger(i)||e<0||t<0||s<0||i<0||e>0xffffffffffff||t>4095||s>1073741823||i>4294967295)throw new RangeError("invalid field value");var n=new Uint8Array(16);return n[0]=e/Math.pow(2,40),n[1]=e/Math.pow(2,32),n[2]=e/Math.pow(2,24),n[3]=e/Math.pow(2,16),n[4]=e/Math.pow(2,8),n[5]=e,n[6]=112|t>>>8,n[7]=t,n[8]=128|s>>>24,n[9]=s>>>16,n[10]=s>>>8,n[11]=s,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i,new Ns(n)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+_i.charAt(this.bytes[t]>>>4)+_i.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new Ns(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var s=this.bytes[t]-e.bytes[t];if(s!==0)return Math.sign(s)}return 0}}class Lo{constructor(){this.A=0,this.D=0,this.j=new Mo}generate(){var e=this.generateOrAbort();if(x(e)){this.A=0;var t=this.generateOrAbort();if(x(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.D++,this.D>4398046511103&&(this.A++,this.L())}return Ns.fromFieldsV7(this.A,Math.trunc(this.D/Math.pow(2,30)),this.D&Math.pow(2,30)-1,this.j.nextUint32())}L(){this.D=1024*this.j.nextUint32()+(1023&this.j.nextUint32())}}var xi,In=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};p&&!x(p.crypto)&&crypto.getRandomValues&&(In=r=>crypto.getRandomValues(r));class Mo{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(In(this.N),this.U=0),this.N[this.U++]}}var We=()=>Do().toString(),Do=()=>(xi||(xi=new Lo)).generate(),kt="",zo=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Ho(r,e){if(e){var t=(function(i,n){if(n===void 0&&(n=w),kt)return kt;if(!n||["localhost","127.0.0.1"].includes(i))return"";for(var a=i.split("."),l=Math.min(a.length,8),c="dmn_chk_"+We();!kt&&l--;){var u=a.slice(l).join("."),d=c+"=1;domain=."+u+";path=/";n.cookie=d+";max-age=3",n.cookie.includes(c)&&(n.cookie=d+";max-age=0",kt=u)}return kt})(r);if(!t){var s=(i=>{var n=i.match(zo);return n?n[0]:""})(r);s!==t&&k.info("Warning: cookie subdomain discovery mismatch",s,t),t=s}return t?"; domain=."+t:""}return""}var $e={H:()=>!!w,B:function(r){k.error("cookieStore error: "+r)},q:function(r){if(w){try{for(var e=r+"=",t=w.cookie.split(";").filter((n=>n.length)),s=0;s<t.length;s++){for(var i=t[s];i.charAt(0)==" ";)i=i.substring(1,i.length);if(i.indexOf(e)===0)return decodeURIComponent(i.substring(e.length,i.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse($e.q(r))||{}}catch{}return e},G:function(r,e,t,s,i){if(w)try{var n="",a="",l=Ho(w.location.hostname,s);if(t){var c=new Date;c.setTime(c.getTime()+24*t*60*60*1e3),n="; expires="+c.toUTCString()}i&&(a="; secure");var u=r+"="+encodeURIComponent(JSON.stringify(e))+n+"; SameSite=Lax; path=/"+l+a;return u.length>3686.4&&k.warn("cookieStore warning: large cookie, len="+u.length),w.cookie=u,u}catch{return}},V:function(r,e){if(w!=null&&w.cookie)try{$e.G(r,"",-1,e)}catch{return}}},Bs=null,B={H:function(){if(!He(Bs))return Bs;var r=!0;if(x(p))r=!1;else try{var e="__mplssupport__";B.G(e,"xyz"),B.q(e)!=='"xyz"'&&(r=!1),B.V(e)}catch{r=!1}return r||k.error("localStorage unsupported; falling back to cookie store"),Bs=r,r},B:function(r){k.error("localStorage error: "+r)},q:function(r){try{return p?.localStorage.getItem(r)}catch(e){B.B(e)}return null},W:function(r){try{return JSON.parse(B.q(r))||{}}catch{}return null},G:function(r,e){try{p?.localStorage.setItem(r,JSON.stringify(e))}catch(t){B.B(t)}},V:function(r){try{p?.localStorage.removeItem(r)}catch(e){B.B(e)}}},Uo=["distinct_id",_s,fn,bs,ys],os=E({},B,{W:function(r){try{var e={};try{e=$e.W(r)||{}}catch{}var t=V(e,JSON.parse(B.q(r)||"{}"));return B.G(r,t),t}catch{}return null},G:function(r,e,t,s,i,n){try{B.G(r,e,void 0,void 0,n);var a={};Uo.forEach((l=>{e[l]&&(a[l]=e[l])})),Object.keys(a).length&&$e.G(r,a,t,s,i,n)}catch(l){B.B(l)}},V:function(r,e){try{p?.localStorage.removeItem(r),$e.V(r,e)}catch(t){B.B(t)}}}),ls={},qo={H:function(){return!0},B:function(r){k.error("memoryStorage error: "+r)},q:function(r){return ls[r]||null},W:function(r){return ls[r]||null},G:function(r,e){ls[r]=e},V:function(r){delete ls[r]}},Qe=null,ae={H:function(){if(!He(Qe))return Qe;if(Qe=!0,x(p))Qe=!1;else try{var r="__support__";ae.G(r,"xyz"),ae.q(r)!=='"xyz"'&&(Qe=!1),ae.V(r)}catch{Qe=!1}return Qe},B:function(r){k.error("sessionStorage error: ",r)},q:function(r){try{return p?.sessionStorage.getItem(r)}catch(e){ae.B(e)}return null},W:function(r){try{return JSON.parse(ae.q(r))||null}catch{}return null},G:function(r,e){try{p?.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){ae.B(t)}},V:function(r){try{p?.sessionStorage.removeItem(r)}catch(e){ae.B(e)}}},De=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class Bo{constructor(e){this._instance=e}get I(){return this._instance.config}get consent(){return this.J()?De.DENIED:this.K}isOptedOut(){return this.I.cookieless_mode==="always"||this.consent===De.DENIED||this.consent===De.PENDING&&(this.I.opt_out_capturing_by_default||this.I.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===De.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.I.cookie_expiration,this.I.cross_subdomain_cookie,this.I.secure_cookie)}reset(){this.Y.V(this.X,this.I.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:s}=this._instance.config;return s||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Ds(e)?De.GRANTED:F(Wa,e)?De.DENIED:De.PENDING}get Y(){if(!this.Z){var e=this.I.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?B:$e;var t=e==="localStorage"?$e:B;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Ds(t.q(this.X))),t.V(this.X,this.I.cross_subdomain_cookie))}return this.Z}J(){return!!this.I.respect_dnt&&!!hn([ye?.doNotTrack,ye?.msDoNotTrack,I.doNotTrack],(e=>Ds(e)))}}var cs=J("[Dead Clicks]"),Go=()=>!0,Vo=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(gn)),s=r.instance.config.capture_dead_clicks;return Xe(s)?s:!!te(s)||t};class Tn{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,s){this.instance=e,this.isEnabled=t,this.onCapture=s,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[gn]:e?.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,s;(t=I.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(s=I.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this.instance,"dead-clicks-autocapture",(i=>{i?cs.error("failed to load script",i):e()}))}et(){var e;if(w){if(!this.tt&&(e=I.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=te(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=I.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(w),cs.info("starting...")}}else cs.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,cs.info("stopping..."))}}var jt=J("[ExceptionAutocapture]");class Wo{constructor(e){var t,s,i;this.rt=()=>{var n;if(p&&this.isEnabled&&(n=I.__PosthogExtensions__)!=null&&n.errorWrappingFunctions){var a=I.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,l=I.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,c=I.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.I.capture_unhandled_errors&&(this.st=a(this.captureException.bind(this))),!this.nt&&this.I.capture_unhandled_rejections&&(this.nt=l(this.captureException.bind(this))),!this.ot&&this.I.capture_console_errors&&(this.ot=c(this.captureException.bind(this)))}catch(u){jt.error("failed to start",u),this.lt()}}},this._instance=e,this.ut=!((t=this._instance.persistence)==null||!t.props[li]),this.I=this.ht(),this.dt=new Ya({refillRate:(s=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&s!==void 0?s:1,bucketSize:(i=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&i!==void 0?i:10,refillInterval:1e4,h:jt}),this.startIfEnabled()}ht(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return te(e)?t=E({},t,e):(x(e)?this.ut:e)&&(t=E({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.I.capture_console_errors||this.I.capture_unhandled_errors||this.I.capture_unhandled_rejections}startIfEnabled(){this.isEnabled&&(jt.info("enabled"),this.it(this.rt))}it(e){var t,s;(t=I.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(s=I.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,"exception-autocapture",(i=>{if(i)return jt.error("failed to load script",i);e()}))}lt(){var e,t,s;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(s=this.ot)==null||s.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ut=!!t||!1,this.I=this.ht(),this._instance.persistence&&this._instance.persistence.register({[li]:this.ut}),this.startIfEnabled()}captureException(e){var t,s,i=(t=e==null||(s=e.$exception_list)==null||(s=s[0])==null?void 0:s.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(i)?jt.info("Skipping exception capture because of client rate limiting.",{exception:i}):this._instance.exceptions.sendExceptionEvent(e)}}function yi(r,e,t){try{if(!(e in r))return()=>{};var s=r[e],i=t(s);return Ye(i)&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=i,()=>{r[e]=s}}catch{return()=>{}}}class Yo{constructor(e){var t;this._instance=e,this.vt=(p==null||(t=p.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(k.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ct&&this.ct(),this.ct=void 0,k.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(p&&p.history){var s=this;(e=p.history.pushState)!=null&&e.__posthog_wrapped__||yi(p.history,"pushState",(i=>function(n,a,l){i.call(this,n,a,l),s.ft("pushState")})),(t=p.history.replaceState)!=null&&t.__posthog_wrapped__||yi(p.history,"replaceState",(i=>function(n,a,l){i.call(this,n,a,l),s.ft("replaceState")})),this.gt()}}ft(e){try{var t,s=p==null||(t=p.location)==null?void 0:t.pathname;if(!s)return;s!==this.vt&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.vt=s}catch(i){k.error("Error capturing "+e+" pageview",i)}}gt(){if(!this.ct){var e=()=>{this.ft("popstate")};X(p,"popstate",e),this.ct=()=>{p&&p.removeEventListener("popstate",e)}}}}var Gs=J("[SegmentIntegration]");function Xo(r,e){var t=r.config.segment;if(!t)return e();(function(s,i){var n=s.config.segment;if(!n)return i();var a=c=>{var u=()=>c.anonymousId()||We();s.config.get_device_id=u,c.id()&&(s.register({distinct_id:c.id(),$device_id:u()}),s.persistence.set_property(Me,"identified")),i()},l=n.user();"then"in l&&Ye(l.then)?l.then((c=>a(c))):a(l)})(r,(()=>{t.register((s=>{Promise&&Promise.resolve||Gs.warn("This browser does not have Promise support, and can not use the segment integration");var i=(n,a)=>{if(!a)return n;n.event.userId||n.event.anonymousId===s.get_distinct_id()||(Gs.info("No userId set, resetting PostHog"),s.reset()),n.event.userId&&n.event.userId!==s.get_distinct_id()&&(Gs.info("UserId set, identifying with PostHog"),s.identify(n.event.userId));var l=s.calculateEventProperties(a,n.event.properties);return n.event.properties=Object.assign({},l,n.event.properties),n};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:n=>i(n,n.event.event),page:n=>i(n,"$pageview"),identify:n=>i(n,"$identify"),screen:n=>i(n,"$screen")}})(r)).then((()=>{e()}))}))}var Fn="posthog-js";function $n(r,e){var{organization:t,projectId:s,prefix:i,severityAllowList:n=["error"],sendExceptionsToPostHog:a=!0}=e===void 0?{}:e;return l=>{var c,u,d,h,f;if(!(n==="*"||n.includes(l.level))||!r.__loaded)return l;l.tags||(l.tags={});var g=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());l.tags["PostHog Person URL"]=g,r.sessionRecordingStarted()&&(l.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var m=((c=l.exception)==null?void 0:c.values)||[],v=m.map((j=>E({},j,{stacktrace:j.stacktrace?E({},j.stacktrace,{type:"raw",frames:(j.stacktrace.frames||[]).map((b=>E({},b,{platform:"web:javascript"})))}):void 0}))),y={$exception_message:((u=m[0])==null?void 0:u.value)||l.message,$exception_type:(d=m[0])==null?void 0:d.type,$exception_level:l.level,$exception_list:v,$sentry_event_id:l.event_id,$sentry_exception:l.exception,$sentry_exception_message:((h=m[0])==null?void 0:h.value)||l.message,$sentry_exception_type:(f=m[0])==null?void 0:f.type,$sentry_tags:l.tags};return t&&s&&(y.$sentry_url=(i||"https://sentry.io/organizations/")+t+"/issues/?project="+s+"&query="+l.event_id),a&&r.exceptions.sendExceptionEvent(y),l}}class Jo{constructor(e,t,s,i,n,a){this.name=Fn,this.setupOnce=function(l){l($n(e,{organization:t,projectId:s,prefix:i,severityAllowList:n,sendExceptionsToPostHog:a==null||a}))}}}var Ko=p!=null&&p.location?Es(p.location.hash,"__posthog")||Es(location.hash,"state"):null,bi="_postHogToolbarParams",wi=J("[Toolbar]"),Ve=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(Ve||{});class Zo{constructor(e){this.instance=e}_t(e){I.ph_toolbar_state=e}yt(){var e;return(e=I.ph_toolbar_state)!==null&&e!==void 0?e:Ve.UNINITIALIZED}maybeLoadToolbar(e,t,s){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),s===void 0&&(s=void 0),!p||!w)return!1;e=e??p.location,s=s??p.history;try{if(!t){try{p.localStorage.setItem("test","test"),p.localStorage.removeItem("test")}catch{return!1}t=p?.localStorage}var i,n=Ko||Es(e.hash,"__posthog")||Es(e.hash,"state"),a=n?ai((()=>JSON.parse(atob(decodeURIComponent(n)))))||ai((()=>JSON.parse(decodeURIComponent(n)))):null;return a&&a.action==="ph_authorize"?((i=a).source="url",i&&Object.keys(i).length>0&&(a.desiredHash?e.hash=a.desiredHash:s?s.replaceState(s.state,"",e.pathname+e.search):e.hash="")):((i=JSON.parse(t.getItem(bi)||"{}")).source="localstorage",delete i.userIntent),!(!i.token||this.instance.config.token!==i.token)&&(this.loadToolbar(i),!0)}catch{return!1}}bt(e){var t=I.ph_load_toolbar||I.ph_load_editor;!A(t)&&Ye(t)?t(e,this.instance):wi.warn("No toolbar load function found")}loadToolbar(e){var t=!(w==null||!w.getElementById(vn));if(!p||t)return!1;var s=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,i=E({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},s?{instrument:!1}:{});if(p.localStorage.setItem(bi,JSON.stringify(E({},i,{source:void 0}))),this.yt()===Ve.LOADED)this.bt(i);else if(this.yt()===Ve.UNINITIALIZED){var n;this._t(Ve.LOADING),(n=I.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"toolbar",(a=>{if(a)return wi.error("[Toolbar] Failed to load",a),void this._t(Ve.UNINITIALIZED);this._t(Ve.LOADED),this.bt(i)})),X(p,"turbolinks:load",(()=>{this._t(Ve.UNINITIALIZED),this.loadToolbar(i)}))}return!0}wt(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,s){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),s===void 0&&(s=void 0),this.maybeLoadToolbar(e,t,s)}}var Qo=J("[TracingHeaders]");class el{constructor(e){this.xt=void 0,this.Et=void 0,this.rt=()=>{var t,s;x(this.xt)&&((t=I.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),x(this.Et)&&((s=I.__PosthogExtensions__)==null||(s=s.tracingHeadersPatchFns)==null||s._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,s;(t=I.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(s=I.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,"tracing-headers",(i=>{if(i)return Qo.error("failed to load script",i);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.xt)==null||e.call(this),(t=this.Et)==null||t.call(this),this.xt=void 0,this.Et=void 0)}}var je="Mobile",Ss="iOS",Fe="Android",Ut="Tablet",Rn=Fe+" "+Ut,On="iPad",An="Apple",Ln=An+" Watch",qt="Safari",gt="BlackBerry",Mn="Samsung",Dn=Mn+"Browser",zn=Mn+" Internet",rt="Chrome",tl=rt+" OS",Hn=rt+" "+Ss,Rr="Internet Explorer",Un=Rr+" "+je,Or="Opera",sl=Or+" Mini",Ar="Edge",qn="Microsoft "+Ar,dt="Firefox",Bn=dt+" "+Ss,Bt="Nintendo",Gt="PlayStation",ht="Xbox",Gn=Fe+" "+je,Vn=je+" "+qt,Ot="Windows",_r=Ot+" Phone",ki="Nokia",xr="Ouya",Wn="Generic",rl=Wn+" "+je.toLowerCase(),Yn=Wn+" "+Ut.toLowerCase(),yr="Konqueror",ge="(\\d+(\\.\\d+)?)",Vs=new RegExp("Version/"+ge),il=new RegExp(ht,"i"),nl=new RegExp(Gt+" \\w+","i"),al=new RegExp(Bt+" \\w+","i"),Lr=new RegExp(gt+"|PlayBook|BB10","i"),ol={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},ll=(r,e)=>e&&F(e,An)||(function(t){return F(t,qt)&&!F(t,rt)&&!F(t,Fe)})(r),Xn=function(r,e){return e=e||"",F(r," OPR/")&&F(r,"Mini")?sl:F(r," OPR/")?Or:Lr.test(r)?gt:F(r,"IE"+je)||F(r,"WPDesktop")?Un:F(r,Dn)?zn:F(r,Ar)||F(r,"Edg/")?qn:F(r,"FBIOS")?"Facebook "+je:F(r,"UCWEB")||F(r,"UCBrowser")?"UC Browser":F(r,"CriOS")?Hn:F(r,"CrMo")||F(r,rt)?rt:F(r,Fe)&&F(r,qt)?Gn:F(r,"FxiOS")?Bn:F(r.toLowerCase(),yr.toLowerCase())?yr:ll(r,e)?F(r,je)?Vn:qt:F(r,dt)?dt:F(r,"MSIE")||F(r,"Trident/")?Rr:F(r,"Gecko")?dt:""},cl={[Un]:[new RegExp("rv:"+ge)],[qn]:[new RegExp(Ar+"?\\/"+ge)],[rt]:[new RegExp("("+rt+"|CrMo)\\/"+ge)],[Hn]:[new RegExp("CriOS\\/"+ge)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+ge)],[qt]:[Vs],[Vn]:[Vs],[Or]:[new RegExp("(Opera|OPR)\\/"+ge)],[dt]:[new RegExp(dt+"\\/"+ge)],[Bn]:[new RegExp("FxiOS\\/"+ge)],[yr]:[new RegExp("Konqueror[:/]?"+ge,"i")],[gt]:[new RegExp(gt+" "+ge),Vs],[Gn]:[new RegExp("android\\s"+ge,"i")],[zn]:[new RegExp(Dn+"\\/"+ge)],[Rr]:[new RegExp("(rv:|MSIE )"+ge)],Mozilla:[new RegExp("rv:"+ge)]},ul=function(r,e){var t=Xn(r,e),s=cl[t];if(x(s))return null;for(var i=0;i<s.length;i++){var n=s[i],a=r.match(n);if(a)return parseFloat(a[a.length-2])}return null},ji=[[new RegExp(ht+"; "+ht+" (.*?)[);]","i"),r=>[ht,r&&r[1]||""]],[new RegExp(Bt,"i"),[Bt,""]],[new RegExp(Gt,"i"),[Gt,""]],[Lr,[gt,""]],[new RegExp(Ot,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[_r,""];if(new RegExp(je).test(e)&&!/IEMobile\b/.test(e))return[Ot+" "+je,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var s=t[1],i=ol[s]||"";return/arm/i.test(e)&&(i="RT"),[Ot,i]}return[Ot,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[Ss,e.join(".")]}return[Ss,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=x(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Fe+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Fe+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Fe,e.join(".")]}return[Fe,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[tl,""]],[/Linux|debian/i,["Linux",""]]],Ei=function(r){return al.test(r)?Bt:nl.test(r)?Gt:il.test(r)?ht:new RegExp(xr,"i").test(r)?xr:new RegExp("("+_r+"|WPDesktop)","i").test(r)?_r:/iPad/.test(r)?On:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?Ln:Lr.test(r)?gt:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(ki,"i").test(r)?ki:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?!new RegExp(je).test(r)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)?/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Fe:Rn:Fe:new RegExp("(pda|"+je+")","i").test(r)?rl:new RegExp(Ut,"i").test(r)&&!new RegExp(Ut+" pc","i").test(r)?Yn:""},us="https?://(.*)",mt=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],dl=vt(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],mt),Xt="<masked>",hl=["li_fat_id"];function Jn(r,e,t){if(!w)return{};var s,i=e?vt([],mt,t||[]):[],n=Kn(Yt(w.URL,i,Xt),r),a=(s={},z(hl,(function(l){var c=$e.q(l);s[l]=c||null})),s);return V(a,n)}function Kn(r,e){var t=dl.concat(e||[]),s={};return z(t,(function(i){var n=js(r,i);s[i]=n||null})),s}function Zn(r){var e=(function(n){return n?n.search(us+"google.([^/?]*)")===0?"google":n.search(us+"bing.com")===0?"bing":n.search(us+"yahoo.com")===0?"yahoo":n.search(us+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",s={};if(!He(e)){s.$search_engine=e;var i=w?js(w.referrer,t):"";i.length&&(s.ph_keyword=i)}return s}function Ni(){return navigator.language||navigator.userLanguage}function Qn(){return w?.referrer||"$direct"}function ea(r,e){var t=r?vt([],mt,e||[]):[],s=me?.href.substring(0,1e3);return{r:Qn().substring(0,1e3),u:s?Yt(s,t,Xt):void 0}}function ta(r){var e,{r:t,u:s}=r,i={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=ks(t))==null?void 0:e.host};if(s){i.$current_url=s;var n=ks(s);i.$host=n?.host,i.$pathname=n?.pathname;var a=Kn(s);V(i,a)}if(t){var l=Zn(t);V(i,l)}return i}function sa(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function pl(){try{return new Date().getTimezoneOffset()}catch{return}}function gl(r,e){if(!ve)return{};var t,s,i,n=r?vt([],mt,e||[]):[],[a,l]=(function(c){for(var u=0;u<ji.length;u++){var[d,h]=ji[u],f=d.exec(c),g=f&&(Ye(h)?h(f,c):h);if(g)return g}return["",""]})(ve);return V(Ir({$os:a,$os_version:l,$browser:Xn(ve,navigator.vendor),$device:Ei(ve),$device_type:(s=ve,i=Ei(s),i===On||i===Rn||i==="Kobo"||i==="Kindle Fire"||i===Yn?Ut:i===Bt||i===ht||i===Gt||i===xr?"Console":i===Ln?"Wearable":i?je:"Desktop"),$timezone:sa(),$timezone_offset:pl()}),{$current_url:Yt(me?.href,n,Xt),$host:me?.host,$pathname:me?.pathname,$raw_user_agent:ve.length>1e3?ve.substring(0,997)+"...":ve,$browser_version:ul(ve,navigator.vendor),$browser_language:Ni(),$browser_language_prefix:(t=Ni(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:p?.screen.height,$screen_width:p?.screen.width,$viewport_height:p?.innerHeight,$viewport_width:p?.innerWidth,$lib:"web",$lib_version:Le.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Be=J("[Web Vitals]"),Si=9e5;class fl{constructor(e){var t;this.St=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.$t=()=>{clearTimeout(this.kt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((s,i)=>E({},s,{["$web_vitals_"+i.name+"_event"]:E({},i),["$web_vitals_"+i.name+"_value"]:i.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.Pt=s=>{var i,n=(i=this._instance.sessionManager)==null?void 0:i.checkAndGetSessionAndWindowId(!0);if(x(n))Be.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var a=this.Tt();x(a)||(A(s?.name)||A(s?.value)?Be.error("Invalid metric received",s):this.Rt&&s.value>=this.Rt?Be.error("Ignoring metric with value >= "+this.Rt,s):(this.N.url!==a&&(this.$t(),this.kt=setTimeout(this.$t,this.flushToCaptureTimeoutMs)),x(this.N.url)&&(this.N.url=a),this.N.firstMetricTimestamp=x(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,s.attribution&&s.attribution.interactionTargetElement&&(s.attribution.interactionTargetElement=void 0),this.N.metrics.push(E({},s,{$current_url:a,$session_id:n.sessionId,$window_id:n.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.$t()))}},this.rt=()=>{var s,i,n,a,l=I.__PosthogExtensions__;x(l)||x(l.postHogWebVitalsCallbacks)||({onLCP:s,onCLS:i,onFCP:n,onINP:a}=l.postHogWebVitalsCallbacks),s&&i&&n&&a?(this.allowedMetrics.indexOf("LCP")>-1&&s(this.Pt.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&i(this.Pt.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&n(this.Pt.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&a(this.Pt.bind(this)),this.P=!0):Be.error("web vitals callbacks not loaded - not starting")},this._instance=e,this.St=!((t=this._instance.persistence)==null||!t.props[ui]),this.startIfEnabled()}get allowedMetrics(){var e,t,s=te(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return x(s)?((t=this._instance.persistence)==null?void 0:t.props[di])||["CLS","FCP","INP","LCP"]:s}get flushToCaptureTimeoutMs(){return(te(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get Rt(){var e=te(this._instance.config.capture_performance)&&Re(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:Si;return 0<e&&e<=6e4?Si:e}get isEnabled(){var e=me?.protocol;if(e!=="http:"&&e!=="https:")return Be.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=te(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Xe(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Xe(t)?t:this.St}startIfEnabled(){this.isEnabled&&!this.P&&(Be.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=te(e.capturePerformance)&&!!e.capturePerformance.web_vitals,s=te(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[ui]:t}),this._instance.persistence.register({[di]:s})),this.St=t,this.startIfEnabled()}it(e){var t,s;(t=I.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks&&e(),(s=I.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,"web-vitals",(i=>{i?Be.error("failed to load script",i):e()}))}Tt(){var e=p?p.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,s=this._instance.config.custom_personal_data_properties,i=t?vt([],mt,s||[]):[];return Yt(e,i,Xt)}Be.error("Could not determine current URL")}}var vl=J("[Heatmaps]");function Ci(r){return te(r)&&"clientX"in r&&"clientY"in r&&Re(r.clientX)&&Re(r.clientY)}class ml{constructor(e){var t;this.St=!1,this.P=!1,this.Ct=null,this.instance=e,this.St=!((t=this.instance.persistence)==null||!t.props[cr]),this.rageclicks=new Pn(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return te(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return x(this.instance.config.capture_heatmaps)?x(this.instance.config.enable_heatmaps)?this.St:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;vl.info("starting..."),this.It(),this.Ft()}else{var e;clearInterval((e=this.Ct)!==null&&e!==void 0?e:void 0),this.Mt(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[cr]:t}),this.St=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}Ot(e){this.At(e.originalEvent,"deadclick")}Ft(){this.Ct&&clearInterval(this.Ct),this.Ct=(function(e){return e?.visibilityState==="visible"})(w)?setInterval(this.Dt.bind(this),this.flushIntervalMilliseconds):null}It(){p&&w&&(this.jt=this.Dt.bind(this),X(p,"beforeunload",this.jt),this.Lt=e=>this.At(e||p?.event),X(w,"click",this.Lt,{capture:!0}),this.Nt=e=>this.Ut(e||p?.event),X(w,"mousemove",this.Nt,{capture:!0}),this.zt=new Tn(this.instance,Go,this.Ot.bind(this)),this.zt.startIfEnabled(),this.Ht=this.Ft.bind(this),X(w,"visibilitychange",this.Ht),this.P=!0)}Mt(){var e;p&&w&&(this.jt&&p.removeEventListener("beforeunload",this.jt),this.Lt&&w.removeEventListener("click",this.Lt,{capture:!0}),this.Nt&&w.removeEventListener("mousemove",this.Nt,{capture:!0}),this.Ht&&w.removeEventListener("visibilitychange",this.Ht),clearTimeout(this.Bt),(e=this.zt)==null||e.stop(),this.P=!1)}qt(e,t){var s=this.instance.scrollManager.scrollY(),i=this.instance.scrollManager.scrollX(),n=this.instance.scrollManager.scrollElement(),a=(function(l,c,u){for(var d=l;d&&$s(d)&&!Ke(d,"body");){if(d===u)return!1;if(F(c,p?.getComputedStyle(d).position))return!0;d=wn(d)}return!1})(yn(e),["fixed","sticky"],n);return{x:e.clientX+(a?0:i),y:e.clientY+(a?0:s),target_fixed:a,type:t}}At(e,t){var s;if(t===void 0&&(t="click"),!hi(e.target)&&Ci(e)){var i=this.qt(e,t);(s=this.rageclicks)!=null&&s.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Wt(E({},i,{type:"rageclick"})),this.Wt(i)}}Ut(e){!hi(e.target)&&Ci(e)&&(clearTimeout(this.Bt),this.Bt=setTimeout((()=>{this.Wt(this.qt(e,"mousemove"))}),500))}Wt(e){if(p){var t=p.location.href,s=this.instance.config.mask_personal_data_properties,i=this.instance.config.custom_personal_data_properties,n=s?vt([],mt,i||[]):[],a=Yt(t,n,Xt);this.N=this.N||{},this.N[a]||(this.N[a]=[]),this.N[a].push(e)}}Dt(){this.N&&!ct(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class _l{constructor(e){this._instance=e}doPageView(e,t){var s,i=this.Gt(e,t);return this.Vt={pathname:(s=p?.location.pathname)!==null&&s!==void 0?s:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),i}doPageLeave(e){var t;return this.Gt(e,(t=this.Vt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Vt)==null?void 0:e.pageViewId}}Gt(e,t){var s=this.Vt;if(!s)return{$pageview_id:t};var i={$pageview_id:t,$prev_pageview_id:s.pageViewId},n=this._instance.scrollManager.getContext();if(n&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:a,lastScrollY:l,maxScrollY:c,maxContentHeight:u,lastContentY:d,maxContentY:h}=n;if(!(x(a)||x(l)||x(c)||x(u)||x(d)||x(h))){a=Math.ceil(a),l=Math.ceil(l),c=Math.ceil(c),u=Math.ceil(u),d=Math.ceil(d),h=Math.ceil(h);var f=a<=1?1:Te(l/a,0,1,k),g=a<=1?1:Te(c/a,0,1,k),m=u<=1?1:Te(d/u,0,1,k),v=u<=1?1:Te(h/u,0,1,k);i=V(i,{$prev_pageview_last_scroll:l,$prev_pageview_last_scroll_percentage:f,$prev_pageview_max_scroll:c,$prev_pageview_max_scroll_percentage:g,$prev_pageview_last_content:d,$prev_pageview_last_content_percentage:m,$prev_pageview_max_content:h,$prev_pageview_max_content_percentage:v})}}return s.pathname&&(i.$prev_pageview_pathname=s.pathname),s.timestamp&&(i.$prev_pageview_duration=(e.getTime()-s.timestamp.getTime())/1e3),i}}var Ee=Uint8Array,_e=Uint16Array,ft=Uint32Array,Mr=new Ee([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Dr=new Ee([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Pi=new Ee([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ra=function(r,e){for(var t=new _e(31),s=0;s<31;++s)t[s]=e+=1<<r[s-1];var i=new ft(t[30]);for(s=1;s<30;++s)for(var n=t[s];n<t[s+1];++n)i[n]=n-t[s]<<5|s;return[t,i]},ia=ra(Mr,2),xl=ia[0],br=ia[1];xl[28]=258,br[258]=28;for(var Ii=ra(Dr,0)[1],na=new _e(32768),H=0;H<32768;++H){var et=(43690&H)>>>1|(21845&H)<<1;et=(61680&(et=(52428&et)>>>2|(13107&et)<<2))>>>4|(3855&et)<<4,na[H]=((65280&et)>>>8|(255&et)<<8)>>>1}var Mt=function(r,e,t){for(var s=r.length,i=0,n=new _e(e);i<s;++i)++n[r[i]-1];var a,l=new _e(e);for(i=0;i<e;++i)l[i]=l[i-1]+n[i-1]<<1;for(a=new _e(s),i=0;i<s;++i)a[i]=na[l[r[i]-1]++]>>>15-r[i];return a},it=new Ee(288);for(H=0;H<144;++H)it[H]=8;for(H=144;H<256;++H)it[H]=9;for(H=256;H<280;++H)it[H]=7;for(H=280;H<288;++H)it[H]=8;var Cs=new Ee(32);for(H=0;H<32;++H)Cs[H]=5;var yl=Mt(it,9),bl=Mt(Cs,5),aa=function(r){return(r/8>>0)+(7&r&&1)},oa=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var s=new(r instanceof _e?_e:r instanceof ft?ft:Ee)(t-e);return s.set(r.subarray(e,t)),s},Ae=function(r,e,t){t<<=7&e;var s=e/8>>0;r[s]|=t,r[s+1]|=t>>>8},Et=function(r,e,t){t<<=7&e;var s=e/8>>0;r[s]|=t,r[s+1]|=t>>>8,r[s+2]|=t>>>16},Ws=function(r,e){for(var t=[],s=0;s<r.length;++s)r[s]&&t.push({s,f:r[s]});var i=t.length,n=t.slice();if(!i)return[new Ee(0),0];if(i==1){var a=new Ee(t[0].s+1);return a[t[0].s]=1,[a,1]}t.sort((function(N,$){return N.f-$.f})),t.push({s:-1,f:25001});var l=t[0],c=t[1],u=0,d=1,h=2;for(t[0]={s:-1,f:l.f+c.f,l,r:c};d!=i-1;)l=t[t[u].f<t[h].f?u++:h++],c=t[u!=d&&t[u].f<t[h].f?u++:h++],t[d++]={s:-1,f:l.f+c.f,l,r:c};var f=n[0].s;for(s=1;s<i;++s)n[s].s>f&&(f=n[s].s);var g=new _e(f+1),m=wr(t[d-1],g,0);if(m>e){s=0;var v=0,y=m-e,j=1<<y;for(n.sort((function(N,$){return g[$.s]-g[N.s]||N.f-$.f}));s<i;++s){var b=n[s].s;if(!(g[b]>e))break;v+=j-(1<<m-g[b]),g[b]=e}for(v>>>=y;v>0;){var T=n[s].s;g[T]<e?v-=1<<e-g[T]++-1:++s}for(;s>=0&&v;--s){var S=n[s].s;g[S]==e&&(--g[S],++v)}m=e}return[new Ee(g),m]},wr=function(r,e,t){return r.s==-1?Math.max(wr(r.l,e,t+1),wr(r.r,e,t+1)):e[r.s]=t},Ti=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new _e(++e),s=0,i=r[0],n=1,a=function(c){t[s++]=c},l=1;l<=e;++l)if(r[l]==i&&l!=e)++n;else{if(!i&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(i),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(i);n=1,i=r[l]}return[t.subarray(0,s),e]},Nt=function(r,e){for(var t=0,s=0;s<e.length;++s)t+=r[s]*e[s];return t},kr=function(r,e,t){var s=t.length,i=aa(e+2);r[i]=255&s,r[i+1]=s>>>8,r[i+2]=255^r[i],r[i+3]=255^r[i+1];for(var n=0;n<s;++n)r[i+n+4]=t[n];return 8*(i+4+s)},Fi=function(r,e,t,s,i,n,a,l,c,u,d){Ae(e,d++,t),++i[256];for(var h=Ws(i,15),f=h[0],g=h[1],m=Ws(n,15),v=m[0],y=m[1],j=Ti(f),b=j[0],T=j[1],S=Ti(v),N=S[0],$=S[1],R=new _e(19),C=0;C<b.length;++C)R[31&b[C]]++;for(C=0;C<N.length;++C)R[31&N[C]]++;for(var se=Ws(R,7),le=se[0],W=se[1],re=19;re>4&&!le[Pi[re-1]];--re);var ie,ee,ue,Ne,be=u+5<<3,Se=Nt(i,it)+Nt(n,Cs)+a,fe=Nt(i,f)+Nt(n,v)+a+14+3*re+Nt(R,le)+(2*R[16]+3*R[17]+7*R[18]);if(be<=Se&&be<=fe)return kr(e,d,r.subarray(c,c+u));if(Ae(e,d,1+(fe<Se)),d+=2,fe<Se){ie=Mt(f,g),ee=f,ue=Mt(v,y),Ne=v;var we=Mt(le,W);for(Ae(e,d,T-257),Ae(e,d+5,$-1),Ae(e,d+10,re-4),d+=14,C=0;C<re;++C)Ae(e,d+3*C,le[Pi[C]]);d+=3*re;for(var de=[b,N],K=0;K<2;++K){var he=de[K];for(C=0;C<he.length;++C){var ne=31&he[C];Ae(e,d,we[ne]),d+=le[ne],ne>15&&(Ae(e,d,he[C]>>>5&127),d+=he[C]>>>12)}}}else ie=yl,ee=it,ue=bl,Ne=Cs;for(C=0;C<l;++C)if(s[C]>255){ne=s[C]>>>18&31,Et(e,d,ie[ne+257]),d+=ee[ne+257],ne>7&&(Ae(e,d,s[C]>>>23&31),d+=Mr[ne]);var Ue=31&s[C];Et(e,d,ue[Ue]),d+=Ne[Ue],Ue>3&&(Et(e,d,s[C]>>>5&8191),d+=Dr[Ue])}else Et(e,d,ie[s[C]]),d+=ee[s[C]];return Et(e,d,ie[256]),d+ee[256]},wl=new ft([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),kl=(function(){for(var r=new ft(256),e=0;e<256;++e){for(var t=e,s=9;--s;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),jl=function(r,e,t,s,i){return(function(n,a,l,c,u,d){var h=n.length,f=new Ee(c+h+5*(1+Math.floor(h/7e3))+u),g=f.subarray(c,f.length-u),m=0;if(!a||h<8)for(var v=0;v<=h;v+=65535){var y=v+65535;y<h?m=kr(g,m,n.subarray(v,y)):(g[v]=d,m=kr(g,m,n.subarray(v,h)))}else{for(var j=wl[a-1],b=j>>>13,T=8191&j,S=(1<<l)-1,N=new _e(32768),$=new _e(S+1),R=Math.ceil(l/3),C=2*R,se=function(_){return(n[_]^n[_+1]<<R^n[_+2]<<C)&S},le=new ft(25e3),W=new _e(288),re=new _e(32),ie=0,ee=0,ue=(v=0,0),Ne=0,be=0;v<h;++v){var Se=se(v),fe=32767&v,we=$[Se];if(N[fe]=we,$[Se]=fe,Ne<=v){var de=h-v;if((ie>7e3||ue>24576)&&de>423){m=Fi(n,g,0,le,W,re,ee,ue,be,v-be,m),ue=ie=ee=0,be=v;for(var K=0;K<286;++K)W[K]=0;for(K=0;K<30;++K)re[K]=0}var he=2,ne=0,Ue=T,ke=fe-we&32767;if(de>2&&Se==se(v-ke))for(var _t=Math.min(b,de)-1,Jt=Math.min(32767,v),As=Math.min(258,de);ke<=Jt&&--Ue&&fe!=we;){if(n[v+he]==n[v+he-ke]){for(var Pe=0;Pe<As&&n[v+Pe]==n[v+Pe-ke];++Pe);if(Pe>he){if(he=Pe,ne=ke,Pe>_t)break;var Kt=Math.min(ke,Pe-2),Oe=0;for(K=0;K<Kt;++K){var Ze=v-ke+K+32768&32767,xt=Ze-N[Ze]+32768&32767;xt>Oe&&(Oe=xt,we=Ze)}}}ke+=(fe=we)-(we=N[fe])+32768&32767}if(ne){le[ue++]=268435456|br[he]<<18|Ii[ne];var Zt=31&br[he],Qt=31&Ii[ne];ee+=Mr[Zt]+Dr[Qt],++W[257+Zt],++re[Qt],Ne=v+he,++ie}else le[ue++]=n[v],++W[n[v]]}}m=Fi(n,g,d,le,W,re,ee,ue,be,v-be,m)}return oa(f,0,c+aa(m)+u)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,s,!0)},Ys=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function El(r,e){e===void 0&&(e={});var t=(function(){var l=4294967295;return{p:function(c){for(var u=l,d=0;d<c.length;++d)u=kl[255&u^c[d]]^u>>>8;l=u},d:function(){return 4294967295^l}}})(),s=r.length;t.p(r);var i,n=jl(r,e,10+((i=e).filename&&i.filename.length+1||0),8),a=n.length;return(function(l,c){var u=c.filename;if(l[0]=31,l[1]=139,l[2]=8,l[8]=c.level<2?4:c.level==9?2:0,l[9]=3,c.mtime!=0&&Ys(l,4,Math.floor(new Date(c.mtime||Date.now())/1e3)),u){l[3]=8;for(var d=0;d<=u.length;++d)l[d+10]=u.charCodeAt(d)}})(n,e),Ys(n,a-8,t.d()),Ys(n,a-4,s),n}var Nl=function(r){var e,t,s,i,n="";for(e=t=0,s=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,i=0;i<s;i++){var a=r.charCodeAt(i),l=null;a<128?t++:l=a>127&&a<2048?String.fromCharCode(a>>6|192,63&a|128):String.fromCharCode(a>>12|224,a>>6&63|128,63&a|128),He(l)||(t>e&&(n+=r.substring(e,t)),n+=l,e=t=i+1)}return t>e&&(n+=r.substring(e,r.length)),n},Sl=!!ir||!!rr,$i="text/plain",Ps=function(r,e,t){var s;t===void 0&&(t=!0);var[i,n]=r.split("?"),a=E({},e),l=(s=n?.split("&").map((u=>{var d,[h,f]=u.split("="),g=t&&(d=a[h])!==null&&d!==void 0?d:f;return delete a[h],h+"="+g})))!==null&&s!==void 0?s:[],c=Fo(a);return c&&l.push(c),i+"?"+l.join("&")},At=(r,e)=>JSON.stringify(r,((t,s)=>typeof s=="bigint"?s.toString():s),e),Xs=r=>{var{data:e,compression:t}=r;if(e){if(t===ze.GZipJS){var s=El((function(c,u){var d=c.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(c);for(var h=new Ee(c.length+(c.length>>>1)),f=0,g=function(j){h[f++]=j},m=0;m<d;++m){if(f+5>h.length){var v=new Ee(f+8+(d-m<<1));v.set(h),h=v}var y=c.charCodeAt(m);y<128||u?g(y):y<2048?(g(192|y>>>6),g(128|63&y)):y>55295&&y<57344?(g(240|(y=65536+(1047552&y)|1023&c.charCodeAt(++m))>>>18),g(128|y>>>12&63),g(128|y>>>6&63),g(128|63&y)):(g(224|y>>>12),g(128|y>>>6&63),g(128|63&y))}return oa(h,0,f)})(At(e)),{mtime:0}),i=new Blob([s],{type:$i});return{contentType:$i,body:i,estimatedSize:i.size}}if(t===ze.Base64){var n=(function(c){var u,d,h,f,g,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=0,y=0,j="",b=[];if(!c)return c;c=Nl(c);do u=(g=c.charCodeAt(v++)<<16|c.charCodeAt(v++)<<8|c.charCodeAt(v++))>>18&63,d=g>>12&63,h=g>>6&63,f=63&g,b[y++]=m.charAt(u)+m.charAt(d)+m.charAt(h)+m.charAt(f);while(v<c.length);switch(j=b.join(""),c.length%3){case 1:j=j.slice(0,-2)+"==";break;case 2:j=j.slice(0,-1)+"="}return j})(At(e)),a=(c=>"data="+encodeURIComponent(typeof c=="string"?c:At(c)))(n);return{contentType:"application/x-www-form-urlencoded",body:a,estimatedSize:new Blob([a]).size}}var l=At(e);return{contentType:"application/json",body:l,estimatedSize:new Blob([l]).size}}},gs=[];rr&&gs.push({transport:"fetch",method:r=>{var e,t,{contentType:s,body:i,estimatedSize:n}=(e=Xs(r))!==null&&e!==void 0?e:{},a=new Headers;z(r.headers,(function(d,h){a.append(h,d)})),s&&a.append("Content-Type",s);var l=r.url,c=null;if(Zr){var u=new Zr;c={signal:u.signal,timeout:setTimeout((()=>u.abort()),r.timeout)}}rr(l,E({method:r?.method||"GET",headers:a,keepalive:r.method==="POST"&&(n||0)<52428.8,body:i,signal:(t=c)==null?void 0:t.signal},r.fetchOptions)).then((d=>d.text().then((h=>{var f={statusCode:d.status,text:h};if(d.status===200)try{f.json=JSON.parse(h)}catch(g){k.error(g)}r.callback==null||r.callback(f)})))).catch((d=>{k.error(d),r.callback==null||r.callback({statusCode:0,text:d})})).finally((()=>c?clearTimeout(c.timeout):null))}}),ir&&gs.push({transport:"XHR",method:r=>{var e,t=new ir;t.open(r.method||"GET",r.url,!0);var{contentType:s,body:i}=(e=Xs(r))!==null&&e!==void 0?e:{};z(r.headers,(function(n,a){t.setRequestHeader(a,n)})),s&&t.setRequestHeader("Content-Type",s),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var n={statusCode:t.status,text:t.responseText};if(t.status===200)try{n.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(n)}},t.send(i)}}),ye!=null&&ye.sendBeacon&&gs.push({transport:"sendBeacon",method:r=>{var e=Ps(r.url,{beacon:"1"});try{var t,{contentType:s,body:i}=(t=Xs(r))!==null&&t!==void 0?t:{},n=typeof i=="string"?new Blob([i],{type:s}):i;ye.sendBeacon(e,n)}catch{}}});var Is=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function Ri(r,e,t){return At({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var la={exact:(r,e)=>e.some((t=>r.some((s=>t===s)))),is_not:(r,e)=>e.every((t=>r.every((s=>t!==s)))),regex:(r,e)=>e.some((t=>r.some((s=>Is(t,s))))),not_regex:(r,e)=>e.every((t=>r.every((s=>!Is(t,s))))),icontains:(r,e)=>e.map(ds).some((t=>r.map(ds).some((s=>t.includes(s))))),not_icontains:(r,e)=>e.map(ds).every((t=>r.map(ds).every((s=>!t.includes(s)))))},ds=r=>r.toLowerCase();function ca(r,e){return!r||Object.entries(r).every((t=>{var[s,i]=t,n=e?.[s];if(x(n)||He(n))return!1;var a=[String(n)],l=la[i.operator];return!!l&&l(i.values,a)}))}var Js=J("[Error tracking]");class Cl{constructor(e){var t,s;this.Jt=[],this.Kt=new Ka([new ao,new vo,new lo,new oo,new go,new po,new uo,new fo],no("web:javascript",to,io)),this._instance=e,this.Jt=(t=(s=this._instance.persistence)==null?void 0:s.get_property(ur))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,s,i,n=(t=(s=e.errorTracking)==null?void 0:s.suppressionRules)!==null&&t!==void 0?t:[],a=(i=e.errorTracking)==null?void 0:i.captureExtensionExceptions;this.Jt=n,this._instance.persistence&&this._instance.persistence.register({[ur]:this.Jt,[ci]:a})}get Yt(){var e,t=!!this._instance.get_property(ci),s=this._instance.config.error_tracking.captureExtensionExceptions;return(e=s??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.Kt.buildFromUnknown(e,{syntheticException:t?.syntheticException,mechanism:{handled:t?.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.Xt(t)){if(this.Qt(t))return void Js.info("Skipping exception capture because a suppression rule matched");if(!this.Yt&&this.Zt(t))return void Js.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ti(t))return void Js.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}Qt(e){if(e.length===0)return!1;var t=e.reduce(((s,i)=>{var{type:n,value:a}=i;return Q(n)&&n.length>0&&s.$exception_types.push(n),Q(a)&&a.length>0&&s.$exception_values.push(a),s}),{$exception_types:[],$exception_values:[]});return this.Jt.some((s=>{var i=s.values.map((n=>{var a,l=la[n.operator],c=L(n.value)?n.value:[n.value],u=(a=t[n.key])!==null&&a!==void 0?a:[];return c.length>0&&l(c,u)}));return s.type==="OR"?i.some(Boolean):i.every(Boolean)}))}Zt(e){return e.flatMap((t=>{var s,i;return(s=(i=t.stacktrace)==null?void 0:i.frames)!==null&&s!==void 0?s:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ti(e){if(e.length>0){var t,s,i,n,a=(t=(s=e[0].stacktrace)==null?void 0:s.frames)!==null&&t!==void 0?t:[],l=a[a.length-1];return(i=l==null||(n=l.filename)==null?void 0:n.includes("posthog.com/static"))!==null&&i!==void 0&&i}return!1}Xt(e){return!A(e)&&L(e)}}var Ce=J("[FeatureFlags]"),St=J("[FeatureFlags]",{debugEnabled:!0}),Ks="$active_feature_flags",at="$override_feature_flags",Oi="$feature_flag_payloads",Ct="$override_feature_flag_payloads",Ai="$feature_flag_request_id",Li="$feature_flag_evaluated_at",Mi=r=>{var e={};for(var[t,s]of ps(r||{}))s&&(e[t]=s);return e},Pl=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var s;return[t,(s=e[t].variant)!==null&&s!==void 0?s:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var s;return(s=e[t].metadata)==null?void 0:s.payload})).map((t=>{var s;return[t,(s=e[t].metadata)==null?void 0:s.payload]})))):Ce.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},Il=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class Tl{constructor(e){this.ii=!1,this.ei=!1,this.ri=!1,this.si=!1,this.ni=!1,this.oi=!1,this.ai=!1,this._instance=e,this.featureFlagEventHandlers=[]}li(){var e=this._instance.config.evaluation_environments;return e!=null&&e.length?e.filter((t=>{var s=t&&typeof t=="string"&&t.trim().length>0;return s||Ce.error("Invalid evaluation environment found:",t,"Expected non-empty string"),s})):[]}ui(){return this.li().length>0}flags(){if(this._instance.config.__preview_remote_config)this.oi=!0;else{var e=!this.hi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.di({disableFlags:e})}}get hasLoadedFlags(){return this.ei}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(dr),t=this._instance.get_property(at),s=this._instance.get_property(Ct);if(!s&&!t)return e||{};var i=V({},e||{}),n=[...new Set([...Object.keys(s||{}),...Object.keys(t||{})])];for(var a of n){var l,c,u=i[a],d=t?.[a],h=x(d)?(l=u?.enabled)!==null&&l!==void 0&&l:!!d,f=x(d)?u.variant:typeof d=="string"?d:void 0,g=s?.[a],m=E({},u,{enabled:h,variant:h?f??u?.variant:void 0});h!==u?.enabled&&(m.original_enabled=u?.enabled),f!==u?.variant&&(m.original_variant=u?.variant),g&&(m.metadata=E({},u?.metadata,{payload:g,original_payload:u==null||(c=u.metadata)==null?void 0:c.payload})),i[a]=m}return this.ii||(Ce.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:s,finalDetails:i}),this.ii=!0),i}getFlagVariants(){var e=this._instance.get_property(ut),t=this._instance.get_property(at);if(!t)return e||{};for(var s=V({},e),i=Object.keys(t),n=0;n<i.length;n++)s[i[n]]=t[i[n]];return this.ii||(Ce.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:s}),this.ii=!0),s}getFlagPayloads(){var e=this._instance.get_property(Oi),t=this._instance.get_property(Ct);if(!t)return e||{};for(var s=V({},e||{}),i=Object.keys(t),n=0;n<i.length;n++)s[i[n]]=t[i[n]];return this.ii||(Ce.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:s}),this.ii=!0),s}reloadFeatureFlags(){this.si||this._instance.config.advanced_disable_feature_flags||this.hi||(this.hi=setTimeout((()=>{this.di()}),5))}vi(){clearTimeout(this.hi),this.hi=void 0}ensureFlagsLoaded(){this.ei||this.ri||this.hi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.si=e}di(e){var t;if(this.vi(),!this._instance.O())if(this.ri)this.ni=!0;else{var s={token:this._instance.config.token,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:E({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(Rt)||{}),group_properties:this._instance.get_property(st)};(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(s.disable_flags=!0),this.ui()&&(s.evaluation_environments=this.li());var i=this._instance.config.__preview_remote_config,n=i?"/flags/?v=2":"/flags/?v=2&config=true",a=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",l=this._instance.requestRouter.endpointFor("flags",n+a);i&&(s.timezone=sa()),this.ri=!0,this._instance.ci({method:"POST",url:l,data:s,compression:this._instance.config.disable_compression?void 0:ze.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:c=>{var u,d,h=!0;if(c.statusCode===200&&(this.ni||(this.$anon_distinct_id=void 0),h=!1),this.ri=!1,this.oi||(this.oi=!0,this._instance.fi((d=c.json)!==null&&d!==void 0?d:{})),!s.disable_flags||this.ni)if(this.ai=!h,c.json&&(u=c.json.quotaLimited)!=null&&u.includes(Il.FeatureFlags))Ce.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var f;s.disable_flags||this.receivedFeatureFlags((f=c.json)!==null&&f!==void 0?f:{},h),this.ni&&(this.ni=!1,this.di())}}})}}getFeatureFlag(e,t){if(t===void 0&&(t={}),this.ei||this.getFlags()&&this.getFlags().length>0){var s=this.getFlagVariants()[e],i=""+s,n=this._instance.get_property(Ai)||void 0,a=this._instance.get_property(Li)||void 0,l=this._instance.get_property(xs)||{};if((t.send_event||!("send_event"in t))&&(!(e in l)||!l[e].includes(i))){var c,u,d,h,f,g,m,v,y;L(l[e])?l[e].push(i):l[e]=[i],(c=this._instance.persistence)==null||c.register({[xs]:l});var j=this.getFeatureFlagDetails(e),b={$feature_flag:e,$feature_flag_response:s,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_request_id:n,$feature_flag_evaluated_at:a,$feature_flag_bootstrapped_response:((u=this._instance.config.bootstrap)==null||(u=u.featureFlags)==null?void 0:u[e])||null,$feature_flag_bootstrapped_payload:((d=this._instance.config.bootstrap)==null||(d=d.featureFlagPayloads)==null?void 0:d[e])||null,$used_bootstrap_value:!this.ai};x(j==null||(h=j.metadata)==null?void 0:h.version)||(b.$feature_flag_version=j.metadata.version);var T,S=(f=j==null||(g=j.reason)==null?void 0:g.description)!==null&&f!==void 0?f:j==null||(m=j.reason)==null?void 0:m.code;S&&(b.$feature_flag_reason=S),j!=null&&(v=j.metadata)!=null&&v.id&&(b.$feature_flag_id=j.metadata.id),x(j?.original_variant)&&x(j?.original_enabled)||(b.$feature_flag_original_response=x(j.original_variant)?j.original_enabled:j.original_variant),j!=null&&(y=j.metadata)!=null&&y.original_payload&&(b.$feature_flag_original_payload=j==null||(T=j.metadata)==null?void 0:T.original_payload),this._instance.capture("$feature_flag_called",b)}return s}Ce.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}getRemoteConfigPayload(e,t){var s=this._instance.config.token,i={distinct_id:this._instance.get_distinct_id(),token:s};this.ui()&&(i.evaluation_environments=this.li()),this._instance.ci({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:i,compression:this._instance.config.disable_compression?void 0:ze.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:n=>{var a,l=(a=n.json)==null?void 0:a.featureFlagPayloads;t(l?.[e]||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ei||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlag(e,t);return x(s)?void 0:!!s}Ce.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ei=!0;var s=this.getFlagVariants(),i=this.getFlagPayloads(),n=this.getFlagsWithDetails();(function(a,l,c,u,d){c===void 0&&(c={}),u===void 0&&(u={}),d===void 0&&(d={});var h=Pl(a),f=h.flags,g=h.featureFlags,m=h.featureFlagPayloads;if(g){var v=a.requestId,y=a.evaluatedAt;if(L(g)){Ce.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var j={};if(g)for(var b=0;b<g.length;b++)j[g[b]]=!0;l&&l.register({[Ks]:g,[ut]:j})}else{var T=g,S=m,N=f;a.errorsWhileComputingFlags&&(T=E({},c,T),S=E({},u,S),N=E({},d,N)),l&&l.register(E({[Ks]:Object.keys(Mi(T)),[ut]:T||{},[Oi]:S||{},[dr]:N||{}},v?{[Ai]:v}:{},y?{[Li]:y}:{}))}}})(e,this._instance.persistence,s,i,n),this.pi(t)}}override(e,t){t===void 0&&(t=!1),Ce.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Ce.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(at),this._instance.persistence.unregister(Ct),this.pi(),St.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,s=e;if(this.ii=!!((t=s.suppressWarning)!==null&&t!==void 0&&t),"flags"in s){if(s.flags===!1)this._instance.persistence.unregister(at),St.info("Flag overrides cleared");else if(s.flags){if(L(s.flags)){for(var i={},n=0;n<s.flags.length;n++)i[s.flags[n]]=!0;this._instance.persistence.register({[at]:i})}else this._instance.persistence.register({[at]:s.flags});St.info("Flag overrides set",{flags:s.flags})}}return"payloads"in s&&(s.payloads===!1?(this._instance.persistence.unregister(Ct),St.info("Payload overrides cleared")):s.payloads&&(this._instance.persistence.register({[Ct]:s.payloads}),St.info("Payload overrides set",{payloads:s.payloads}))),void this.pi()}this.pi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ei){var{flags:t,flagVariants:s}=this.gi();e(t,s)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,s){var i,n=(this._instance.get_property($t)||[]).find((u=>u.flagKey===e)),a={["$feature_enrollment/"+e]:t},l={$feature_flag:e,$feature_enrollment:t,$set:a};n&&(l.$early_access_feature_name=n.name),s&&(l.$feature_enrollment_stage=s),this._instance.capture("$feature_enrollment_update",l),this.setPersonPropertiesForFlags(a,!1);var c=E({},this.getFlagVariants(),{[e]:t});(i=this._instance.persistence)==null||i.register({[Ks]:Object.keys(Mi(c)),[ut]:c}),this.pi()}getEarlyAccessFeatures(e,t,s){t===void 0&&(t=!1);var i=this._instance.get_property($t),n=s?"&"+s.map((a=>"stage="+a)).join("&"):"";if(i&&!t)return e(i);this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+n),method:"GET",callback:a=>{var l,c;if(a.json){var u=a.json.earlyAccessFeatures;return(l=this._instance.persistence)==null||l.unregister($t),(c=this._instance.persistence)==null||c.register({[$t]:u}),e(u)}}})}gi(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((s=>t[s])),flagVariants:Object.keys(t).filter((s=>t[s])).reduce(((s,i)=>(s[i]=t[i],s)),{})}}pi(e){var{flags:t,flagVariants:s}=this.gi();this.featureFlagEventHandlers.forEach((i=>i(t,s,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var s=this._instance.get_property(Rt)||{};this._instance.register({[Rt]:E({},s,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(Rt)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var s=this._instance.get_property(st)||{};Object.keys(s).length!==0&&Object.keys(s).forEach((i=>{s[i]=E({},s[i],e[i]),delete e[i]})),this._instance.register({[st]:E({},s,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(st)||{};this._instance.register({[st]:E({},t,{[e]:{}})})}else this._instance.unregister(st)}reset(){this.ei=!1,this.ri=!1,this.si=!1,this.ni=!1,this.oi=!1,this.ai=!1,this.$anon_distinct_id=void 0,this.vi(),this.ii=!1}}var Fl=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Zs{constructor(e,t){this.I=e,this.props={},this.mi=!1,this.yi=(s=>{var i="";return s.token&&(i=s.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),s.persistence_name?"ph_"+s.persistence_name:"ph_"+i+"_posthog"})(e),this.Y=this.bi(e),this.load(),e.debug&&k.info("Persistence loaded",e.persistence,E({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.wi}bi(e){Fl.indexOf(e.persistence.toLowerCase())===-1&&(k.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return t==="localstorage"&&B.H()?B:t==="localstorage+cookie"&&os.H()?os:t==="sessionstorage"&&ae.H()?ae:t==="memory"?qo:t==="cookie"?$e:os.H()?os:$e}properties(){var e={};return z(this.props,(function(t,s){if(s===ut&&te(t))for(var i=Object.keys(t),n=0;n<i.length;n++)e["$feature/"+i[n]]=t[i[n]];else l=s,c=!1,(He(a=wo)?c:Kr&&a.indexOf===Kr?a.indexOf(l)!=-1:(z(a,(function(u){if(c||(c=u===l))return ms})),c))||(e[s]=t);var a,l,c})),e}load(){if(!this.wi){var e=this.Y.W(this.yi);e&&(this.props=V({},e))}}save(){this.wi||this.Y.G(this.yi,this.props,this.xi,this.Ei,this.Si,this.I.debug)}remove(){this.Y.V(this.yi,!1),this.Y.V(this.yi,!0)}clear(){this.remove(),this.props={}}register_once(e,t,s){if(te(e)){x(t)&&(t="None"),this.xi=x(s)?this.$i:s;var i=!1;if(z(e,((n,a)=>{this.props.hasOwnProperty(a)&&this.props[a]!==t||(this.props[a]=n,i=!0)})),i)return this.save(),!0}return!1}register(e,t){if(te(e)){this.xi=x(t)?this.$i:t;var s=!1;if(z(e,((i,n)=>{e.hasOwnProperty(n)&&this.props[n]!==i&&(this.props[n]=i,s=!0)})),s)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.mi){var e=Jn(this.I.custom_campaign_params,this.I.mask_personal_data_properties,this.I.custom_personal_data_properties);ct(Ir(e))||this.register(e),this.mi=!0}}update_search_keyword(){var e;this.register((e=w?.referrer)?Zn(e):{})}update_referrer_info(){var e;this.register_once({$referrer:Qn(),$referring_domain:w!=null&&w.referrer&&((e=ks(w.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[fr]||this.props[vr]||this.register_once({[ys]:ea(this.I.mask_personal_data_properties,this.I.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};z([vr,fr],(a=>{var l=this.props[a];l&&z(l,(function(c,u){e["$initial_"+nr(u)]=c}))}));var t,s,i=this.props[ys];if(i){var n=(t=ta(i),s={},z(t,(function(a,l){s["$initial_"+nr(l)]=a})),s);V(e,n)}return e}safe_merge(e){return z(this.props,(function(t,s){s in e||(e[s]=t)})),e}update_config(e,t,s){if(this.$i=this.xi=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!s),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var i=this.bi(e),n=this.props;this.clear(),this.Y=i,this.props=n,this.save()}}set_disabled(e){this.wi=e,this.wi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ei&&(this.Ei=e,this.remove(),this.save())}set_secure(e){e!==this.Si&&(this.Si=e,this.remove(),this.save())}set_event_timer(e,t){var s=this.props[Ft]||{};s[e]=t,this.props[Ft]=s,this.save()}remove_event_timer(e){var t=(this.props[Ft]||{})[e];return x(t)||(delete this.props[Ft][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var pe=J("[Product Tours]"),Qs="ph_product_tours";class $l{constructor(e){this.ki=null,this.Pi=null,this.Ti=void 0,this.Ri=!1,this._instance=e}onRemoteConfig(e){if(this._instance.config.disable_product_tours)pe.info("Product tours disabled via config");else{var t=e.productTours;A(t)?pe.info("Product tours not enabled in remote config"):(this.Ti=t,pe.info("Remote config received, isProductToursEnabled: "+this.Ti),this.loadIfEnabled())}}loadIfEnabled(){var e;if(!this.Pi)if(this.Ri)pe.info("Already initializing product tours, skipping...");else if(this._instance.config.disable_product_tours)pe.info("Product tours disabled via config");else{var t=I?.__PosthogExtensions__;if(t){var s=(e=this._instance.featureFlags)==null?void 0:e.isFeatureEnabled("product-tours-2025");if(!x(this.Ti)||s){var i=this.Ti||s;if(i){this.Ri=!0;try{var n=t.generateProductTours;if(n)return void this.Ci(n,i);var a=t.loadExternalDependency;if(!a)return pe.error("PostHog loadExternalDependency extension not found."),void(this.Ri=!1);a(this._instance,"product-tours",(l=>{l||!t.generateProductTours?pe.error("Could not load product tours script",l):this.Ci(t.generateProductTours,i),this.Ri=!1}))}catch(l){pe.error("Error initializing product tours",l),this.Ri=!1}}else pe.info("Product tours not enabled")}else pe.info("Waiting for remote config or feature flag to enable product tours")}else pe.error("PostHog Extensions not found.")}}Ci(e,t){this.Pi=e(this._instance,t)||null,pe.info("Product tours loaded successfully")}getProductTours(e,t){if(t===void 0&&(t=!1),!L(this.ki)||t){var s=this._instance.persistence;if(s){var i=s.props[Qs];if(L(i)&&!t)return this.ki=i,void e(i,{isLoaded:!0})}this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:n=>{var a=n.statusCode;if(a!==200||!n.json){var l="Product Tours API could not be loaded, status: "+a;return pe.error(l),void e([],{isLoaded:!1,error:l})}var c=L(n.json.product_tours)?n.json.product_tours:[];this.ki=c,s&&s.register({[Qs]:c}),e(c,{isLoaded:!0})}})}else e(this.ki,{isLoaded:!0})}getActiveProductTours(e){if(A(this.Pi))return pe.warn("Product tours not loaded yet"),void e([],{isLoaded:!1,error:"Product tours not loaded"});this.Pi.getActiveProductTours(e)}showProductTour(e){var t;pe.info("showProductTour("+e+")"),(t=this.Pi)==null||t.showTourById(e)}dismissProductTour(){var e;(e=this.Pi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Pi)==null||e.nextStep()}previousStep(){var e;(e=this.Pi)==null||e.previousStep()}clearCache(){this.ki=null;var e=this._instance.persistence;e&&e.unregister(Qs)}resetTour(e){var t;(t=this.Pi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Pi)==null||e.resetAllTours()}}var Pt=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var er=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var fs=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r})({}),Di=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r})({}),ua=(function(r){return r.Popover="popover",r.Inline="inline",r})({});class zr{constructor(){this.Ii={},this.Ii={}}on(e,t){return this.Ii[e]||(this.Ii[e]=[]),this.Ii[e].push(t),()=>{this.Ii[e]=this.Ii[e].filter((s=>s!==t))}}emit(e,t){for(var s of this.Ii[e]||[])s(t);for(var i of this.Ii["*"]||[])i(e,t)}}function ot(r,e,t){if(A(r))return!1;switch(t){case"exact":return r===e;case"contains":var s=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(s,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class Rl{constructor(e){this.Fi=new zr,this.Mi=(t,s)=>this.Oi(t,s)&&this.Ai(t,s)&&this.Di(t,s)&&this.ji(t,s),this.Oi=(t,s)=>s==null||!s.event||t?.event===s?.event,this._instance=e,this.Li=new Set,this.Ni=new Set}init(){var e;if(!x((e=this._instance)==null?void 0:e.Ui)){var t;(t=this._instance)==null||t.Ui(((s,i)=>{this.on(s,i)}))}}register(e){var t,s;if(!x((t=this._instance)==null?void 0:t.Ui)&&(e.forEach((a=>{var l,c;(l=this.Ni)==null||l.add(a),(c=a.steps)==null||c.forEach((u=>{var d;(d=this.Li)==null||d.add(u?.event||"")}))})),(s=this._instance)!=null&&s.autocapture)){var i,n=new Set;e.forEach((a=>{var l;(l=a.steps)==null||l.forEach((c=>{c!=null&&c.selector&&n.add(c?.selector)}))})),(i=this._instance)==null||i.autocapture.setElementSelectors(n)}}on(e,t){var s;t!=null&&e.length!=0&&(this.Li.has(e)||this.Li.has(t?.event))&&this.Ni&&((s=this.Ni)==null?void 0:s.size)>0&&this.Ni.forEach((i=>{this.zi(t,i)&&this.Fi.emit("actionCaptured",i.name)}))}Hi(e){this.onAction("actionCaptured",(t=>e(t)))}zi(e,t){if(t?.steps==null)return!1;for(var s of t.steps)if(this.Mi(e,s))return!0;return!1}onAction(e,t){return this.Fi.on(e,t)}Ai(e,t){if(t!=null&&t.url){var s,i=e==null||(s=e.properties)==null?void 0:s.$current_url;if(!i||typeof i!="string"||!ot(i,t.url,t.url_matching||"contains"))return!1}return!0}Di(e,t){return!!this.Bi(e,t)&&!!this.qi(e,t)&&!!this.Wi(e,t)}Bi(e,t){var s;if(t==null||!t.href)return!0;var i=this.Gi(e);if(i.length>0)return i.some((l=>ot(l.href,t.href,t.href_matching||"exact")));var n,a=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";return!!a&&ot((n=a.match(/(?::|")href="(.*?)"/))?n[1]:"",t.href,t.href_matching||"exact")}qi(e,t){var s;if(t==null||!t.text)return!0;var i=this.Gi(e);if(i.length>0)return i.some((u=>ot(u.text,t.text,t.text_matching||"exact")||ot(u.$el_text,t.text,t.text_matching||"exact")));var n,a,l,c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";return!!c&&(n=(function(u){for(var d,h=[],f=/(?::|")text="(.*?)"/g;!A(d=f.exec(u));)h.includes(d[1])||h.push(d[1]);return h})(c),a=t.text,l=t.text_matching||"exact",n.some((u=>ot(u,a,l))))}Wi(e,t){var s,i;if(t==null||!t.selector)return!0;var n=e==null||(s=e.properties)==null?void 0:s.$element_selectors;if(n!=null&&n.includes(t.selector))return!0;var a=(e==null||(i=e.properties)==null?void 0:i.$elements_chain)||"";if(t.selector_regex&&a)try{return new RegExp(t.selector_regex).test(a)}catch{return!1}return!1}Gi(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e?.properties.$elements}ji(e,t){return t==null||!t.properties||t.properties.length===0||ca(t.properties.reduce(((s,i)=>{var n=L(i.value)?i.value.map(String):i.value!=null?[String(i.value)]:[];return s[i.key]={values:n,operator:i.operator||"exact"},s}),{}),e?.properties)}}var M=J("[Surveys]"),jr="seenSurvey_",Ol=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},zi=r=>{var e=""+jr+r.id;return r.current_iteration&&r.current_iteration>0&&(e=""+jr+r.id+"_"+r.current_iteration),e},Al=[er.Popover,er.Widget,er.API],Ll={ignoreConditions:!1,ignoreDelay:!1,displayType:ua.Popover};class Ml{constructor(e){this._instance=e,this.Vi=new Map,this.Ji=new Map,this.Ki=new Map}Yi(e,t){return!!e&&ca(e.propertyFilters,t?.properties)}Xi(e,t){var s=new Map;return e.forEach((i=>{var n;(n=i.conditions)==null||(n=n[t])==null||(n=n.values)==null||n.forEach((a=>{if(a!=null&&a.name){var l=s.get(a.name)||[];l.push(i.id),s.set(a.name,l)}}))})),s}Qi(e,t,s){var i,n=(s===Pt.Activation?this.Vi:this.Ji).get(e),a=[];return(i=this._instance)==null||i.getSurveys((l=>{a=l.filter((c=>n?.includes(c.id)))})),a.filter((l=>{var c,u=(c=l.conditions)==null||(c=c[s])==null||(c=c.values)==null?void 0:c.find((d=>d.name===e));return this.Yi(u,t)}))}register(e){var t;x((t=this._instance)==null?void 0:t.Ui)||(this.Zi(e),this.te(e))}te(e){var t=e.filter((s=>{var i,n;return((i=s.conditions)==null?void 0:i.actions)&&((n=s.conditions)==null||(n=n.actions)==null||(n=n.values)==null?void 0:n.length)>0}));t.length!==0&&(this.ie==null&&(this.ie=new Rl(this._instance),this.ie.init(),this.ie.Hi((s=>{this.onAction(s)}))),t.forEach((s=>{var i,n,a,l,c;s.conditions&&(i=s.conditions)!=null&&i.actions&&(n=s.conditions)!=null&&(n=n.actions)!=null&&n.values&&((a=s.conditions)==null||(a=a.actions)==null||(a=a.values)==null?void 0:a.length)>0&&((l=this.ie)==null||l.register(s.conditions.actions.values),(c=s.conditions)==null||(c=c.actions)==null||(c=c.values)==null||c.forEach((u=>{if(u&&u.name){var d=this.Ki.get(u.name);d&&d.push(s.id),this.Ki.set(u.name,d||[s.id])}})))})))}Zi(e){var t,s=e.filter((n=>{var a,l;return((a=n.conditions)==null?void 0:a.events)&&((l=n.conditions)==null||(l=l.events)==null||(l=l.values)==null?void 0:l.length)>0})),i=e.filter((n=>{var a,l;return((a=n.conditions)==null?void 0:a.cancelEvents)&&((l=n.conditions)==null||(l=l.cancelEvents)==null||(l=l.values)==null?void 0:l.length)>0}));(s.length!==0||i.length!==0)&&((t=this._instance)==null||t.Ui(((n,a)=>{this.onEvent(n,a)})),this.Vi=this.Xi(e,Pt.Activation),this.Ji=this.Xi(e,Pt.Cancellation))}onEvent(e,t){var s,i=((s=this._instance)==null||(s=s.persistence)==null?void 0:s.props[as])||[];if(fs.SHOWN===e&&t&&i.length>0){var n;M.info("survey event matched, removing survey from activated surveys",{event:e,eventPayload:t,existingActivatedSurveys:i});var a=t==null||(n=t.properties)==null?void 0:n.$survey_id;if(a){var l=i.indexOf(a);l>=0&&(i.splice(l,1),this.ee(i))}}else{if(this.Ji.has(e)){var c=this.Qi(e,t,Pt.Cancellation);c.length>0&&(M.info("cancel event matched, cancelling surveys",{event:e,surveysToCancel:c.map((d=>d.id))}),c.forEach((d=>{var h,f=i.indexOf(d.id);f>=0&&i.splice(f,1),(h=this._instance)==null||h.cancelPendingSurvey(d.id)})),this.ee(i))}if(this.Vi.has(e)){M.info("survey event name matched",{event:e,eventPayload:t,surveys:this.Vi.get(e)});var u=this.Qi(e,t,Pt.Activation);this.ee(i.concat(u.map((d=>d.id))||[]))}}}onAction(e){var t,s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[as])||[];this.Ki.has(e)&&this.ee(s.concat(this.Ki.get(e)||[]))}ee(e){var t;M.info("updating activated surveys",{activatedSurveys:e}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[as]:[...new Set(e)]})}getSurveys(){var e,t=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[as];return t||[]}getEventToSurveys(){return this.Vi}re(){return this.ie}}class Dl{constructor(e){this.se=void 0,this._surveyManager=null,this.ne=!1,this.oe=!1,this.ae=[],this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(A(t))return M.warn("Flags not loaded yet. Not loading surveys.");var s=L(t);this.se=s?t.length>0:t,M.info("flags response received, isSurveysEnabled: "+this.se),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var s=localStorage.key(t);(s!=null&&s.startsWith(jr)||s!=null&&s.startsWith("inProgressSurvey_"))&&e.push(s)}e.forEach((i=>localStorage.removeItem(i)))}loadIfEnabled(){if(!this._surveyManager)if(this.oe)M.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)M.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())M.info("Not loading surveys in cookieless mode without consent.");else{var e=I?.__PosthogExtensions__;if(e){if(!x(this.se)||this._instance.config.advanced_enable_surveys){var t=this.se||this._instance.config.advanced_enable_surveys;this.oe=!0;try{var s=e.generateSurveys;if(s)return void this.le(s,t);var i=e.loadExternalDependency;if(!i)return void this.ue("PostHog loadExternalDependency extension not found.");i(this._instance,"surveys",(n=>{n||!e.generateSurveys?this.ue("Could not load surveys script",n):this.le(e.generateSurveys,t)}))}catch(n){throw this.ue("Error initializing surveys",n),n}finally{this.oe=!1}}}else M.error("PostHog Extensions not found.")}}le(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new Ml(this._instance),M.info("Surveys loaded successfully"),this.he({isLoaded:!0})}ue(e,t){M.error(e,t),this.he({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.ae.push(e),this._surveyManager&&this.he({isLoaded:!0}),()=>{this.ae=this.ae.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return M.info("Disabled. Not loading surveys."),e([]);var s=this._instance.get_property(hr);if(s&&!t)return e(s,{isLoaded:!0});if(this.ne)return e([],{isLoaded:!1,error:"Surveys are already being loaded"});try{this.ne=!0,this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var n;this.ne=!1;var a=i.statusCode;if(a!==200||!i.json){var l="Surveys API could not be loaded, status: "+a;return M.error(l),e([],{isLoaded:!1,error:l})}var c,u=i.json.surveys||[],d=u.filter((h=>(function(f){return!(!f.start_date||f.end_date)})(h)&&((function(f){var g;return!((g=f.conditions)==null||(g=g.events)==null||(g=g.values)==null||!g.length)})(h)||(function(f){var g;return!((g=f.conditions)==null||(g=g.actions)==null||(g=g.values)==null||!g.length)})(h))));return d.length>0&&((c=this._surveyEventReceiver)==null||c.register(d)),(n=this._instance.persistence)==null||n.register({[hr]:u}),e(u,{isLoaded:!0})}})}catch(i){throw this.ne=!1,i}}he(e){for(var t of this.ae)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(s){M.error("Error in survey callback",s)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!A(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);M.warn("init was not called")}de(e){var t=null;return this.getSurveys((s=>{var i;t=(i=s.find((n=>n.id===e)))!==null&&i!==void 0?i:null})),t}ve(e){if(A(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.de(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(A(this._surveyManager))return M.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.ve(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return A(this._surveyManager)?(M.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((s=>{this.getSurveys((i=>{var n,a=(n=i.find((c=>c.id===e)))!==null&&n!==void 0?n:null;if(a){var l=this.ve(a);s({visible:l.eligible,disabledReason:l.reason})}else s({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t){var s;if(A(this._surveyManager))M.warn("init was not called");else{var i=typeof e=="string"?this.de(e):e;if(i!=null&&i.id)if(Al.includes(i.type)){var n=w?.querySelector(t);if(n)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(M.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var a,l;M.info("Rendering survey "+i.id+" with delay of "+((a=i.appearance)==null?void 0:a.surveyPopupDelaySeconds)+" seconds"),(l=this._surveyManager)==null||l.renderSurvey(i,n),M.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,n);M.warn("Survey element not found")}else M.warn("Surveys of type "+i.type+" cannot be rendered in the app");else M.warn("Survey not found")}}displaySurvey(e,t){var s;if(A(this._surveyManager))M.warn("init was not called");else{var i=this.de(e);if(i){var n=i;if((s=i.appearance)!=null&&s.surveyPopupDelaySeconds&&t.ignoreDelay&&(n=E({},i,{appearance:E({},i.appearance,{surveyPopupDelaySeconds:0})})),t.ignoreConditions===!1){var a=this.canRenderSurvey(i);if(!a.visible)return void M.warn("Survey is not eligible to be displayed: ",a.disabledReason)}t.displayType!==ua.Inline?this._surveyManager.handlePopoverSurvey(n):this.renderSurvey(n,t.selector)}else M.warn("Survey not found")}}cancelPendingSurvey(e){A(this._surveyManager)?M.warn("init was not called"):this._surveyManager.cancelSurvey(e)}}var Hi=J("[RateLimiter]");class zl{constructor(e){var t,s;this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=i=>{var n=i.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((a=>{Hi.info((a||"events")+" is quota limited."),this.serverLimits[a]=new Date().getTime()+6e4}))}catch(a){return void Hi.warn('could not rate limit - continuing. Error: "'+a?.message+'"',{text:n})}},this.instance=e,this.captureEventsPerSecond=((t=e.config.rate_limiting)==null?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((s=e.config.rate_limiting)==null?void 0:s.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(e){var t,s,i;e===void 0&&(e=!1);var n=new Date().getTime(),a=(t=(s=this.instance.persistence)==null?void 0:s.get_property(gr))!==null&&t!==void 0?t:{tokens:this.captureEventsBurstLimit,last:n};a.tokens+=(n-a.last)/1e3*this.captureEventsPerSecond,a.last=n,a.tokens>this.captureEventsBurstLimit&&(a.tokens=this.captureEventsBurstLimit);var l=a.tokens<1;return l||e||(a.tokens=Math.max(0,a.tokens-1)),!l||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+this.captureEventsPerSecond+" events per second and "+this.captureEventsBurstLimit+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=l,(i=this.instance.persistence)==null||i.set_property(gr,a),{isRateLimited:l,remainingTokens:a.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var tt=J("[RemoteConfig]");class Hl{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=I._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}ce(e){var t,s;(t=I.__PosthogExtensions__)!=null&&t.loadExternalDependency?(s=I.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(tt.error("PostHog Extensions not found. Cannot load remote config."),e())}fe(e){this._instance.ci({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return tt.info("Using preloaded remote config",this.remoteConfig),void this.fi(this.remoteConfig);if(this._instance.O())return void tt.warn("Remote config is disabled. Falling back to local config.");this.ce((e=>{if(!e)return tt.info("No config found after loading remote JS config. Falling back to JSON."),void this.fe((t=>{this.fi(t)}));this.fi(e)}))}catch(e){tt.error("Error loading remote config",e)}}fi(e){e?this._instance.config.__preview_remote_config?(this._instance.fi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):tt.info("__preview_remote_config is disabled. Logging config instead",e):tt.error("Failed to fetch remote config from PostHog.")}}var Er=3e3;class Ul{constructor(e,t){this.pe=!0,this.ge=[],this._e=Te(t?.flush_interval_ms||Er,250,5e3,k.createLogger("flush interval"),Er),this.me=e}enqueue(e){this.ge.push(e),this.ye||this.be()}unload(){this.we();var e=this.ge.length>0?this.xe():{},t=Object.values(e);[...t.filter((s=>s.url.indexOf("/e")===0)),...t.filter((s=>s.url.indexOf("/e")!==0))].map((s=>{this.me(E({},s,{transport:"sendBeacon"}))}))}enable(){this.pe=!1,this.be()}be(){var e=this;this.pe||(this.ye=setTimeout((()=>{if(this.we(),this.ge.length>0){var t=this.xe(),s=function(){var n=t[i],a=new Date().getTime();n.data&&L(n.data)&&z(n.data,(l=>{l.offset=Math.abs(l.timestamp-a),delete l.timestamp})),e.me(n)};for(var i in t)s()}}),this._e))}we(){clearTimeout(this.ye),this.ye=void 0}xe(){var e={};return z(this.ge,(t=>{var s,i=t,n=(i?i.batchKey:null)||i.url;x(e[n])&&(e[n]=E({},i,{data:[]})),(s=e[n].data)==null||s.push(i.data)})),this.ge=[],e}}var ql=["retriesPerformedSoFar"];class Bl{constructor(e){this.Ee=!1,this.Se=3e3,this.ge=[],this._instance=e,this.ge=[],this.$e=!0,!x(p)&&"onLine"in p.navigator&&(this.$e=p.navigator.onLine,this.ke=()=>{this.$e=!0,this.Dt()},this.Pe=()=>{this.$e=!1},X(p,"online",this.ke),X(p,"offline",this.Pe))}get length(){return this.ge.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,s=nn(e,ql);Re(t)&&t>0&&(s.url=Ps(s.url,{retry_count:t})),this._instance.ci(E({},s,{callback:i=>{i.statusCode!==200&&(i.statusCode<400||i.statusCode>=500)&&(t??0)<10?this.Te(E({retriesPerformedSoFar:t},s)):s.callback==null||s.callback(i)}}))}Te(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var s=(function(a){var l=3e3*Math.pow(2,a),c=l/2,u=Math.min(18e5,l),d=(Math.random()-.5)*(u-c);return Math.ceil(u+d)})(t),i=Date.now()+s;this.ge.push({retryAt:i,requestOptions:e});var n="Enqueued failed request for retry in "+s;navigator.onLine||(n+=" (Browser is offline)"),k.warn(n),this.Ee||(this.Ee=!0,this.Re())}Re(){if(this.Ce&&clearTimeout(this.Ce),this.ge.length===0)return this.Ee=!1,void(this.Ce=void 0);this.Ce=setTimeout((()=>{this.$e&&this.ge.length>0&&this.Dt(),this.Re()}),this.Se)}Dt(){var e=Date.now(),t=[],s=this.ge.filter((n=>n.retryAt<e||(t.push(n),!1)));if(this.ge=t,s.length>0)for(var{requestOptions:i}of s)this.retriableRequest(i)}unload(){for(var{requestOptions:e}of(this.Ce&&(clearTimeout(this.Ce),this.Ce=void 0),this.Ee=!1,x(p)||(this.ke&&(p.removeEventListener("online",this.ke),this.ke=void 0),this.Pe&&(p.removeEventListener("offline",this.Pe),this.Pe=void 0)),this.ge))try{this._instance.ci(E({},e,{transport:"sendBeacon"}))}catch(t){k.error(t)}this.ge=[]}}class Gl{constructor(e){this.Ie=()=>{var t,s,i,n;this.Fe||(this.Fe={});var a=this.scrollElement(),l=this.scrollY(),c=a?Math.max(0,a.scrollHeight-a.clientHeight):0,u=l+(a?.clientHeight||0),d=a?.scrollHeight||0;this.Fe.lastScrollY=Math.ceil(l),this.Fe.maxScrollY=Math.max(l,(t=this.Fe.maxScrollY)!==null&&t!==void 0?t:0),this.Fe.maxScrollHeight=Math.max(c,(s=this.Fe.maxScrollHeight)!==null&&s!==void 0?s:0),this.Fe.lastContentY=u,this.Fe.maxContentY=Math.max(u,(i=this.Fe.maxContentY)!==null&&i!==void 0?i:0),this.Fe.maxContentHeight=Math.max(d,(n=this.Fe.maxContentHeight)!==null&&n!==void 0?n:0)},this._instance=e}getContext(){return this.Fe}resetContext(){var e=this.Fe;return setTimeout(this.Ie,0),e}startMeasuringScrollPosition(){X(p,"scroll",this.Ie,{capture:!0}),X(p,"scrollend",this.Ie,{capture:!0}),X(p,"resize",this.Ie)}scrollElement(){if(!this._instance.config.scroll_root_selector)return p?.document.documentElement;var e=L(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var s=p?.document.querySelector(t);if(s)return s}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return p&&(p.scrollY||p.pageYOffset||p.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return p&&(p.scrollX||p.pageXOffset||p.document.documentElement.scrollLeft)||0}}var Vl=r=>ea(r?.config.mask_personal_data_properties,r?.config.custom_personal_data_properties);class Ui{constructor(e,t,s,i){this.Me=n=>{var a=this.Oe();if(!a||a.sessionId!==n){var l={sessionId:n,props:this.Ae(this._instance)};this.De.register({[pr]:l})}},this._instance=e,this.je=t,this.De=s,this.Ae=i||Vl,this.je.onSessionId(this.Me)}Oe(){return this.De.props[pr]}getSetOnceProps(){var e,t=(e=this.Oe())==null?void 0:e.props;return t?"r"in t?ta(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return z(Ir(this.getSetOnceProps()),((t,s)=>{s==="$current_url"&&(s="url"),e["$session_entry_"+nr(s)]=t})),e}}var tr=J("[SessionId]");class qi{on(e,t){return this.Le.on(e,t)}constructor(e,t,s){var i;if(this.Ne=[],this.Ue=void 0,this.Le=new zr,this.ze=(d,h)=>Math.abs(d-h)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.I=e.config,this.De=e.persistence,this.He=void 0,this.Be=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.qe=t||We,this.We=s||We;var n=this.I.persistence_name||this.I.token,a=this.I.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*Te(a,60,36e3,tr.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.Ge(),this.Ve="ph_"+n+"_window_id",this.Je="ph_"+n+"_primary_window_exists",this.Ke()){var l=ae.W(this.Ve),c=ae.W(this.Je);l&&!c?this.He=l:ae.V(this.Ve),ae.G(this.Je,!0)}if((i=this.I.bootstrap)!=null&&i.sessionID)try{var u=(d=>{var h=d.replace(/-/g,"");if(h.length!==32)throw new Error("Not a valid UUID");if(h[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(h.substring(0,12),16)})(this.I.bootstrap.sessionID);this.Ye(this.I.bootstrap.sessionID,new Date().getTime(),u)}catch(d){tr.error("Invalid sessionID in bootstrap",d)}this.Xe()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return x(this.Ne)&&(this.Ne=[]),this.Ne.push(e),this.Be&&e(this.Be,this.He),()=>{this.Ne=this.Ne.filter((t=>t!==e))}}Ke(){return this.I.persistence!=="memory"&&!this.De.wi&&ae.H()}Qe(e){e!==this.He&&(this.He=e,this.Ke()&&ae.G(this.Ve,e))}Ze(){return this.He?this.He:this.Ke()?ae.W(this.Ve):null}Ye(e,t,s){e===this.Be&&t===this._sessionActivityTimestamp&&s===this._sessionStartTimestamp||(this._sessionStartTimestamp=s,this._sessionActivityTimestamp=t,this.Be=e,this.De.register({[_s]:[t,e,s]}))}tr(){var e=this.De.props[_s];return L(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.Ye(null,null,null)}destroy(){clearTimeout(this.ir),this.ir=void 0,this.Ue&&p&&(p.removeEventListener("beforeunload",this.Ue,{capture:!1}),this.Ue=void 0),this.Ne=[]}Xe(){this.Ue=()=>{this.Ke()&&ae.V(this.Je)},X(p,"beforeunload",this.Ue,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.I.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var s=t||new Date().getTime(),[i,n,a]=this.tr(),l=this.Ze(),c=Re(a)&&a>0&&Math.abs(s-a)>864e5,u=!1,d=!n,h=!d&&!e&&this.ze(s,i);d||h||c?(n=this.qe(),l=this.We(),tr.info("new session ID generated",{sessionId:n,windowId:l,changeReason:{noSessionId:d,activityTimeout:h,sessionPastMaximumLength:c}}),a=s,u=!0):l||(l=this.We(),u=!0);var f=i===0||!e||c?s:i,g=a===0?new Date().getTime():a;return this.Qe(l),this.Ye(n,f,g),e||this.Ge(),u&&this.Ne.forEach((m=>m(n,l,u?{noSessionId:d,activityTimeout:h,sessionPastMaximumLength:c}:void 0))),{sessionId:n,windowId:l,sessionStartTimestamp:g,changeReason:u?{noSessionId:d,activityTimeout:h,sessionPastMaximumLength:c}:void 0,lastActivityTimestamp:i}}Ge(){clearTimeout(this.ir),this.ir=setTimeout((()=>{var[e]=this.tr();if(this.ze(new Date().getTime(),e)){var t=this.Be;this.resetSessionId(),this.Le.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var Wl=["$set_once","$set"],Ge=J("[SiteApps]");class Yl{constructor(e){this._instance=e,this.er=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}rr(e,t){if(t){var s=this.globalsForEvent(t);this.er.push(s),this.er.length>1e3&&(this.er=this.er.slice(10))}}get siteAppLoaders(){var e;return(e=I._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance.Ui(this.rr.bind(this));this.sr=()=>{e(),this.er=[],this.sr=void 0}}}globalsForEvent(e){var t,s,i,n,a,l,c;if(!e)throw new Error("Event payload is required");var u={},d=this._instance.get_property("$groups")||[],h=this._instance.get_property("$stored_group_properties")||{};for(var[f,g]of Object.entries(h))u[f]={id:d[f],type:f,properties:g};var{$set_once:m,$set:v}=e;return{event:E({},nn(e,Wl),{properties:E({},e.properties,v?{$set:E({},(t=(s=e.properties)==null?void 0:s.$set)!==null&&t!==void 0?t:{},v)}:{},m?{$set_once:E({},(i=(n=e.properties)==null?void 0:n.$set_once)!==null&&i!==void 0?i:{},m)}:{}),elements_chain:(a=(l=e.properties)==null?void 0:l.$elements_chain)!==null&&a!==void 0?a:"",distinct_id:(c=e.properties)==null?void 0:c.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:u}}setupSiteApp(e){var t=this.apps[e.id],s=()=>{var l;!t.errored&&this.er.length&&(Ge.info("Processing "+this.er.length+" events for site app with id "+e.id),this.er.forEach((c=>t.processEvent==null?void 0:t.processEvent(c))),t.processedBuffer=!0),Object.values(this.apps).every((c=>c.processedBuffer||c.errored))&&((l=this.sr)==null||l.call(this))},i=!1,n=l=>{t.errored=!l,t.loaded=!0,Ge.info("Site app with id "+e.id+" "+(l?"loaded":"errored")),i&&s()};try{var{processEvent:a}=e.init({posthog:this._instance,callback:l=>{n(l)}});a&&(t.processEvent=a),i=!0}catch(l){Ge.error("Error while initializing PostHog app with config id "+e.id,l),n(!1)}if(i&&t.loaded)try{s()}catch(l){Ge.error("Error while processing buffered events PostHog app with config id "+e.id,l),t.errored=!0}}nr(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var s of e)this.setupSiteApp(s)}ar(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var s of Object.values(this.apps))try{s.processEvent==null||s.processEvent(t)}catch(i){Ge.error("Error while processing event "+e.event+" for site app "+s.id,i)}}}onRemoteConfig(e){var t,s,i,n=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.nr(),void this._instance.on("eventCaptured",(u=>this.ar(u)))):void Ge.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((s=this.sr)==null||s.call(this),(i=e.siteApps)!=null&&i.length)if(this.isEnabled){var a=function(u){var d;I["__$$ph_site_app_"+u]=n._instance,(d=I.__PosthogExtensions__)==null||d.loadSiteApp==null||d.loadSiteApp(n._instance,c,(h=>{if(h)return Ge.error("Error while initializing PostHog app with config id "+u,h)}))};for(var{id:l,url:c}of e.siteApps)a(l)}else Ge.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var da=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&ti(t,e))return!0;try{var s=r?.userAgentData;if(s!=null&&s.brands&&s.brands.some((i=>ti(i?.brand,e))))return!0}catch{}return!!r.webdriver},Lt=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),Bi="i.posthog.com";class Xl{constructor(e){this.lr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+Bi,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.lr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.lr[this.apiHost]=Lt.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.lr[this.apiHost]=Lt.EU:this.lr[this.apiHost]=Lt.CUSTOM),this.lr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===Lt.CUSTOM)return this.apiHost+t;var s=Bi+t;switch(e){case"assets":return"https://"+this.region+"-assets."+s;case"api":return"https://"+this.region+"."+s}}}var Jl={icontains:(r,e)=>!!p&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!p&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!p&&Is(e.href,r),not_regex:(r,e)=>!!p&&!Is(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class ce{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(s){s===void 0&&(s=!1),t.getWebExperiments((i=>{ce.ur("retrieved web experiments from the server"),t.hr=new Map,i.forEach((n=>{if(n.feature_flag_key){var a;t.hr&&(ce.ur("setting flag key ",n.feature_flag_key," to web experiment ",n),(a=t.hr)==null||a.set(n.feature_flag_key,n));var l=t._instance.getFeatureFlag(n.feature_flag_key);Q(l)&&n.variants[l]&&t.dr(n.name,l,n.variants[l].transforms)}else if(n.variants)for(var c in n.variants){var u=n.variants[c];ce.vr(u)&&t.dr(n.name,c,u.transforms)}}))}),s)},this._instance=e,this._instance.onFeatureFlags((s=>{this.onFeatureFlags(s)}))}onFeatureFlags(e){if(this._is_bot())ce.ur("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(A(this.hr))return this.hr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();ce.ur("applying feature flags",e),e.forEach((t=>{var s;if(this.hr&&(s=this.hr)!=null&&s.has(t)){var i,n=this._instance.getFeatureFlag(t),a=(i=this.hr)==null?void 0:i.get(t);n&&a!=null&&a.variants[n]&&this.dr(a.name,n,a.variants[n].transforms)}}))}}previewWebExperiment(){var e=ce.getWindowLocation();if(e!=null&&e.search){var t=js(e?.search,"__experiment_id"),s=js(e?.search,"__experiment_variant");t&&s&&(ce.ur("previewing web experiments "+t+" && "+s),this.getWebExperiments((i=>{this.cr(parseInt(t),s,i)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,s){if(this._instance.config.disable_web_experiments&&!s)return e([]);var i=this._instance.get_property("$web_experiments");if(i&&!t)return e(i);this._instance.ci({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:n=>{if(n.statusCode!==200||!n.json)return e([]);var a=n.json.experiments||[];return e(a)}})}cr(e,t,s){var i=s.filter((n=>n.id===e));i&&i.length>0&&(ce.ur("Previewing web experiment ["+i[0].name+"] with variant ["+t+"]"),this.dr(i[0].name,t,i[0].variants[t].transforms))}static vr(e){return!A(e.conditions)&&ce.pr(e)&&ce.gr(e)}static pr(e){var t;if(A(e.conditions)||A((t=e.conditions)==null?void 0:t.url))return!0;var s,i,n,a=ce.getWindowLocation();return!!a&&((s=e.conditions)==null||!s.url||Jl[(i=(n=e.conditions)==null?void 0:n.urlMatchType)!==null&&i!==void 0?i:"icontains"](e.conditions.url,a))}static getWindowLocation(){return p?.location}static gr(e){var t;if(A(e.conditions)||A((t=e.conditions)==null?void 0:t.utm))return!0;var s=Jn();if(s.utm_source){var i,n,a,l,c,u,d,h,f=(i=e.conditions)==null||(i=i.utm)==null||!i.utm_campaign||((n=e.conditions)==null||(n=n.utm)==null?void 0:n.utm_campaign)==s.utm_campaign,g=(a=e.conditions)==null||(a=a.utm)==null||!a.utm_source||((l=e.conditions)==null||(l=l.utm)==null?void 0:l.utm_source)==s.utm_source,m=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_medium||((u=e.conditions)==null||(u=u.utm)==null?void 0:u.utm_medium)==s.utm_medium,v=(d=e.conditions)==null||(d=d.utm)==null||!d.utm_term||((h=e.conditions)==null||(h=h.utm)==null?void 0:h.utm_term)==s.utm_term;return f&&m&&v&&g}return!1}static ur(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];k.info("[WebExperiments] "+e,s)}dr(e,t,s){this._is_bot()?ce.ur("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?s.forEach((i=>{if(i.selector){var n;ce.ur("applying transform of variant "+t+" for experiment "+e+" ",i);var a=(n=document)==null?void 0:n.querySelectorAll(i.selector);a?.forEach((l=>{var c=l;i.html&&(c.innerHTML=i.html),i.css&&c.setAttribute("style",i.css)}))}})):ce.ur("Control variants leave the page unmodified.")}_is_bot(){return ye&&this._instance?da(ye,this._instance.config.custom_blocked_useragents):void 0}}var Kl=J("[PostHog ExternalIntegrations]"),Zl={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class Ql{constructor(e){this._instance=e}it(e,t){var s;(s=I.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,e,(i=>{if(i)return Kl.error("failed to load script",i);t()}))}startIfEnabledOrStop(){var e=this,t=function(a){var l,c,u;!i||(l=I.__PosthogExtensions__)!=null&&(l=l.integrations)!=null&&l[a]||e.it(Zl[a],(()=>{var d;(d=I.__PosthogExtensions__)==null||(d=d.integrations)==null||(d=d[a])==null||d.start(e._instance)})),!i&&(c=I.__PosthogExtensions__)!=null&&(c=c.integrations)!=null&&c[a]&&((u=I.__PosthogExtensions__)==null||(u=u.integrations)==null||(u=u[a])==null||u.stop())};for(var[s,i]of Object.entries((n=this._instance.config.integrations)!==null&&n!==void 0?n:{})){var n;t(s)}}}var Nr="[SessionRecording]",It=J(Nr);class Gi{get started(){var e;return!((e=this._r)==null||!e.isStarted)}get status(){return this._r?this._r.status:this.mr&&!this.yr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.mr=!1,this.br=void 0,this._instance=e,!this._instance.sessionManager)throw It.error("started without valid sessionManager"),new Error(Nr+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(Nr+' cannot be used with cookieless_mode="always"')}get yr(){var e,t=!((e=this._instance.get_property(Hs))==null||!e.enabled),s=!this._instance.config.disable_session_recording,i=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return p&&t&&s&&!i}startIfEnabledOrStop(e){var t;if(!this.yr||(t=this._r)==null||!t.isStarted){var s=!x(Object.assign)&&!x(Array.from);this.yr&&s?(this.wr(e),It.info("starting")):this.stopRecording()}}wr(e){var t,s,i;this.yr&&(I!=null&&(t=I.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(s=I.__PosthogExtensions__)!=null&&s.initSessionRecording?this.Er(e):(i=I.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this._instance,this.Sr,(n=>{if(n)return It.error("could not load recorder",n);this.Er(e)})))}stopRecording(){var e,t;(e=this.br)==null||e.call(this),this.br=void 0,(t=this._r)==null||t.stop()}$r(){var e;(e=this._instance.persistence)==null||e.unregister(fn)}kr(e){if(this._instance.persistence){var t,s,i=this._instance.persistence,n=()=>{var a=e.sessionRecording===!1?void 0:e.sessionRecording,l=a?.sampleRate,c=A(l)?null:parseFloat(l);A(c)&&this.$r();var u=a?.minimumDurationMilliseconds;i.register({[Hs]:E({enabled:!!a},a,{networkPayloadCapture:E({capturePerformance:e.capturePerformance},a?.networkPayloadCapture),canvasRecording:{enabled:a?.recordCanvas,fps:a?.canvasFps,quality:a?.canvasQuality},sampleRate:c,minimumDurationMilliseconds:x(u)?null:u,endpoint:a?.endpoint,triggerMatchType:a?.triggerMatchType,masking:a?.masking,urlTriggers:a?.urlTriggers})})};n(),(t=this.br)==null||t.call(this),this.br=(s=this._instance.sessionManager)==null?void 0:s.onSessionId(n)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.kr(e),this.mr=!0,this.startIfEnabledOrStop()):this.mr=!0:It.info("skipping remote config with no sessionRecording",e)}log(e,t){var s;t===void 0&&(t="log"),(s=this._r)!=null&&s.log?this._r.log(e,t):It.warn("log called before recorder was ready")}get Sr(){var e,t,s=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Hs);return(s==null||(t=s.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Er(e){var t,s;if((t=I.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this._r||(this._r=(s=I.__PosthogExtensions__)==null?void 0:s.initSessionRecording(this._instance),this._r._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this._r.start(e)}onRRwebEmit(e){var t;(t=this._r)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this._r||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this._r)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this._r||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this._r)==null||e.overrideSampling()}overrideTrigger(e){var t,s;this._r||(s=this._instance.persistence)==null||s.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this._r)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this._r)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var s;return!((s=this._r)==null||!s.tryAddCustomEvent(e,t))}}var Dt={},Sr=()=>{},lt="posthog",ha=!Sl&&ve?.indexOf("MSIE")===-1&&ve?.indexOf("Mozilla")===-1,Vi=r=>{var e;return E({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:bo(w?.location),persistence:"localStorage+cookie",persistence_name:"",loaded:Sr,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:me&&Q(me?.search)&&me.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(p==null||(e=p.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var s="Bad HTTP status: "+t.statusCode+" "+t.text;k.error(s)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:Er},error_tracking:{},_onCapture:Sr,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{}}))(r))},Wi=r=>{var e={};x(r.process_person)||(e.person_profiles=r.process_person),x(r.xhr_headers)||(e.request_headers=r.xhr_headers),x(r.cookie_name)||(e.persistence_name=r.cookie_name),x(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),x(r.store_google)||(e.save_campaign_params=r.store_google),x(r.verbose)||(e.debug=r.verbose);var t=V({},e,r);return L(r.property_blacklist)&&(x(r.property_denylist)?t.property_denylist=r.property_blacklist:L(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:k.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class ec{constructor(){this.__forceAllowLocalhost=!1}get Pr(){return this.__forceAllowLocalhost}set Pr(e){k.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class Rs{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new ec,this.Tr=!1,this.version=Le.LIB_VERSION,this.Rr=new zr,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=Vi(),this.SentryIntegration=Jo,this.sentryIntegration=e=>(function(t,s){var i=$n(t,s);return{name:Fn,processEvent:n=>i(n)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Cr=!1,this.Ir=null,this.Fr=null,this.Mr=null,this.featureFlags=new Tl(this),this.toolbar=new Zo(this),this.scrollManager=new Gl(this),this.pageViewManager=new _l(this),this.surveys=new Dl(this),this.productTours=new $l(this),this.experiments=new ce(this),this.exceptions=new Cl(this),this.rateLimiter=new zl(this),this.requestRouter=new Xl(this),this.consent=new Bo(this),this.externalIntegrations=new Ql(this),this.people={set:(e,t,s)=>{var i=Q(e)?{[e]:t}:e;this.setPersonProperties(i),s?.({})},set_once:(e,t,s)=>{var i=Q(e)?{[e]:t}:e;this.setPersonProperties(void 0,i),s?.({})}},this.on("eventCaptured",(e=>k.info('send "'+e?.event+'"',e)))}init(e,t,s){if(s&&s!==lt){var i,n=(i=Dt[s])!==null&&i!==void 0?i:new Rs;return n._init(e,t,s),Dt[s]=n,Dt[lt][s]=n,n}return this._init(e,t,s)}_init(e,t,s){var i;if(t===void 0&&(t={}),x(e)||ar(e))return k.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return this;this.__loaded=!0,this.config={},t.debug=this.Or(t.debug),this.Ar=t,this.Dr=[],t.person_profiles&&(this.Fr=t.person_profiles),this.set_config(V({},Vi(t.defaults),Wi(t),{name:s,token:e})),this.config.on_xhr_error&&k.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:ze.GZipJS;var n=this.jr();this.persistence=new Zs(this.config,n),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Zs(E({},this.config,{persistence:"sessionStorage"}),n);var a=E({},this.persistence.props),l=E({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Lr=new Ul((b=>this.Nr(b)),this.config.request_queue_config),this.Ur=new Bl(this),this.__request_queue=[];var c=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(c||(this.sessionManager=new qi(this),this.sessionPropsManager=new Ui(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(k.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.zr(c)}),0)):(k.info("Initializing extensions synchronously"),this.zr(c)),Le.DEBUG=Le.DEBUG||this.config.debug,Le.DEBUG&&k.info("Starting in debug mode",{this:this,config:t,thisC:E({},this.config),p:a,s:l}),((i=t.bootstrap)==null?void 0:i.distinctID)!==void 0){var u,d,h=this.config.get_device_id(We()),f=(u=t.bootstrap)!=null&&u.isIdentifiedID?h:t.bootstrap.distinctID;this.persistence.set_property(Me,(d=t.bootstrap)!=null&&d.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:f})}if(this.Hr()){var g,m,v=Object.keys(((g=t.bootstrap)==null?void 0:g.featureFlags)||{}).filter((b=>{var T;return!((T=t.bootstrap)==null||(T=T.featureFlags)==null||!T[b])})).reduce(((b,T)=>{var S;return b[T]=((S=t.bootstrap)==null||(S=S.featureFlags)==null?void 0:S[T])||!1,b}),{}),y=Object.keys(((m=t.bootstrap)==null?void 0:m.featureFlagPayloads)||{}).filter((b=>v[b])).reduce(((b,T)=>{var S,N;return(S=t.bootstrap)!=null&&(S=S.featureFlagPayloads)!=null&&S[T]&&(b[T]=(N=t.bootstrap)==null||(N=N.featureFlagPayloads)==null?void 0:N[T]),b}),{});this.featureFlags.receivedFeatureFlags({featureFlags:v,featureFlagPayloads:y})}if(c)this.register_once({distinct_id:wt,$device_id:null},"");else if(!this.get_distinct_id()){var j=this.config.get_device_id(We());this.register_once({distinct_id:j,$device_id:j},""),this.persistence.set_property(Me,"anonymous")}return X(p,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Xo(this,(()=>this.Br())):this.Br(),Ye(this.config._onCapture)&&this.config._onCapture!==Sr&&(k.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(b=>this.config._onCapture(b.event,b)))),this.config.ip&&k.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}zr(e){var t=performance.now();this.historyAutocapture=new Yo(this),this.historyAutocapture.startIfEnabled();var s=[];s.push((()=>{new el(this).startIfEnabledOrStop()})),s.push((()=>{var i;this.siteApps=new Yl(this),(i=this.siteApps)==null||i.init()})),e||s.push((()=>{this.sessionRecording=new Gi(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||s.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),s.push((()=>{this.autocapture=new Ao(this),this.autocapture.startIfEnabled()})),s.push((()=>{this.surveys.loadIfEnabled()})),s.push((()=>{this.productTours.loadIfEnabled()})),s.push((()=>{this.heatmaps=new ml(this),this.heatmaps.startIfEnabled()})),s.push((()=>{this.webVitalsAutocapture=new fl(this)})),s.push((()=>{this.exceptionObserver=new Wo(this),this.exceptionObserver.startIfEnabled()})),s.push((()=>{this.deadClicksAutocapture=new Tn(this,Vo),this.deadClicksAutocapture.startIfEnabled()})),s.push((()=>{if(this.qr){var i=this.qr;this.qr=void 0,this.fi(i)}})),this.Wr(s,t)}Wr(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.Wr(e,t)}),0);var s=e.shift();if(s)try{s()}catch(n){k.error("Error initializing extension:",n)}}var i=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:i}),this.config.__preview_deferred_init_extensions&&k.info("PostHog extensions initialized ("+i+"ms)")}fi(e){var t,s,i,n,a,l,c,u;if(!w||!w.body)return k.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.fi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.qr=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=F(e.supportedCompression,ze.GZipJS)?ze.GZipJS:F(e.supportedCompression,ze.Base64)?ze.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Fr?this.Fr:"identified_only"}),(s=this.siteApps)==null||s.onRemoteConfig(e),(i=this.sessionRecording)==null||i.onRemoteConfig(e),(n=this.autocapture)==null||n.onRemoteConfig(e),(a=this.heatmaps)==null||a.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.productTours.onRemoteConfig(e),(l=this.webVitalsAutocapture)==null||l.onRemoteConfig(e),(c=this.exceptionObserver)==null||c.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(u=this.deadClicksAutocapture)==null||u.onRemoteConfig(e)}Br(){try{this.config.loaded(this)}catch(e){k.critical("`loaded` function failed",e)}this.Gr(),this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.Vr()}),1),new Hl(this).load(),this.featureFlags.flags()}Gr(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Lr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Je(this.__request_queue,(e=>this.Nr(e))),this.__request_queue=[],this.Gr()}_handle_unload(){var e,t;this.config.request_batching?(this.Jr()&&this.capture("$pageleave"),(e=this.Lr)==null||e.unload(),(t=this.Ur)==null||t.unload()):this.Jr()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}ci(e){this.__loaded&&(ha?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Ps(e.url,{ip:this.config.ip?1:0}),e.headers=E({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var s,i,n,a=E({},t);a.timeout=a.timeout||6e4,a.url=Ps(a.url,{_:new Date().getTime().toString(),ver:Le.LIB_VERSION,compression:a.compression});var l=(s=a.transport)!==null&&s!==void 0?s:"fetch",c=gs.filter((d=>!a.disableTransport||!d.transport||!a.disableTransport.includes(d.transport))),u=(i=(n=hn(c,(d=>d.transport===l)))==null?void 0:n.method)!==null&&i!==void 0?i:c[0].method;if(!u)throw new Error("No available transport method");u(a)})(E({},e,{callback:t=>{var s,i;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((s=(i=this.config).on_request_error)==null||s.call(i,t)),e.callback==null||e.callback(t)}}))))}Nr(e){this.Ur?this.Ur.retriableRequest(e):this.ci(e)}_execute_array(e){var t,s=[],i=[],n=[];Je(e,(l=>{l&&(t=l[0],L(t)?n.push(l):Ye(l)?l.call(this):L(l)&&t==="alias"?s.push(l):L(l)&&t.indexOf("capture")!==-1&&Ye(this[t])?n.push(l):i.push(l))}));var a=function(l,c){Je(l,(function(u){if(L(u[0])){var d=c;z(u,(function(h){d=d[h[0]].apply(d,h.slice(1))}))}else this[u[0]].apply(this,u.slice(1))}),c)};a(s,this),a(i,this),a(n,this)}Hr(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,s){var i;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Lr){if(this.is_capturing())if(!x(e)&&Q(e)){var n=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(n&&!this.config.__preview_capture_bot_pageviews)){var a=s!=null&&s.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(a==null||!a.isRateLimited){t!=null&&t.$current_url&&!Q(t?.$current_url)&&(k.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var l=new Date,c=s?.timestamp||l,u=We(),d={uuid:u,event:e,properties:this.calculateEventProperties(e,t||{},c,u)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&n&&(d.event="$bot_pageview",d.properties.$browser_type="bot"),a&&(d.properties.$lib_rate_limit_remaining_tokens=a.remainingTokens),s?.$set&&(d.$set=s?.$set);var h,f=e!=="$groupidentify",g=this.Kr(s?.$set_once,f);if(g&&(d.$set_once=g),(d=xo(d,s!=null&&s._noTruncate?null:this.config.properties_string_max_length)).timestamp=c,x(s?.timestamp)||(d.properties.$event_time_override_provided=!0,d.properties.$event_time_override_system_time=l),e===fs.DISMISSED||e===fs.SENT){var m=t?.[Di.SURVEY_ID],v=t?.[Di.SURVEY_ITERATION];h={id:m,current_iteration:v},localStorage.getItem(zi(h))||localStorage.setItem(zi(h),"true"),d.$set=E({},d.$set,{[Ol({id:m,current_iteration:v},e===fs.SENT?"responded":"dismissed")]:!0})}var y=E({},d.properties.$set,d.$set);if(ct(y)||this.setPersonPropertiesForFlags(y),!A(this.config.before_send)){var j=this.Yr(d);if(!j)return;d=j}this.Rr.emit("eventCaptured",d);var b={method:"POST",url:(i=s?._url)!==null&&i!==void 0?i:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:d,compression:"best-available",batchKey:s?._batchKey};return!this.config.request_batching||s&&(s==null||!s._batchKey)||s!=null&&s.send_instantly?this.Nr(b):this.Lr.enqueue(b),d}k.critical("This capture call is ignored due to client rate limiting.")}}else k.error("No event name provided to posthog.capture")}else k.uninitializedWarning("posthog.capture")}Ui(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,s,i,n){if(s=s||new Date,!this.persistence||!this.sessionPersistence)return t;var a=n?void 0:this.persistence.remove_event_timer(e),l=E({},t);if(l.token=this.config.token,l.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(l.$cookieless_mode=!0),e==="$snapshot"){var c=E({},this.persistence.properties(),this.sessionPersistence.properties());return l.distinct_id=c.distinct_id,(!Q(l.distinct_id)&&!Re(l.distinct_id)||ar(l.distinct_id))&&k.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),l}var u,d=gl(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:h,windowId:f}=this.sessionManager.checkAndGetSessionAndWindowId(n,s.getTime());l.$session_id=h,l.$window_id=f}this.sessionPropsManager&&V(l,this.sessionPropsManager.getSessionProps());try{var g;this.sessionRecording&&V(l,this.sessionRecording.sdkDebugProperties),l.$sdk_debug_retry_queue_size=(g=this.Ur)==null?void 0:g.length}catch(j){l.$sdk_debug_error_capturing_properties=String(j)}if(this.requestRouter.region===Lt.CUSTOM&&(l.$lib_custom_api_host=this.config.api_host),u=e!=="$pageview"||n?e!=="$pageleave"||n?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(s):this.pageViewManager.doPageView(s,i),l=V(l,u),e==="$pageview"&&w&&(l.title=w.title),!x(a)){var m=s.getTime()-a;l.$duration=parseFloat((m/1e3).toFixed(3))}ve&&this.config.opt_out_useragent_filter&&(l.$browser_type=this._is_bot()?"bot":"browser"),(l=V({},d,this.persistence.properties(),this.sessionPersistence.properties(),l)).$is_identified=this._isIdentified(),L(this.config.property_denylist)?z(this.config.property_denylist,(function(j){delete l[j]})):k.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var v=this.config.sanitize_properties;v&&(k.error("sanitize_properties is deprecated. Use before_send instead"),l=v(l,e));var y=this.Xr();return l.$process_person_profile=y,y&&!n&&this.Qr("_calculate_event_properties"),l}Kr(e,t){var s;if(t===void 0&&(t=!0),!this.persistence||!this.Xr()||this.Tr)return e;var i=this.persistence.get_initial_props(),n=(s=this.sessionPropsManager)==null?void 0:s.getSetOnceProps(),a=V({},i,n||{},e||{}),l=this.config.sanitize_properties;return l&&(k.error("sanitize_properties is deprecated. Use before_send instead"),a=l(a,"$set_once")),t&&(this.Tr=!0),ct(a)?void 0:a}register(e,t){var s;(s=this.persistence)==null||s.register(e,t)}register_once(e,t,s){var i;(i=this.persistence)==null||i.register_once(e,t,s)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}Zr(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t,s){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,s)}getEarlyAccessFeatures(e,t,s){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,s)}on(e,t){return this.Rr.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,s;return(t=(s=this.sessionManager)==null?void 0:s.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=Ll),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,s){if(!this.__loaded||!this.persistence)return k.uninitializedWarning("posthog.identify");if(Re(e)&&(e=e.toString(),k.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))k.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==wt){if(this.Qr("posthog.identify")){var i=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var n=i;this.register_once({$had_persisted_distinct_id:!0,$device_id:n},"")}e!==i&&e!==this.get_property(Tt)&&(this.unregister(Tt),this.register({distinct_id:e}));var a=(this.persistence.get_property(Me)||"anonymous")==="anonymous";e!==i&&a?(this.persistence.set_property(Me,"identified"),this.setPersonPropertiesForFlags(E({},s||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:i},{$set:t||{},$set_once:s||{}}),this.Mr=Ri(e,t,s),this.featureFlags.setAnonymousDistinctId(i)):(t||s)&&this.setPersonProperties(t,s),e!==i&&(this.reloadFeatureFlags(),this.unregister(xs))}}else k.critical('The string "'+wt+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else k.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.Qr("posthog.setPersonProperties")){var s=Ri(this.get_distinct_id(),e,t);this.Mr!==s?(this.setPersonPropertiesForFlags(E({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Mr=s):k.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,s){if(e&&t){var i=this.getGroups();i[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:E({},i,{[e]:t})}),s&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:s}),this.setGroupPropertiesForFlags({[e]:s})),i[e]===t||s||this.reloadFeatureFlags()}else k.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.Qr("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,s,i,n;if(k.info("reset"),!this.__loaded)return k.uninitializedWarning("posthog.reset");var a=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(s=this.sessionPersistence)==null||s.clear(),this.surveys.reset(),this.featureFlags.reset(),(i=this.persistence)==null||i.set_property(Me,"anonymous"),(n=this.sessionManager)==null||n.resetSessionId(),this.Mr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:wt,$device_id:null},"");else{var l=this.config.get_device_id(We());this.register_once({distinct_id:l,$device_id:e?l:a},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:s}=this.sessionManager.checkAndGetSessionAndWindowId(!0),i=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&s){var n,a=(n=e.timestampLookBack)!==null&&n!==void 0?n:10;if(!s)return i;i+="?t="+Math.max(Math.floor((new Date().getTime()-s)/1e3)-a,0)}return i}alias(e,t){return e===this.get_property(pn)?(k.critical("Attempting to create alias for existing People user - aborting."),-2):this.Qr("posthog.alias")?(x(t)&&(t=this.get_distinct_id()),e!==t?(this.Zr(Tt,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(k.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=E({},this.config);if(te(e)){var s,i,n,a,l;V(this.config,Wi(e));var c=this.jr();(s=this.persistence)==null||s.update_config(this.config,t,c),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Zs(E({},this.config,{persistence:"sessionStorage"}),c);var u=this.Or(this.config.debug);Xe(u)&&(this.config.debug=u),Xe(this.config.debug)&&(this.config.debug?(Le.DEBUG=!0,B.H()&&B.G("ph_debug","true"),k.info("set_config",{config:e,oldConfig:t,newConfig:E({},this.config)})):(Le.DEBUG=!1,B.H()&&B.V("ph_debug"))),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(n=this.autocapture)==null||n.startIfEnabled(),(a=this.heatmaps)==null||a.startIfEnabled(),this.surveys.loadIfEnabled(),this.ts(),(l=this.externalIntegrations)==null||l.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,s={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(s).some(Boolean)){var i,n,a,l,c;(i=this.sessionManager)==null||i.checkAndGetSessionAndWindowId(),s.sampling&&((n=this.sessionRecording)==null||n.overrideSampling()),s.linked_flag&&((a=this.sessionRecording)==null||a.overrideLinkedFlag()),s.url_trigger&&((l=this.sessionRecording)==null||l.overrideTrigger("url")),s.event_trigger&&((c=this.sessionRecording)==null||c.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var s=new Error("PostHog syntheticException"),i=this.exceptions.buildProperties(e,{handled:!0,syntheticException:s});return this.exceptions.sendExceptionEvent(E({},i,t))}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:lt;return t!==lt&&(t=lt+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(Me))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(Me))==="identified"}Xr(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&ct(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[Tt])&&((t=this.persistence)==null||(t=t.props)==null||!t[bs]))}Jr(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.Xr()||this.Qr("posthog.createPersonProfile")&&this.setPersonProperties({},{})}Qr(e){return this.config.person_profiles==="never"?(k.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.Zr(bs,!0),!0)}jr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}ts(){var e,t,s,i,n=this.jr();return((e=this.persistence)==null?void 0:e.wi)!==n&&((s=this.persistence)==null||s.set_disabled(n)),((t=this.sessionPersistence)==null?void 0:t.wi)!==n&&((i=this.sessionPersistence)==null||i.set_disabled(n)),n}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(s=this.sessionManager)==null||s.destroy(),this.sessionManager=new qi(this),this.persistence&&(this.sessionPropsManager=new Ui(this,this.sessionManager,this.persistence)),this.sessionRecording=new Gi(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this.ts(),this.Gr(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(x(e?.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e?.captureEventName)!==null&&i!==void 0?i:"$opt_in",e?.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.Vr()}else k.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this.ts(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:wt,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(t=this.sessionRecording)==null||t.stopRecording(),this.sessionRecording=void 0,this.Vr())):k.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===De.GRANTED?"granted":e===De.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this.ts()}_is_bot(){return ye?da(ye,this.config.custom_blocked_useragents):void 0}Vr(){w&&(w.visibilityState==="visible"?this.Cr||(this.Cr=!0,this.capture("$pageview",{title:w.title},{send_instantly:!0}),this.Ir&&(w.removeEventListener("visibilitychange",this.Ir),this.Ir=null)):this.Ir||(this.Ir=this.Vr.bind(this),X(w,"visibilitychange",this.Ir)))}debug(e){e===!1?(p?.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(p?.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}O(){var e,t,s,i,n,a,l,c=this.Ar||{};return"advanced_disable_flags"in c?!!c.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(k.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(s="advanced_disable_decide",i=!1,n=k,a=(t="advanced_disable_flags")in(e=c)&&!x(e[t]),l=s in e&&!x(e[s]),a?e[t]:l?(n&&n.warn("Config field '"+s+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[s]):i)}Yr(e){if(A(this.config.before_send))return e;var t=L(this.config.before_send)?this.config.before_send:[this.config.before_send],s=e;for(var i of t){if(s=i(s),A(s)){var n="Event '"+e.event+"' was rejected in beforeSend function";return Ga(e.event)?k.warn(n+". This can cause unexpected behavior."):k.info(n),null}s.properties&&!ct(s.properties)||k.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return s}getPageViewId(){var e;return(e=this.pageViewManager.Vt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,s){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(s)})}Or(e){var t=Xe(e)&&!e,s=B.H()&&B.q("ph_debug")==="true";return!t&&(!!s||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=_o(r.prototype[e[t]])})(Rs,["identify"]);var Yi,Os=(Yi=Dt[lt]=new Rs,(function(){function r(){r.done||(r.done=!0,ha=!1,z(Dt,(function(e){e._dom_loaded()})))}w!=null&&w.addEventListener?w.readyState==="complete"?r():X(w,"DOMContentLoaded",r,{capture:!1}):p&&k.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),Yi);const tc="phc_CnQoAhO7LuIZtFrzKlzsMKL3bVmWtGv4sEUgMFnnM4I",sc="https://us.i.posthog.com";let Vt=!1;const rc=()=>{if(!Vt)try{Os.init(tc,{api_host:sc,autocapture:!1,capture_pageview:!1,persistence:"localStorage",disable_session_recording:!0}),Vt=!0}catch{}},Ie=(r,e)=>{try{if(!Vt)return;Os.capture(r,e)}catch{}},ic=(r,e)=>{try{if(!Vt)return;Os.identify(r,{email:e})}catch{}},nc=()=>{try{if(!Vt)return;Os.reset()}catch{}},ac=[{name:"ChatGPT",domain:"chatgpt.com",url:"https://chatgpt.com"},{name:"OpenAI",domain:"openai.com",url:"https://openai.com"},{name:"Google Gemini",domain:"gemini.google.com",url:"https://gemini.google.com"},{name:"Google Labs",domain:"labs.google.com",url:"https://labs.google.com"},{name:"Figma",domain:"figma.com",url:"https://figma.com"},{name:"Visily",domain:"visily.ai",url:"https://visily.ai"},{name:"Uizard",domain:"uizard.io",url:"https://uizard.io"},{name:"UX Magic",domain:"uxmagic.ai",url:"https://uxmagic.ai"},{name:"Banani",domain:"banani.co",url:"https://banani.co"},{name:"Emergent",domain:"app.emergent.sh",url:"https://app.emergent.sh"},{name:"Rocket",domain:"rocket.new",url:"https://rocket.new"},{name:"Lovable",domain:"lovable.dev",url:"https://lovable.dev"},{name:"Bolt",domain:"bolt.new",url:"https://bolt.new"},{name:"Base44",domain:"base44.com",url:"https://base44.com"},{name:"Create XYZ",domain:"create.xyz",url:"https://create.xyz"},{name:"Memex",domain:"memex.tech",url:"https://memex.tech"},{name:"BuildFire",domain:"buildfire.com",url:"https://buildfire.com"},{name:"Glide",domain:"glideapps.com",url:"https://glideapps.com"},{name:"Flatlogic",domain:"flatlogic.com",url:"https://flatlogic.com"},{name:"Retool",domain:"retool.com",url:"https://retool.com"},{name:"UI Bakery",domain:"uibakery.io",url:"https://uibakery.io"},{name:"Zoho",domain:"zoho.com",url:"https://zoho.com"},{name:"Appy Pie",domain:"appypie.com",url:"https://appypie.com"}],oc=r=>ac.some(e=>r.includes(e.domain)),lc=({open:r,onClose:e,summary:t,prompts:s})=>{const[i,n]=P.useState(""),[a,l]=P.useState(!1),[c,u]=P.useState(!1),[d,h]=P.useState(""),[f,g]=P.useState(!1),m=async()=>{if(!i.trim()){h("Please describe what went wrong.");return}u(!0),h("");try{const v={rating:"negative",feedback:i,summary_length:t.length,prompts_length:s.length};a&&(v.summary_text=t,v.input_prompts=s),Ie("feedback_negative_detailed",v),g(!0),setTimeout(()=>{n(""),l(!1),g(!1),e()},1500)}catch{h("Failed to submit feedback. Please try again.")}finally{u(!1)}};return r?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black/50 z-[200] animate-fade-in",onClick:e}),o.jsx("div",{className:"fixed inset-0 z-[201] flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md animate-slide-up-fade",onClick:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ur,{className:"w-5 h-5 text-orange-500"}),o.jsx("h3",{className:"font-semibold text-gray-900",children:"Report Issue"})]}),o.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:o.jsx(Ji,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"p-5 space-y-4",children:f?o.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[o.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Thank you!"}),o.jsx("p",{className:"text-sm text-gray-600",children:"Your feedback has been submitted."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What went wrong?"}),o.jsx("textarea",{value:i,onChange:v=>{n(v.target.value),h("")},placeholder:"Describe the issue (e.g., summary was inaccurate, missed key points, wrong format...)",className:`w-full h-32 px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-black focus:border-transparent resize-none ${d?"border-red-300":"border-gray-300"}`,autoFocus:!0}),d&&o.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[o.jsx(Ur,{className:"w-4 h-4"}),d]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>l(!a),children:[o.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center shrink-0 transition-all ${a?"bg-black border-black":"bg-white border-gray-300"}`,children:a&&o.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Include conversation data for debugging"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will send your input prompts and generated summary to help us improve. Optional."})]})]})]})}),o.jsxs("div",{className:"flex items-center justify-end gap-3 p-5 border-t border-gray-200",children:[o.jsx(q,{variant:"ghost",onClick:e,disabled:c,children:"Cancel"}),o.jsx(q,{onClick:m,disabled:c,className:"bg-black text-white hover:bg-gray-800",children:c?"Submitting...":"Submit Feedback"})]})]})})]}):null},Xi=({label:r,subtext:e,checked:t,onChange:s})=>o.jsxs("div",{className:"flex items-center gap-4 p-2 cursor-pointer group hover:bg-gray-50 rounded-xl transition-colors",onClick:s,children:[o.jsx("div",{className:O("w-5 h-5 rounded-md border flex items-center justify-center transition-all duration-200 shrink-0",t?"bg-black border-black":"bg-white border-gray-300 group-hover:border-gray-400"),children:t&&o.jsx(zt,{className:"w-3.5 h-3.5 text-white",strokeWidth:3})}),o.jsxs("div",{className:"flex flex-col select-none",children:[o.jsx("span",{className:"text-sm font-medium text-gray-900",children:r}),o.jsx("span",{className:"text-xs text-gray-500",children:e})]})]}),cc=({user:r})=>{const[e,t]=P.useState(0),[s,i]=P.useState(r?14:3);return P.useEffect(()=>{chrome.storage.local.get(["quotaUsed","quotaLimit"],a=>{a.quotaUsed!==void 0&&t(a.quotaUsed),a.quotaLimit!==void 0&&i(a.quotaLimit)});const n=a=>{a.quotaUsed&&t(a.quotaUsed.newValue),a.quotaLimit&&i(a.quotaLimit.newValue)};return chrome.storage.onChanged.addListener(n),()=>chrome.storage.onChanged.removeListener(n)},[]),P.useEffect(()=>{i(r?14:3)},[r]),o.jsx(D,{content:`Daily quota: ${e}/${s} used`,side:"bottom",children:o.jsxs("span",{className:"px-2 py-0.5 rounded-md bg-gray-50 text-gray-600 text-[10px] font-semibold border border-gray-200 shadow-sm",children:[e,"/",s]})})},uc=({summary:r,onEdit:e,activePopup:t,onTogglePopup:s,onRegenerate:i,user:n,onReportIssue:a})=>{const[l,c]=P.useState("idle"),[u,d]=P.useState(!1),[h,f]=P.useState(!1),[g,m]=P.useState(!1),v=()=>{if(u){d(!1);return}d(!0),f(!1),c("good"),Ie("summary_rated",{rating:"positive",summary_length:r.length}),setTimeout(()=>c("idle"),2e3)},y=()=>{if(h){f(!1);return}f(!0),d(!1),c("bad"),a(),setTimeout(()=>c("idle"),2e3)},j=()=>{navigator.clipboard.writeText(r),c("copied"),setTimeout(()=>c("idle"),2e3)},b=()=>{if("speechSynthesis"in window)if(g)window.speechSynthesis.cancel(),m(!1);else{const N=new SpeechSynthesisUtterance(r);N.onend=()=>m(!1),window.speechSynthesis.speak(N),m(!0)}},T=async()=>{if(s("none"),!!r)try{const N=`
                <div style="font-family: Arial, sans-serif; font-size: 11pt; line-height: 1.5;">
                    ${r.replace(/\n/g,"<br>")}
                    <br><br>
                    <hr style="border: 0; border-top: 1px solid #ccc;">
                    <p style="color: #666; font-size: 9pt;">Generated by Summarai</p>
                </div>
            `,$=new Blob([N],{type:"text/html"}),R=new Blob([r],{type:"text/plain"});if(typeof ClipboardItem<"u")try{const C=[new ClipboardItem({"text/html":$,"text/plain":R})];await navigator.clipboard.write(C)}catch{await navigator.clipboard.writeText(r)}else await navigator.clipboard.writeText(r);c("doc"),setTimeout(()=>c("idle"),4e3),await chrome.storage.local.set({pendingSummaryPaste:!0}),window.open("https://docs.google.com/document/create","_blank")}catch{window.open("https://docs.google.com/document/create","_blank")}},S=async()=>{if(s("none"),!!r)try{const[N]=await chrome.tabs.query({active:!0,currentWindow:!0}),$=N?.title||"SummarAI Report",{jsPDF:R}=await Ia(async()=>{const{jsPDF:de}=await import("./jspdf-BLwrtHRg.js").then(K=>K.j);return{jsPDF:de}},[]),C=new R;C.setFontSize(16);const se=C.splitTextToSize($,170);C.text(se,20,20);let W=20+C.getTextDimensions(se).h+5;C.setFontSize(10),C.setTextColor(100),C.text(`Generated on ${new Date().toLocaleDateString()}`,20,W),W+=10,C.setFontSize(12),C.setTextColor(0);const re=C.splitTextToSize(r,170);C.text(re,20,W);const ie=C.getNumberOfPages();for(let de=1;de<=ie;de++)C.setPage(de),C.setFontSize(10),C.setTextColor(150),C.text("Generated by Summarai",20,285);const ee=new Date,ue=String(ee.getDate()).padStart(2,"0"),Ne=String(ee.getMonth()+1).padStart(2,"0"),be=String(ee.getFullYear()).slice(-2),Se=String(ee.getHours()).padStart(2,"0"),fe=String(ee.getMinutes()).padStart(2,"0"),we=`summarai_${ue}.${Ne}.${be}_${Se}.${fe}.pdf`;C.save(we),c("doc"),setTimeout(()=>c("idle"),3e3)}catch{hs.error("Failed to generate PDF. Please try again.")}};return o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white rounded-xl border border-gray-100 shadow-lg min-h-[40px]",children:[o.jsx(D,{content:"Good Response",children:o.jsx(q,{variant:"ghost",size:"icon",onClick:v,className:O("h-8 w-8 rounded-lg transition-colors shrink-0 focus:outline-none focus:ring-0",u?"text-black hover:bg-gray-100":"text-gray-500 hover:bg-gray-50"),children:o.jsx(Pr,{className:O("w-4 h-4",u&&"fill-current")})})}),l==="good"&&o.jsx("div",{className:"overflow-hidden whitespace-nowrap text-[10px] font-medium text-green-600 px-1 animate-fade-in",children:"Thanks for feedback"}),o.jsx(D,{content:"Bad Response",children:o.jsx(q,{variant:"ghost",size:"icon",onClick:y,className:O("h-8 w-8 rounded-lg transition-colors shrink-0 focus:outline-none focus:ring-0",h?"text-black hover:bg-gray-100":"text-gray-500 hover:bg-gray-50"),children:o.jsx(Zi,{className:O("w-4 h-4",h&&"fill-current")})})}),l==="bad"&&o.jsx("div",{className:"overflow-hidden whitespace-nowrap text-[10px] font-medium text-black px-1 animate-fade-in",children:"Thanks for feedback"}),o.jsx("div",{className:"w-px h-4 bg-gray-200 mx-0.5 shrink-0"}),o.jsx(D,{content:"Regenerate",children:o.jsx(q,{variant:"ghost",size:"icon",onClick:i,className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500 shrink-0 focus:outline-none focus:ring-0",children:o.jsx(Qi,{className:"w-4 h-4"})})}),o.jsx(D,{content:"Copy",children:o.jsx(q,{variant:"ghost",size:"icon",onClick:j,className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500 shrink-0 focus:outline-none focus:ring-0",children:o.jsx(en,{className:"w-4 h-4"})})}),l==="copied"&&o.jsxs("div",{className:"overflow-hidden whitespace-nowrap text-[10px] font-medium text-gray-700 flex items-center gap-1 px-1 animate-fade-in",children:[o.jsx(zt,{className:"w-3 h-3"}),"Copied"]}),l==="doc"&&o.jsxs("div",{className:"overflow-hidden whitespace-nowrap text-[10px] font-medium text-blue-600 flex items-center gap-1 px-1 animate-fade-in",children:[o.jsx(zt,{className:"w-3 h-3"}),"Copied! Paste in Doc"]}),o.jsxs("div",{className:"relative shrink-0",children:[o.jsx(D,{content:"More",children:o.jsx(q,{variant:"ghost",size:"icon",onClick:()=>s(t==="more"?"none":"more"),className:O("h-8 w-8 rounded-lg text-gray-500 hover:bg-gray-50 focus:outline-none focus:ring-0",t==="more"&&"bg-gray-100 text-gray-900"),children:o.jsx(tn,{className:"w-4 h-4"})})}),t==="more"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>s("none")}),o.jsxs("div",{className:"absolute bottom-full right-0 mb-2 w-auto min-w-[200px] bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden z-50 flex flex-col py-2 animate-slide-up-fade",children:[o.jsxs("button",{onClick:()=>{e(),s("none")},className:"flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-200/50 w-full text-left transition-colors font-medium",children:[o.jsx(ja,{className:"w-4 h-4"}),"Edit summary"]}),o.jsxs("button",{onClick:b,className:O("flex items-center gap-3 px-4 py-2.5 text-sm hover:bg-gray-200/50 w-full text-left transition-colors font-medium",g?"text-blue-600":"text-gray-700"),children:[o.jsx(Ea,{className:O("w-4 h-4",g&&"animate-pulse")}),g?"Stop speaking":"Listen"]}),o.jsxs("button",{onClick:T,className:"flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-200/50 w-full text-left transition-colors font-medium",children:[o.jsx(Wr,{className:"w-4 h-4"}),"Export to Docs"]}),o.jsxs("button",{onClick:S,className:"flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-200/50 w-full text-left transition-colors font-medium",children:[o.jsx(Wr,{className:"w-4 h-4"}),"Download PDF Report"]}),o.jsxs("button",{onClick:()=>{const N=n?.name?`Hi ${n.name.split(" ")[0]},

`:"";window.open(`https://mail.google.com/mail/?view=cm&fs=1&body=${encodeURIComponent(N+r)}`,"_blank")},className:"flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-200/50 w-full text-left transition-colors font-medium",children:[o.jsx(sr,{className:"w-4 h-4"}),"Draft in Gmail"]}),o.jsxs("button",{onClick:()=>window.open("https://superextension.in/report","_blank"),className:"flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-200/50 w-full text-left transition-colors font-medium",children:[o.jsx(Na,{className:"w-4 h-4"}),"Report legal issue"]}),o.jsx("div",{className:"my-1 border-t border-gray-200"}),o.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 text-sm text-gray-400 w-full text-left font-medium select-none",children:[o.jsx(Sa,{className:"w-4 h-4"}),"Model: GPT-4o-mini"]})]})]})]})]})})},dc=()=>{const[r,e]=P.useState("idle"),[t,s]=P.useState(!1),[i,n]=P.useState(!1),[a,l]=P.useState("none"),[c,u]=P.useState(null),[d,h]=P.useState(!1),[f,g]=P.useState(!1),[m,v]=P.useState("TXT"),[y,j]=P.useState("auto"),[b,T]=P.useState(null),[S,N]=P.useState(!1),[$,R]=P.useState([]),[C,se]=P.useState(!1),[le,W]=P.useState(!1),[re,ie]=P.useState(!0),[ee,ue]=P.useState(!0),[Ne,be]=P.useState(window.innerHeight||800),[Se,fe]=P.useState(""),[we,de]=P.useState(!1),[K,he]=P.useState(0);P.useEffect(()=>{const _=()=>be(window.innerHeight||800);return window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)},[]);const ne=Ne<250,Ue=Ne<150,ke=async()=>{try{const[_]=await chrome.tabs.query({active:!0,currentWindow:!0}),U=_?.url;if(U){const Y=oc(U);if(se(Y),_.id&&Y)try{await chrome.tabs.sendMessage(_.id,{action:"ping"}),W(!0)}catch{W(!1)}else W(!1)}else se(!1),W(!1)}catch{se(!1)}finally{ue(!1)}},_t=async()=>{try{const[_]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!_?.id){ie(!1);return}const U=_.url||"";if(!(U.includes("chatgpt.com")||U.includes("gemini.google.com")||U.includes("claude.ai"))){ie(!0);return}const xe=await chrome.tabs.sendMessage(_.id,{action:"getPageContent",includeImages:!1});if(xe&&!xe.error){const Z=xe.conversation?.length>0||xe.rawText?.length>50;ie(Z)}else ie(!1)}catch{ie(!0)}};P.useEffect(()=>{rc(),setTimeout(()=>{Ie("extension_opened")},100),chrome.storage.local.get(["isPro"],Y=>{N(!!Y.isPro)}),ke(),_t();const _=()=>{ue(!0),ke(),_t()},U=(Y,xe,Z)=>{Z.active&&(ke(),_t())};return chrome.tabs.onActivated.addListener(_),chrome.tabs.onUpdated.addListener(U),()=>{chrome.tabs.onActivated.removeListener(_),chrome.tabs.onUpdated.removeListener(U)}},[]),P.useEffect(()=>{c&&r==="completed"&&e("idle")},[t,i]),P.useEffect(()=>{const _=ga(async U=>{if(T(U),U){ic(U.id,U.email||void 0),Fa(U);const Y=await $a(U.id);Y&&Y.length>0&&(R(Y),chrome.storage.local.set({history:Y}))}else nc()});return()=>_()},[]),Cr.useEffect(()=>{chrome.storage.local.get(["summaryType","provider","history"],_=>{_.summaryType&&v(_.summaryType),_.provider&&j(_.provider),_.history&&Array.isArray(_.history)&&R(_.history)})},[]);const Jt=async()=>{try{await ma(),l("none")}catch(_){hs.error(`Login failed: ${_.message}`)}},As=async()=>{await va(),l("none")},Pe=async()=>{await fa(),Jt()},Kt=_=>{u(_.summary),e("completed"),l("none"),Ie("history_item_viewed",{item_id:_.id})},Oe=_=>{window.open(`https://superextension.in/help?topic=${_}`,"_blank"),l("none"),Ie("help_action_clicked",{action:_})},Ze=async(_,U,Y)=>{e("generating");try{const[xe]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!xe.id)throw new Error("No active tab found");const Z=await chrome.tabs.sendMessage(xe.id,{action:"getPageContent",includeImages:i});if(!Z)throw new Error("Failed to scrape content. Refresh the page and try again.");let qe=Z.rawText||"";Z.conversation&&Z.conversation.length>0&&(t?qe=Z.conversation.map(G=>`${G.role==="user"?"User":"AI"}: ${G.text}`).join(`

`):qe=Z.conversation.filter(G=>G.role==="user").map(G=>`User: ${G.text}`).join(`

`)),fe(qe);const es=new Promise(G=>setTimeout(G,2500));let yt="";try{const G=await chrome.storage.local.get(["deviceId"]);G.deviceId?yt=G.deviceId:(yt=`device_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,await chrome.storage.local.set({deviceId:yt}))}catch{yt=`temp_${Date.now()}`}let Hr;if(b)try{const G=await new Promise(nt=>{chrome.identity.getAuthToken({interactive:!1},ts=>{nt(ts||void 0)})});G&&(await fetch(`https://www.googleapis.com/oauth2/v3/tokeninfo?access_token=${G}`)).ok&&(Hr=G)}catch{}const[bt]=await Promise.all([za(qe,{includeAI:t,format:U||m,length:"medium",apiKey:"",provider:y,images:i?Z.images:void 0,tone:Y},y,_,Hr,yt),es]);u(bt),e("completed"),g(!1);const pa={id:Date.now(),summary:bt,date:new Date().toISOString(),preview:bt.slice(0,100)+"...",platform:Z.platform||"generic",type:i?"prompt+response+image":t?"prompt+response":"prompt"};chrome.storage.local.get(["history"],G=>{const nt=G.history||[],ts=[pa,...nt].slice(0,50);chrome.storage.local.set({history:ts}),R(ts)}),chrome.storage.local.get(["summarizeCount"],G=>{const nt=G.summarizeCount||0;chrome.storage.local.set({summarizeCount:nt+1})}),b&&xe.url&&bt&&Ra(b.id,bt,xe.url),Ie("summary_generated",{type:m,length:c?c.length:0,is_pro:S,include_ai:t,analyze_images:i,format:U||m,tone:Y||"normal",provider:y})}catch(xe){const Z=xe.message||"Failed to generate summary";if(Z.includes("Guest Quota Exceeded"))hs.error("You've used your 3 free summaries today! Sign in with Google to get 14 daily summaries.",{duration:5e3}),l("profile"),e("error");else if(Z.includes("Could not establish connection")||Z.includes("Receiving end does not exist")||Z.includes("Extension context invalidated")){try{const[qe]=await chrome.tabs.query({active:!0,currentWindow:!0});qe?.id&&(await chrome.scripting.executeScript({target:{tabId:qe.id},files:["src/content.ts"]}),hs.success("Connection restored! Please click 'Generate' again."))}catch{confirm("Connection lost. Please reload the page to fix it.")&&chrome.tabs.query({active:!0,currentWindow:!0}).then(([es])=>{es.id&&chrome.tabs.reload(es.id)})}e("idle")}else u(Z),e("error");Ie("generation_failed",{error:Z})}finally{g(!1)}},xt=()=>{confirm("Are you sure you want to clear your history?")&&(chrome.storage.local.set({history:[]}),R([]),b&&Oa(b.id))},Zt=()=>{g(!0),Ie("regenerate_clicked"),Ze()},Qt=()=>{u(null),e("idle")};return P.useEffect(()=>{const _=U=>{if(a!=="none"){const Y=U.target;!Y.closest(".popup-content")&&!Y.closest("button")&&l("none")}};return document.addEventListener("mousedown",_),()=>{document.removeEventListener("mousedown",_)}},[a]),o.jsxs(sn,{children:[o.jsxs("div",{className:"flex flex-col h-full relative",children:[o.jsxs("div",{className:"flex-1 min-h-[300px] mb-4",children:[o.jsxs("div",{className:"w-full h-full flex flex-col overflow-hidden relative border border-gray-200 rounded-2xl",children:[o.jsxs("div",{className:"absolute top-4 right-4 z-50 flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded-md bg-blue-50 text-blue-600 text-[10px] font-bold uppercase tracking-wider border border-blue-100 shadow-sm cursor-pointer hover:bg-blue-100 transition-colors",onClick:()=>{const _=K+1;he(_),_===6&&(l("feedback"),he(0))},children:"Beta"}),o.jsx(cc,{user:b}),o.jsx(D,{content:"Profile",side:"bottom",disabled:a==="profile",children:o.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs font-medium text-gray-600 cursor-pointer hover:bg-gray-300 transition-colors overflow-hidden",onClick:()=>l(a==="profile"?"none":"profile"),children:b&&b.picture?o.jsx("img",{src:b.picture,alt:"Profile",className:"w-full h-full object-cover"}):b&&b.name?b.name[0].toUpperCase():"BA"})}),a==="profile"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>l("none")}),o.jsx("div",{className:"popup-content absolute top-full right-0 mt-2 w-auto min-w-[200px] bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden z-40 flex flex-col py-1 animate-slide-up-fade",onClick:_=>_.stopPropagation(),children:b?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[o.jsx("p",{className:"text-xs font-medium text-gray-900",children:b.name}),o.jsx("p",{className:"text-[10px] text-gray-500 truncate",children:b.email})]}),o.jsxs("button",{onClick:Pe,className:"flex items-center gap-2 px-4 py-2.5 text-xs text-gray-700 hover:bg-gray-50 w-full text-left transition-colors",children:[o.jsx(qr,{className:"w-3.5 h-3.5"}),"Switch Account"]}),o.jsxs("button",{onClick:As,className:"flex items-center gap-2 px-4 py-2.5 text-xs text-red-600 hover:bg-red-50 w-full text-left transition-colors",children:[o.jsx(ka,{className:"w-3.5 h-3.5"}),"Logout"]})]}):o.jsxs("div",{className:"p-4 flex flex-col gap-3",children:[o.jsx("p",{className:"text-xs text-gray-600 text-center",children:"Sign in to sync history and upgrade."}),o.jsxs("button",{onClick:Jt,className:"flex items-center justify-center gap-2 w-full py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors text-xs font-medium",children:[o.jsx(qr,{className:"w-3.5 h-3.5"}),"Sign in with Google"]}),o.jsx("button",{onClick:()=>window.open("https://accounts.google.com/signin/recovery","_blank"),className:"text-[10px] text-gray-400 hover:text-gray-600 transition-colors text-center w-full",children:"Forgot Password?"})]})})]})]}),c?o.jsxs("div",{className:"flex flex-col h-full relative animate-fade-in",children:[o.jsx("div",{className:"absolute top-4 left-4 z-30",children:o.jsx(D,{content:"Back",side:"bottom",children:o.jsx(q,{variant:"secondary",size:"icon",onClick:Qt,className:"rounded-full w-8 h-8 shadow-sm border-gray-200 bg-white/80 backdrop-blur-sm",children:o.jsx(Ki,{className:"w-4 h-4 text-gray-600"})})})}),o.jsx("div",{className:"absolute top-0 left-0 right-0 h-16 bg-white z-20 border-b border-gray-50"}),d?o.jsx("textarea",{value:c,onChange:_=>u(_.target.value),onBlur:()=>h(!1),autoFocus:!0,className:"flex-1 w-full resize-none p-6 pt-20 pb-20 text-sm leading-relaxed text-gray-700 text-justify font-sans border-none focus:ring-0 outline-none"}):o.jsx("div",{className:"flex-1 overflow-y-auto text-sm leading-relaxed text-gray-700 text-justify font-sans p-6 pt-20 pb-40 space-y-2",children:c.split(`
`).map((_,U)=>{const Y=_.trim();return Y.startsWith("-")?o.jsxs("div",{className:"flex gap-2 items-start",children:[o.jsx("span",{className:"shrink-0 text-black font-bold",children:"â€¢"}),o.jsx("span",{children:Y.substring(1).trim()})]},U):o.jsx("p",{children:_},U)})}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex flex-col items-end gap-3 bg-gradient-to-t from-white via-white/95 to-transparent pt-12 pb-4 px-4",children:[o.jsx("div",{className:"w-full text-center",children:o.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-50 px-3 py-1 rounded-full border border-gray-100 opacity-80",children:[y==="google"?"Gemini":y==="openai"?"ChatGPT":"AI"," can make mistakes. Regenerate if needed."]})}),o.jsx(uc,{summary:c,onEdit:()=>h(!0),activePopup:a,onTogglePopup:l,onRegenerate:Zt,user:b,onReportIssue:()=>de(!0)})]})]},"summary-content"):o.jsx("div",{className:"w-full h-full animate-fade-in p-6 pt-16 flex flex-col items-center justify-center gap-4",children:ee?o.jsx("div",{className:"flex flex-col items-center gap-3 text-center max-w-sm",children:o.jsx("div",{className:"w-6 h-6 border-2 border-gray-100 border-t-gray-400 rounded-full animate-spin"})}):C?re?o.jsx("span",{className:"text-gray-400 text-sm",children:le?"Ready to generate summary":"Ready when you reload the page â†»"}):o.jsxs("div",{className:"flex flex-col items-center gap-3 text-center max-w-sm",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-50 flex items-center justify-center",children:o.jsx(Ls,{className:"w-6 h-6 text-blue-600"})}),o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"No conversation found"}),o.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Start a chat first, then generate a summary."})]}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"flex flex-col items-center gap-3 text-center max-w-sm",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-amber-50 flex items-center justify-center",children:o.jsx(Ls,{className:"w-6 h-6 text-amber-600"})}),o.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Page not supported"}),o.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Works on ChatGPT, Gemini, and 20+ AI platforms."}),o.jsxs("button",{onClick:()=>window.open("https://superextension.in/supported-sites.pdf","_blank"),className:"flex items-center gap-2 px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors text-sm font-medium mt-2",children:[o.jsx(Ms,{className:"w-4 h-4"}),"View All Supported Sites",o.jsx(Br,{className:"w-3.5 h-3.5"})]}),o.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Made to tailor your conversation with AI apps"})]})})},"empty-state")]}),ne&&o.jsx("div",{className:"absolute bottom-4 right-4 z-[60]",children:o.jsx(Xr,{onGenerate:Ze,state:r,isRegenerating:f,disabled:!C,compact:!0})})]}),o.jsxs("div",{className:O("shrink-0 flex flex-col gap-4 pb-2 relative z-50",ne&&"gap-0 pb-0"),children:[!ne&&o.jsx(Xr,{onGenerate:Ze,state:r,isRegenerating:f,disabled:!C||!re}),!Ue&&o.jsxs("div",{className:"space-y-3 px-1",children:[o.jsx(Xi,{label:"Include AI responses",subtext:"Summarize the full conversation",checked:t,onChange:()=>{s(_=>!_)}}),o.jsx(Xi,{label:"Read images",subtext:"Include visual context",checked:i,onChange:()=>{n(_=>!_)}})]}),o.jsxs("div",{className:"relative flex items-center justify-between pt-2 px-1",children:[o.jsxs("div",{className:"relative z-[110]",children:[o.jsx(D,{content:"Metadata",children:o.jsx(q,{variant:"secondary",size:"icon",className:O("relative z-[110] rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",a==="metadata"&&"bg-gray-100 text-gray-900 border-gray-300"),onClick:()=>l(a==="metadata"?"none":"metadata"),children:o.jsx(Ls,{className:"w-4 h-4"})})}),a==="metadata"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsxs("div",{className:"popup-content absolute bottom-full left-0 mb-2 z-[100] w-[280px] bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom-left",onClick:_=>_.stopPropagation(),children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Metadata"}),o.jsxs("div",{className:"space-y-3 text-gray-600",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"Version"}),o.jsx("span",{className:"font-medium text-gray-900 bg-gray-100 px-2 py-0.5 rounded text-xs",children:"Tiger v1.0"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"Engine"}),o.jsx("span",{className:"font-medium text-gray-900",children:"GPT-4o-mini"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"Status"}),o.jsxs("span",{className:"flex items-center gap-1.5 font-medium text-green-600 text-xs bg-green-50 px-2 py-0.5 rounded-full border border-green-100",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-600 animate-pulse"}),"Active"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{children:"Developer"}),o.jsx("span",{className:"font-medium text-gray-900",children:"Bharath Amaravadi"})]}),o.jsx("div",{className:"pt-3 mt-1 border-t border-gray-100",children:o.jsxs("button",{onClick:()=>chrome.tabs.create({url:chrome.runtime.getURL("welcome.html")}),className:"flex items-center justify-center gap-2 w-full py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors font-medium text-xs",children:["Visit Website",o.jsx(Br,{className:"w-3 h-3"})]})})]})]})]})]}),o.jsxs("div",{className:"hidden flex flex-nowrap items-center gap-1 z-[110]",children:[o.jsxs("div",{className:"relative",children:[o.jsx(D,{content:"Feedback",disabled:a==="feedback",children:o.jsx(q,{variant:"secondary",size:"icon",className:"relative z-20 rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",onClick:()=>l(a==="feedback"?"none":"feedback"),children:o.jsx(Gr,{className:"w-4 h-4"})})}),a==="feedback"&&o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsx(Yr,{open:a==="feedback",onOpenChange:_=>l(_?"feedback":"none"),userEmail:b?.email})]}),o.jsxs("div",{className:"relative",children:[o.jsx(D,{content:"History",disabled:a==="history",children:o.jsx(q,{variant:"secondary",size:"icon",className:O("relative z-20 rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",a==="history"&&"bg-gray-100 text-gray-900 border-gray-300"),onClick:()=>l(a==="history"?"none":"history"),children:o.jsx(rs,{className:"w-4 h-4"})})}),a==="history"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 z-[100] flex justify-center",children:o.jsxs("div",{className:"w-full bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:"History"}),o.jsx("button",{onClick:xt,className:"text-[10px] font-medium text-red-500 hover:text-red-600 transition-colors",children:"Clear all"})]}),o.jsx("div",{className:"space-y-3 max-h-[250px] overflow-y-auto pr-1 custom-scrollbar",children:$.length===0?o.jsxs("div",{className:"text-center text-gray-400 py-8",children:[o.jsx(rs,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),o.jsx("p",{children:"No history yet"})]}):$.map(_=>o.jsxs("div",{onClick:()=>Kt(_),className:"flex flex-col gap-1 p-3 rounded-xl bg-gray-50 border border-gray-100 hover:border-gray-200 transition-colors cursor-pointer shrink-0",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("span",{className:"font-medium text-xs text-gray-900 line-clamp-1",children:"Summary"}),o.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap ml-2",children:new Date(_.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),o.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-2 leading-relaxed",children:_.preview})]},_.id))})]})})]}),o.jsxs("div",{className:"relative",children:[o.jsx(D,{content:"Settings",disabled:a==="settings",children:o.jsx(q,{variant:"secondary",size:"icon",className:O("relative z-20 rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50"),onClick:()=>l(a==="settings"?"none":"settings"),children:o.jsx(Vr,{className:"w-4 h-4"})})}),a==="settings"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsxs("div",{className:"absolute bottom-full right-0 mb-2 z-[100] w-[200px] bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom-right max-h-[400px] overflow-y-auto custom-scrollbar",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Settings"}),o.jsxs("div",{className:"space-y-4",children:[!1,o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Summary Type"}),o.jsx("div",{className:"flex flex-col gap-2",children:["TXT","JSON","XML"].map(_=>o.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg border border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors",children:[o.jsx("div",{className:O("w-4 h-4 rounded-full border flex items-center justify-center transition-all",m===_?"border-black bg-black":"border-gray-300 bg-white"),children:m===_&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white"})}),o.jsx("input",{type:"radio",name:"summaryType",value:_,checked:m===_,onChange:()=>v(_),className:"hidden"}),o.jsx("span",{className:"text-xs font-medium text-gray-700",children:_})]},_))})]})]})]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(D,{content:"Help",disabled:a==="help",children:o.jsx(q,{variant:"secondary",size:"icon",className:O("relative z-20 rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50"),onClick:()=>l(a==="help"?"none":"help"),children:o.jsx(is,{className:"w-4 h-4"})})}),a==="help"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsxs("div",{className:"absolute bottom-full right-0 mb-2 z-[100] w-max bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom-right",children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Help & Support"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>Oe("docs"),className:"flex items-center gap-3 w-full text-left text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(Ms,{className:"w-4 h-4"}),"Documentation"]}),o.jsxs("button",{onClick:()=>Oe("faqs"),className:"flex items-center gap-3 w-full text-left text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(is,{className:"w-4 h-4"}),"FAQs"]}),o.jsxs("button",{onClick:()=>Oe("support"),className:"flex items-center gap-3 w-full text-left text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(sr,{className:"w-4 h-4"}),"Contact Support"]})]})]})]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"relative",children:o.jsx(D,{content:"Feedback",disabled:a==="feedback",children:o.jsx(q,{variant:"secondary",size:"icon",className:"relative z-[110] rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",onClick:()=>l(a==="feedback"?"none":"feedback"),children:o.jsx(Gr,{className:"w-4 h-4"})})})}),o.jsx("div",{className:"relative",children:o.jsx(D,{content:"History",disabled:a==="history",children:o.jsx(q,{variant:"secondary",size:"icon",className:O("relative z-[110] rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",a==="history"&&"bg-gray-100 text-gray-900 border-gray-300"),onClick:()=>l(a==="history"?"none":"history"),children:o.jsx(rs,{className:"w-4 h-4"})})})}),o.jsxs("div",{className:"relative",children:[o.jsx(D,{content:"Settings",disabled:a==="settings",children:o.jsx(q,{variant:"secondary",size:"icon",className:"relative z-[110] rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",onClick:()=>l(a==="settings"?"none":"settings"),children:o.jsx(Vr,{className:"w-4 h-4"})})}),a==="settings"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsxs("div",{className:"popup-content absolute bottom-full right-0 mb-2 z-[100] w-[200px] bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom-right",onClick:_=>_.stopPropagation(),children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Settings"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Summary Type"}),o.jsx("div",{className:"flex flex-col gap-2",children:["TXT","JSON","XML"].map(_=>o.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg border border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors",children:[o.jsx("div",{className:O("w-4 h-4 rounded-full border flex items-center justify-center transition-all",m===_?"border-black bg-black":"border-gray-300 bg-white"),children:m===_&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white"})}),o.jsx("input",{type:"radio",name:"summaryType",value:_,checked:m===_,onChange:()=>v(_),className:"hidden"}),o.jsx("span",{className:"text-xs font-medium text-gray-700",children:_})]},_))})]})]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(D,{content:"Help",disabled:a==="help",children:o.jsx(q,{variant:"secondary",size:"icon",className:"relative z-[110] rounded-full w-8 h-8 shadow-sm border-gray-200 text-gray-500 transition-colors hover:bg-gray-50",onClick:()=>l(a==="help"?"none":"help"),children:o.jsx(is,{className:"w-4 h-4"})})}),a==="help"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsxs("div",{className:"popup-content absolute bottom-full right-0 mb-2 z-[100] w-max bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom-right",onClick:_=>_.stopPropagation(),children:[o.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Help & Support"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:()=>Oe("docs"),className:"flex items-center gap-3 w-full text-left text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(Ms,{className:"w-4 h-4"}),"Documentation"]}),o.jsxs("button",{onClick:()=>Oe("faqs"),className:"flex items-center gap-3 w-full text-left text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(is,{className:"w-4 h-4"}),"FAQs"]}),o.jsxs("button",{onClick:()=>Oe("support"),className:"flex items-center gap-3 w-full text-left text-gray-600 hover:text-gray-900 transition-colors",children:[o.jsx(sr,{className:"w-4 h-4"}),"Contact Support"]})]})]})]})]})]}),a==="feedback"&&o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsx(Yr,{open:a==="feedback",onOpenChange:_=>l(_?"feedback":"none"),userEmail:b?.email}),a==="history"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-[90]",onClick:()=>l("none")}),o.jsx("div",{className:"popup-content absolute bottom-full left-0 right-0 mb-2 z-[100] w-auto",onClick:_=>_.stopPropagation(),children:o.jsxs("div",{className:"w-full bg-white rounded-2xl shadow-xl border border-gray-200 p-5 text-sm origin-bottom-right",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:"History"}),o.jsx("button",{onClick:xt,className:"text-[10px] font-medium text-red-500 hover:text-red-600 transition-colors",children:"Clear all"})]}),o.jsx("div",{className:"space-y-3 max-h-[250px] overflow-y-auto pr-1 custom-scrollbar",children:$.length===0?o.jsxs("div",{className:"text-center text-gray-400 py-8",children:[o.jsx(rs,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),o.jsx("p",{children:"No history yet"})]}):$.map(_=>o.jsxs("div",{onClick:()=>Kt(_),className:"flex flex-col gap-1 p-3 rounded-xl bg-gray-50 border border-gray-100 hover:border-gray-200 transition-colors cursor-pointer shrink-0",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("span",{className:"font-medium text-xs text-gray-900 line-clamp-1 capitalize",children:_.platform?`${_.platform} | ${_.type} summary`:"Summary"}),o.jsx("span",{className:"text-[10px] text-gray-400 whitespace-nowrap ml-2",children:new Date(_.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),o.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-2 leading-relaxed",children:_.preview})]},_.id))})]})})]})]})]})]}),o.jsx(lc,{open:we,onClose:()=>de(!1),summary:c||"",prompts:Se})]})},hc=({summary:r,onBack:e})=>o.jsx(sn,{children:o.jsx("div",{className:"flex flex-col h-full relative",children:o.jsx("div",{className:"flex-1 min-h-0 mb-4 relative",children:o.jsxs("div",{className:"w-full h-full bg-white rounded-2xl border border-gray-200 shadow-sm flex flex-col overflow-hidden relative",children:[o.jsx("div",{className:"absolute top-4 left-4 z-10",children:o.jsx(D,{content:"Back",children:o.jsx(q,{variant:"secondary",size:"icon",onClick:e,className:"rounded-full w-8 h-8 shadow-sm border-gray-200 bg-white/80 backdrop-blur-sm",children:o.jsx(Ki,{className:"w-4 h-4 text-gray-600"})})})}),o.jsx(Ta.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex-1 overflow-y-auto text-sm leading-relaxed text-gray-700 text-justify font-sans p-6 pt-16 pb-20",children:r}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex flex-col items-end gap-3 bg-gradient-to-t from-white via-white/95 to-transparent pt-12 pb-4 px-4",children:[o.jsx("div",{className:"w-full text-center",children:o.jsx("span",{className:"text-[10px] text-gray-300 bg-gray-50 px-3 py-1 rounded-full border border-gray-100",children:"AI can make mistakes. Regenerate if needed."})}),o.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white rounded-xl border border-gray-100 shadow-lg",children:[o.jsx(D,{content:"Good Response",children:o.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500",onClick:()=>Ie("feedback_positive",{type:"thumbs_up",length:r.length}),children:o.jsx(Pr,{className:"w-4 h-4"})})}),o.jsx(D,{content:"Bad Response",children:o.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500",onClick:()=>Ie("feedback_negative",{type:"thumbs_down",length:r.length}),children:o.jsx(Zi,{className:"w-4 h-4"})})}),o.jsx("div",{className:"w-px h-4 bg-gray-200 mx-0.5"}),o.jsx(D,{content:"Regenerate",children:o.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500",children:o.jsx(Qi,{className:"w-4 h-4"})})}),o.jsx(D,{content:"Copy",children:o.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500",children:o.jsx(en,{className:"w-4 h-4"})})}),o.jsx(D,{content:"More",children:o.jsx(q,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-gray-50 rounded-lg text-gray-500",children:o.jsx(tn,{className:"w-4 h-4"})})})]})]})]})})})});function pc(){const[r,e]=P.useState("home"),[t,s]=P.useState(""),i=a=>{s(a),e("summary")},n=()=>{e("home"),s("")};return o.jsx("div",{className:"w-full h-screen bg-white",children:r==="home"?o.jsx(dc,{onGenerateComplete:i}):o.jsx(hc,{summary:t,onBack:n})})}Ca.createRoot(document.getElementById("root")).render(o.jsxs(Cr.StrictMode,{children:[o.jsx(pc,{}),o.jsx(Pa,{position:"top-center",toastOptions:{duration:3e3,style:{background:"#fff",color:"#000",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"12px 16px",fontSize:"14px"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]}));
